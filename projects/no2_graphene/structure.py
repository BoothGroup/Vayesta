import numpy as np

data = {
        (3, 3) : {
            'amat' :
                np.asarray([
                    [7.389000000, 0.000000000,  0.000000000],
                    [3.694500000, 6.399000000,  0.000000000],
                    [0.000000000, 0.000000000, 30.000000000],
                    ]),
            'coords' :
                np.asarray([
                    # NO2
                    [6.157500000, 2.844000000,  20.67182377],
                    [7.236352910, 2.844000000,  20.00000000],
                    [5.078647080, 2.844000000,  20.00000000],
                    # Graphene
                    [0.000000000, 0.000000000, 17.000000000],
                    [1.231500000, 2.133000000, 17.000000000],
                    [2.463000000, 4.266000000, 17.000000000],
                    [2.463000000, 0.000000000, 17.000000000],
                    [3.694500000, 2.133000000, 17.000000000],
                    [4.926000000, 4.266000000, 17.000000000],
                    [4.926000000, 0.000000000, 17.000000000],
                    [6.157500000, 2.133000000, 17.000000000],
                    [7.389000000, 4.266000000, 17.000000000],
                    [0.000000000, 1.422000000, 17.000000000],
                    [1.231500000, 3.555000000, 17.000000000],
                    [2.463000000, 5.688000000, 17.000000000],
                    [2.463000000, 1.422000000, 17.000000000],
                    [3.694500000, 3.555000000, 17.000000000],
                    [4.926000000, 5.688000000, 17.000000000],
                    [4.926000000, 1.422000000, 17.000000000],
                    [6.157500000, 3.555000000, 17.000000000],
                    [7.389000000, 5.688000000, 17.000000000],
                    ])
                },
        (4, 4) : {
                'amat' :
                    np.asarray([
    	                [9.852000000, 0.000000000,  0.000000000],
    	                [4.926000000, 8.532000000,  0.000000000],
    	                [0.000000000, 0.000000000, 30.000000000],
    	                ]),
                'coords' :
                    np.asarray([
                        # NO2
                        [ 6.157500000, 2.844000000, 20.671823770],
                        [ 7.236352910, 2.844000000, 20.000000000],
                        [ 5.078647080, 2.844000000, 20.000000000],
                        # Graphene
                        [ 1.231500000, 2.133000000, 17.000000000],
                        [ 2.463000000, 4.266000000, 17.000000000],
                        [ 3.694500000, 6.399000000, 17.000000000],
                        [ 2.463000000, 0.000000000, 17.000000000],
                        [ 3.694500000, 2.133000000, 17.000000000],
                        [ 4.926000000, 4.266000000, 17.000000000],
                        [ 6.157500000, 6.399000000, 17.000000000],
                        [ 4.926000000, 0.000000000, 17.000000000],
                        [ 6.157500000, 2.133000000, 17.000000000],
                        [ 7.389000000, 4.266000000, 17.000000000],
                        [ 8.620500000, 6.399000000, 17.000000000],
                        [ 7.389000000, 0.000000000, 17.000000000],
                        [ 8.620500000, 2.133000000, 17.000000000],
                        [ 9.852000000, 4.266000000, 17.000000000],
                        [11.083500000, 6.399000000, 17.000000000],
                        [ 0.000000000, 1.422000000, 17.000000000],
                        [ 1.231500000, 3.555000000, 17.000000000],
                        [ 2.463000000, 5.688000000, 17.000000000],
                        [ 3.694500000, 7.821000000, 17.000000000],
                        [ 2.463000000, 1.422000000, 17.000000000],
                        [ 3.694500000, 3.555000000, 17.000000000],
                        [ 4.926000000, 5.688000000, 17.000000000],
                        [ 6.157500000, 7.821000000, 17.000000000],
                        [ 4.926000000, 1.422000000, 17.000000000],
                        [ 6.157500000, 3.555000000, 17.000000000],
                        [ 7.389000000, 5.688000000, 17.000000000],
                        [ 8.620500000, 7.821000000, 17.000000000],
                        [ 7.389000000, 1.422000000, 17.000000000],
                        [ 8.620500000, 3.555000000, 17.000000000],
                        [ 9.852000000, 5.688000000, 17.000000000],
                        [11.083500000, 7.821000000, 17.000000000],
                        ])
                    },
            (5, 5) : {
                'amat' :
                    np.asarray([
                        [12.315000000,  0.000000000,  0.000000000],
    	                [ 6.157500000, 10.665000000,  0.000000000],
    	                [ 0.000000000,  0.000000000, 30.000000000],
                        ]),
                'coords' :
                    np.asarray([
                        [ 6.157500000, 2.844000000, 20.671823770],
                        [ 7.236352910, 2.844000000, 20.000000000],
                        [ 5.078647080, 2.844000000, 20.000000000],
                        [ 0.000000000, 0.000000000, 17.000000000],
                        [ 1.231500000, 2.133000000, 17.000000000],
                        [ 2.463000000, 4.266000000, 17.000000000],
                        [ 3.694500000, 6.399000000, 17.000000000],
                        [ 4.926000000, 8.532000000, 17.000000000],
                        [ 2.463000000, 0.000000000, 17.000000000],
                        [ 3.694500000, 2.133000000, 17.000000000],
                        [ 4.926000000, 4.266000000, 17.000000000],
                        [ 6.157500000, 6.399000000, 17.000000000],
                        [ 7.389000000, 8.532000000, 17.000000000],
                        [ 4.926000000, 0.000000000, 17.000000000],
                        [ 6.157500000, 2.133000000, 17.000000000],
                        [ 7.389000000, 4.266000000, 17.000000000],
                        [ 8.620500000, 6.399000000, 17.000000000],
                        [ 9.852000000, 8.532000000, 17.000000000],
                        [ 7.389000000, 0.000000000, 17.000000000],
                        [ 8.620500000, 2.133000000, 17.000000000],
                        [ 9.852000000, 4.266000000, 17.000000000],
                        [11.083500000, 6.399000000, 17.000000000],
                        [12.315000000, 8.532000000, 17.000000000],
                        [ 9.852000000, 0.000000000, 17.000000000],
                        [11.083500000, 2.133000000, 17.000000000],
                        [12.315000000, 4.266000000, 17.000000000],
                        [13.546500000, 6.399000000, 17.000000000],
                        [14.778000000, 8.532000000, 17.000000000],
                        [ 0.000000000, 1.422000000, 17.000000000],
                        [ 1.231500000, 3.555000000, 17.000000000],
                        [ 2.463000000, 5.688000000, 17.000000000],
                        [ 3.694500000, 7.821000000, 17.000000000],
                        [ 4.926000000, 9.954000000, 17.000000000],
                        [ 2.463000000, 1.422000000, 17.000000000],
                        [ 3.694500000, 3.555000000, 17.000000000],
                        [ 4.926000000, 5.688000000, 17.000000000],
                        [ 6.157500000, 7.821000000, 17.000000000],
                        [ 7.389000000, 9.954000000, 17.000000000],
                        [ 4.926000000, 1.422000000, 17.000000000],
                        [ 6.157500000, 3.555000000, 17.000000000],
                        [ 7.389000000, 5.688000000, 17.000000000],
                        [ 8.620500000, 7.821000000, 17.000000000],
                        [ 9.852000000, 9.954000000, 17.000000000],
                        [ 7.389000000, 1.422000000, 17.000000000],
                        [ 8.620500000, 3.555000000, 17.000000000],
                        [ 9.852000000, 5.688000000, 17.000000000],
                        [11.083500000, 7.821000000, 17.000000000],
                        [12.315000000, 9.954000000, 17.000000000],
                        [ 9.852000000, 1.422000000, 17.000000000],
                        [11.083500000, 3.555000000, 17.000000000],
                        [12.315000000, 5.688000000, 17.000000000],
                        [13.546500000, 7.821000000, 17.000000000],
                        [14.778000000, 9.954000000, 17.000000000],
                        ])
                    }
                }



class NO2_Graphene:

    def __init__(self, supercell, vacuum_size=None, z_graphene=None):
        supercell = tuple(supercell)
        if supercell not in ((3, 3), (4,4), (5,5)):
            raise ValueError()
        self.supercell = supercell
        self.vacuum_size = vacuum_size
        self.z_graphene = z_graphene

    def get_amat_coords(self):
        dat = data[self.supercell]
        amat, coords = dat['amat'].copy(), dat['coords'].copy()
        if self.vacuum_size is not None:
            amat[2,2] = self.vacuum_size
            if self.z_graphene is None:
                self.z_graphene = 17.0 + (self.vacuum_size-30.0)/2
        if self.z_graphene is not None:
            delta = (self.z_graphene - 17.0)
            coords[:,2] += delta
        return amat, coords

    def get_amat_atom(self):
        amat, coords = self.get_amat_coords()
        atoms = ['N', 'O', 'O'] + (len(coords)-3)*['C']
        atoms = [(s, coords[i]) for i, s in enumerate(atoms)]
        return amat, atoms
