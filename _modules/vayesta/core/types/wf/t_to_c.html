

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vayesta.core.types.wf.t_to_c &mdash; Vayesta 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            Vayesta
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../apidoc/modules.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Vayesta</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../../vayesta.html">vayesta</a></li>
      <li class="breadcrumb-item active">vayesta.core.types.wf.t_to_c</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for vayesta.core.types.wf.t_to_c</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">These expressions were obtained from https://doi.org/10.1063/1.4996044 for</span>
<span class="sd">GHF, and then spin integrated to RHF and UHF expressions.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">vayesta.core.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">einsum</span>


<div class="viewcode-block" id="t1_uhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t1_uhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t1_uhf</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
    <span class="n">c1_aa</span><span class="p">,</span> <span class="n">c1_bb</span> <span class="o">=</span> <span class="n">c1</span>
    <span class="n">nocc</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nvir</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">t1_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t1_aa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia-&gt;ia&quot;</span><span class="p">,</span> <span class="n">c1_aa</span><span class="p">)</span>
    <span class="n">t1_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t1_bb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia-&gt;ia&quot;</span><span class="p">,</span> <span class="n">c1_bb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_bb</span></div>



<div class="viewcode-block" id="t1_rhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t1_rhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t1_rhf</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
    <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia-&gt;ia&quot;</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t1</span></div>



<div class="viewcode-block" id="t2_uhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t2_uhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t2_uhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
    <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_bb</span> <span class="o">=</span> <span class="n">t1</span>
    <span class="n">c2_aaaa</span><span class="p">,</span> <span class="n">c2_abab</span><span class="p">,</span> <span class="n">c2_bbbb</span> <span class="o">=</span> <span class="n">c2</span>
    <span class="n">nocc</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nvir</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">t2_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t2_aaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">c2_aaaa</span><span class="p">)</span>
    <span class="n">t2_aaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">t2_aaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t2_abab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t2_abab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">c2_abab</span><span class="p">)</span>
    <span class="n">t2_abab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t2_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t2_bbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">c2_bbbb</span><span class="p">)</span>
    <span class="n">t2_bbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">t2_bbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span></div>



<div class="viewcode-block" id="t2_rhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t2_rhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t2_rhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
    <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t2</span></div>



<div class="viewcode-block" id="t3_uhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t3_uhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t3_uhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">c3</span><span class="p">):</span>
    <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_bb</span> <span class="o">=</span> <span class="n">t1</span>
    <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span> <span class="o">=</span> <span class="n">t2</span>
    <span class="n">c3_aaaaaa</span><span class="p">,</span> <span class="n">c3_abaaba</span><span class="p">,</span> <span class="n">c3_babbab</span><span class="p">,</span> <span class="n">c3_bbbbbb</span> <span class="o">=</span> <span class="n">c3</span>
    <span class="n">nocc</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nvir</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">t3_aaaaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">c3_aaaaaa</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,jica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t3_aaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_abaaba</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">c3_abaaba</span><span class="p">)</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">t3_abaaba</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_babbab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">c3_babbab</span><span class="p">)</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,jibc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jiba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">t3_babbab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_bbbbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">c3_bbbbbb</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,jica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t3_bbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t3_aaaaaa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">,</span> <span class="n">t3_bbbbbb</span></div>



<div class="viewcode-block" id="t3_rhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t3_rhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t3_rhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">c3</span><span class="p">):</span>
    <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijba-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t3</span></div>



<div class="viewcode-block" id="t4_uhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t4_uhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t4_uhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">c4</span><span class="p">):</span>
    <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_bb</span> <span class="o">=</span> <span class="n">t1</span>
    <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span> <span class="o">=</span> <span class="n">t2</span>
    <span class="n">t3_aaaaaa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">,</span> <span class="n">t3_bbbbbb</span> <span class="o">=</span> <span class="n">t3</span>
    <span class="n">c4_aaaaaaaa</span><span class="p">,</span> <span class="n">c4_aaabaaab</span><span class="p">,</span> <span class="n">c4_abababab</span><span class="p">,</span> <span class="n">c4_abbbabbb</span><span class="p">,</span> <span class="n">c4_bbbbbbbb</span> <span class="o">=</span> <span class="n">c4</span>
    <span class="n">nocc</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nvir</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t1_bb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_aaaaaaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;la,ijkbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lb,ijkacd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lc,ijkabd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,ijkabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,jkab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilbd,jkac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,jkbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilbc,jkad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilac,jkbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilab,jkcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikcd,jlab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikbd,jlac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikad,jlbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikbc,jlad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikac,jlbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikab,jlcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcd,klab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijbd,klac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijad,klbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijbc,klad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijac,klbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ljkdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;id,ljkcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,ljkdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,ljkdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,jkac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,likdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,likdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,likdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jd,likcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,jkac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,lijdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kd,lijcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,lijdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaaaaaaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,lijdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_aaabaaab</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jlkbdc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jlkadb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ilkbdc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ilkadb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,iljbdc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,iljadb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;klcd,ijab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;klad,ijbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jlcd,ikab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jlad,ikbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,jkab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,jkbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilbd,kjca-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;klbd,jica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jlbd,kica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_aaaaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,kijcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jikbac-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,kiba-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,jica-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jiba-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ldkjca-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ldjica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_aaabaaab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ldkica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_abababab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jklbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jklbad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,jilbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jilbad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilab,kjcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcb,kjad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcd,klab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijad,klcb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,kjcb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,kjab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcb,klad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_aaaa</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kica,ljdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jikbac-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t3_abaaba</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,kiba-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,jica-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jiba-&gt;iajkbc&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jd,lbkica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lb,jdkica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ldkica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,jbkica-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_abbbabbb</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kilcad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jd,kilbac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,jilcad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kd,jilbac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lb,jikcad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,jikbac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,jkbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilab,jkcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikad,jlbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikab,jlcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijad,klbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilac,kjdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijac,lkdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikac,ljdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,ljkdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_aa</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikjacb-&gt;ijabkc&quot;</span><span class="p">,</span> <span class="n">t3_babbab</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijabkc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijabkc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,kicb-&gt;ijabkc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,kica-&gt;ijabkc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_abab</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,lkdbia-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lc,kjdbia-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_abbbabbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ljdbia-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_bbbbbbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;la,ijkbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lb,ijkacd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lc,ijkabd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,ijkabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,jkab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilbd,jkac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,jkbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilbc,jkad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilac,jkbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilab,jkcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikcd,jlab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikbd,jlac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikad,jlbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikbc,jlad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikac,jlbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikab,jlcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcd,klab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijbd,klac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijad,klbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijbc,klad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijac,klbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,kjca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ljkdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;id,ljkcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,ljkdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,ljkdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,jkac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,likdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,likdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,likdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jd,likcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3_bbbbbb</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,jkac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">t2_bbbb</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,lijdac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kd,lijcab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,lijdbc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_bbbbbbbb</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,lijdab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1_bb</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t4_aaaaaaaa</span><span class="p">,</span> <span class="n">t4_aaabaaab</span><span class="p">,</span> <span class="n">t4_abababab</span><span class="p">,</span> <span class="n">t4_abbbabbb</span><span class="p">,</span> <span class="n">t4_bbbbbbbb</span></div>



<div class="viewcode-block" id="t4_rhf">
<a class="viewcode-back" href="../../../../../apidoc/vayesta.core.types.wf.html#vayesta.core.types.wf.t_to_c.t4_rhf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t4_rhf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">c4</span><span class="p">):</span>
    <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">c4_abaaabaa</span><span class="p">,</span> <span class="n">c4_abababab</span> <span class="o">=</span> <span class="n">c4</span>
    <span class="n">t4_abababab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_abababab</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ilkadc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jd,ilkabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lb,ijkadc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,ijkabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijad,klcb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcb,klad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcd,klab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilab,kjcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilad,kjcb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcb,kjad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,kjab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijba-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikac,jldb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,jibc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jiba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jklbad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,jilbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jklbcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abababab</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,jilbad-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="c1"># t4_abaaabaa += einsum(&quot;ikljacdb-&gt;ijklabcd&quot;, c4_abaaabaa)  # NOTE incorrect in generated eqns</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijklabcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">c4_abaaabaa</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjlcbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;id,kjlabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijlcbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kd,ijlabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;la,ijkcbd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ld,ijkabc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,klcd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab,kldc-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijdb,klac-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijdb,klca-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilac,kjdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilcd,kjab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilca,kjdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ildc,kjab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikac,ljdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikcd,ljab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikca,ljdb-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ikdc,ljab-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijba-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kjcb,ilda-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijab-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijba-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,ja-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x1</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jb-&gt;ijab&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijcb,klda-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ljcb,ikda-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkacb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkbac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ja,ikcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,ikca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jc,ikba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijbc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijac-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kb,ijca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijba-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,jkcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ib,jkca-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x2</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,jkab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;jb,iklacd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nvir</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkabc-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ia,kjcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ka,ijcb-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">x3</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijab-&gt;ijkabc&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ic,kjlabd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;lc,ijkabd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
    <span class="n">t4_abaaabaa</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;kc,ijlabd-&gt;ijklabcd&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">t4_abaaabaa</span><span class="p">,</span> <span class="n">t4_abababab</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>