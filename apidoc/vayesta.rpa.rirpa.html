

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vayesta.rpa.rirpa &mdash; Vayesta 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vayesta.solver" href="vayesta.solver.html" />
    <link rel="prev" title="vayesta.rpa" href="vayesta.rpa.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Vayesta
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vayesta</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">API</a></li>
          <li class="breadcrumb-item"><a href="vayesta.rpa.html">vayesta.rpa</a></li>
      <li class="breadcrumb-item active">vayesta.rpa.rirpa</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/vayesta.rpa.rirpa.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vayesta-rpa-rirpa">
<h1>vayesta.rpa.rirpa<a class="headerlink" href="#vayesta-rpa-rirpa" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-vayesta.rpa.rirpa.NI_eval">
<span id="vayesta-rpa-rirpa-ni-eval"></span><h2>vayesta.rpa.rirpa.NI_eval<a class="headerlink" href="#module-vayesta.rpa.rirpa.NI_eval" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NIException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NIException</span></span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NIException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NIException" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NIException.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NIException.args" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NIException.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NIException.with_traceback" title="Link to this definition"></a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NumericalIntegratorBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for numerical integration over semi-infinite and infinite limits.
Subclasses implementing a specific quadrature need to define</p>
<dl class="simple">
<dt>Subclasses implementing specific evaluations need to define:</dt><dd><p>.eval_contrib
.eval_diag_contrib
.eval_diag_deriv_contrib
.eval_diag_deriv2_contrib
.eval_diag_exact</p>
</dd>
</dl>
<p>A new .__init__ assigning any required attributes and a .fix_params may also be required, depending upon the
particular form of the integral to be approximated.
Might be able to write this as a factory class, but this’ll do for now.</p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.get_quad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_deriv_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_deriv2_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_NI_approx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_NI_approx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_NI_approx_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id1"><span class="problematic" id="id2">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.eval_diag_NI_approx_deriv2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id3"><span class="problematic" id="id4">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.test_diag_derivs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.opt_quadrature_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.fix_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.get_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.kernel_adaptive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.l2_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.max_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorBase.get_quad_vals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NumericalIntegratorClenCur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCur.calculate_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCur.eval_NI_approx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id5"><span class="problematic" id="id6">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id7"><span class="problematic" id="id8">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NumericalIntegratorClenCurInfinite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCurInfinite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCur</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCurInfinite.get_quad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id9"><span class="problematic" id="id10">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id11"><span class="problematic" id="id12">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NumericalIntegratorClenCurSemiInfinite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCurSemiInfinite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCur"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCur</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorClenCurSemiInfinite.get_quad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id13"><span class="problematic" id="id14">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id15"><span class="problematic" id="id16">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NumericalIntegratorGaussianSemiInfinite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorGaussianSemiInfinite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NumericalIntegratorGaussianSemiInfinite.get_quad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id17"><span class="problematic" id="id18">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id19"><span class="problematic" id="id20">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.gen_ClenCur_quad_inf">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">gen_ClenCur_quad_inf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#gen_ClenCur_quad_inf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.gen_ClenCur_quad_inf" title="Link to this definition"></a></dt>
<dd><p>Generate quadrature points and weights for Clenshaw-Curtis quadrature over infinite range (-inf to +inf)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.gen_ClenCur_quad_semiinf">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">gen_ClenCur_quad_semiinf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#gen_ClenCur_quad_semiinf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.gen_ClenCur_quad_semiinf" title="Link to this definition"></a></dt>
<dd><p>Generate quadrature points and weights for Clenshaw-Curtis quadrature over semiinfinite range (0 to +inf)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.NI_eval.</span></span><span class="sig-name descname"><span class="pre">NICheckInf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NICheckInf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCurInfinite</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id21"><span class="problematic" id="id22">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id23"><span class="problematic" id="id24">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/NI_eval.html#NICheckInf.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.NI_eval.NICheckInf.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa.RIRPA">
<span id="vayesta-rpa-rirpa-rirpa"></span><h2>vayesta.rpa.rirpa.RIRPA<a class="headerlink" href="#module-vayesta.rpa.rirpa.RIRPA" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.memory_string">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIRPA.</span></span><span class="sig-name descname"><span class="pre">memory_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.memory_string" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIRPA.</span></span><span class="sig-name descname"><span class="pre">ssRIRRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rixc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Approach based on equations expressed succinctly in the appendix of
Furche, F. (2001). PRB, 64(19), 195120. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.64.195120">https://doi.org/10.1103/PhysRevB.64.195120</a>
WARNING: Should only be used with canonical mean-field orbital coefficients in mf.mo_coeff and RHF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dfmf</strong> (<em>pyscf.scf.SCF</em>) – PySCF density-fitted mean-field object.</p></li>
<li><p><strong>rixc</strong> (<em>tuple</em><em> of </em><em>tuples</em><em> or </em><em>arrays</em><em>, </em><em>optional</em>) – low-rank decomposition of exchange-correlation kernel. First tuple separates two different spin channels, and
the second the left- and right-sides of an asymmetric decomposition. Default value is None.</p></li>
<li><p><strong>log</strong> (<em>logging object</em><em>, </em><em>optional</em>) – Default value is None.</p></li>
<li><p><strong>err_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold defining estimated error at which to print various accuracy warnings.
Default value is 1e-6.</p></li>
<li><p><strong>svd_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold defining negligible singular values when compressing various decompositions.
Default value is 1e-12.</p></li>
<li><p><strong>lov</strong> (<em>np.ndarray</em><em> or </em><em>tuple</em><em> of </em><em>np.ndarray</em><em>, </em><em>optional</em>) – occupied-virtual CDERIs in mo basis of provided mean field. If None recalculated from AOs.
Default value is None.</p></li>
<li><p><strong>compress</strong> (<em>int</em><em>, </em><em>optional</em>) – How thoroughly to attempt compression of the low-rank representations of various matrices.
Thresholds are:
- above 0: Compress representation of (A+B)(A-B) once constructed, prior to main calculation.
- above 3: Compress representations of A+B and A-B separately prior to constructing (A+B)(A-B) or (A+B)^{-1}
- above 5: Compress representation of (A+B)^{-1} prior to contracting. This is basically never worthwhile.
Note that in all cases these compressions will have computational cost O(N_{aux}^2 ov), the same as our later
computations, and so a tradeoff must be made between reducing the N_{aux} in later calculations vs the cost
of compression. Default value is 0.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kdf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kdf</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.nocc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.nvir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.naux_eri">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux_eri</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.naux_eri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.ov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.ov" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.ov_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.ov_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy_occ" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mo_energy_vir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.e_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_corr</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.e_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.eps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.D">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_moms">
<span class="sig-name descname"><span class="pre">kernel_moms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_moment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.kernel_moms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_moms" title="Link to this definition"></a></dt>
<dd><p>Calculates all density-density moments up to and including <a href="#id25"><span class="problematic" id="id26">`</span></a>max_moment’ with one index projected into
<a href="#id27"><span class="problematic" id="id28">`</span></a>target_rot’  space.
For details of numerical integration approach see <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p>
<p>Runtime: O(n_{points} ((n_{target} + n_{aux}) n_{aux} ov + n_{aux}^3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_moment</strong> (<em>int</em>) – Maximum moment of the dd response to return.</p></li>
<li><p><strong>target_rot</strong> (<em>array_like</em><em>, of </em><em>size</em><em> (</em><em>n_{target}</em><em>, </em><em>o_a v_a + o_b v_b</em><em>)</em>) – Projector for one index of the moment.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional.</em>) – Integer number of points to use in numerical integrations; will be increased to next highest multiple of
4 for error estimation purposes. Default: 48 (excessive).</p></li>
<li><p><strong>integral_deduct</strong> (<em>str</em><em>, </em><em>optional.</em>) – What terms to deduct from numerical integration.
Options are “HO” (default), “D”, and None, corresponding to deducting both the mean-field contribution
and additional higher-order terms, just the mean-field contribution, or nothing.
For discussion of the specific approaches see Appendix A of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p></li>
<li><p><strong>ainit</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value of grid scaling to initialise optimisation from. If <a href="#id29"><span class="problematic" id="id30">`</span></a>opt_quad’ is False, this value of a is used.
Default: 10.0</p></li>
<li><p><strong>opt_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to optimise the grid spacing <a href="#id31"><span class="problematic" id="id32">`</span></a>a’. Default: True</p></li>
<li><p><strong>adaptive_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to use scipy adaptive quadrature for calculation. Requires prohibitively more evaluations but can
provide validation of usual approach. Default: False</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value or electron interaction scaling in adiabatic connection. Default: 1.0</p></li>
<li><p><strong>ri_decomps</strong> (<em>iterable</em><em> of </em><em>three tuples</em><em> of </em><em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional.</em>) – Low-rank RI expressions (S_L,S_R) for (A-B)(A+B), A+B and A-B, such that the non-diagonal contribution
to each is given by S_L S_R^T. If <a href="#id33"><span class="problematic" id="id34">`</span></a>None’ these will be contructed at O(N^4) cost. Default: None</p></li>
<li><p><strong>analytic_lower_bound</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to compute analytic lower bound on the error of the computed zeroth dd moment. Computation
requires O(N^4) operation, and given limited utility of lower bound this is optional.
Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments</strong> (<em>array_like, shape (max_moment + 1, n_{tar}, o_a v_a + o_b v_b)</em>) – Array storing the i^th dd moment in the space defined by <a href="#id35"><span class="problematic" id="id36">`</span></a>target_rot’ in moments[i].</p></li>
<li><p><strong>err0</strong> (<em>tuple.</em>) – Bounds on the error, in form (upper_bound, lower_bound). If <a href="#id37"><span class="problematic" id="id38">`</span></a>analytic_lower_bound’=False lower bound
will be None.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mult_apbinv">
<span class="sig-name descname"><span class="pre">mult_apbinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integral</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb_inv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.mult_apbinv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.mult_apbinv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.test_eta0_error">
<span class="sig-name descname"><span class="pre">test_eta0_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_amb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.test_eta0_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.test_eta0_error" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Test how well our obtained zeroth moment obeys relation used to derive it, namely</dt><dd><p>A-B = eta0 (A+B) eta0</p>
</dd>
</dl>
<p>From this we can estimate the error in eta0 using Cauchy-Schwartz.
For details see Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eq. 96-99.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_trMPrt">
<span class="sig-name descname"><span class="pre">kernel_trMPrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.kernel_trMPrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_trMPrt" title="Link to this definition"></a></dt>
<dd><p>Evaluate Tr((MP)^(1/2)).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_energy">
<span class="sig-name descname"><span class="pre">kernel_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.kernel_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.kernel_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.direct_AC_integration">
<span class="sig-name descname"><span class="pre">direct_AC_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_projectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_constrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.direct_AC_integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.direct_AC_integration" title="Link to this definition"></a></dt>
<dd><p>Perform direct integration of the adiabatic connection for RPA correlation energy.
This will be preferable when the xc kernel is comparable or larger in magnitude to the coulomb kernel, as it
only requires evaluation of the moment and not its inverse.
local_rot describes the rotation of the ov-excitations to the space of local excitations within a cluster, while
fragment_projectors gives the projector within this local excitation space to the actual fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_gap">
<span class="sig-name descname"><span class="pre">get_gap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calc_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.get_gap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_gap" title="Link to this definition"></a></dt>
<dd><p>Calculate the RPA gap using a Davidson solver. First checks that A+B and A-B are PSD by calculating their
lowest eigenvalues. For a fixed number of eigenvalues in each case this scales as O(N^3), so shouldn’t be
prohibitively expensive.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_compressed_MP">
<span class="sig-name descname"><span class="pre">get_compressed_MP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.get_compressed_MP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_compressed_MP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.check_errors">
<span class="sig-name descname"><span class="pre">check_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.check_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.check_errors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.construct_RI_AB">
<span class="sig-name descname"><span class="pre">construct_RI_AB</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.construct_RI_AB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.construct_RI_AB" title="Link to this definition"></a></dt>
<dd><p>Construct the RI expressions for the deviation of A+B and A-B from D.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.compress_low_rank">
<span class="sig-name descname"><span class="pre">compress_low_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.compress_low_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.compress_low_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_apb_eri_ri">
<span class="sig-name descname"><span class="pre">get_apb_eri_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.get_apb_eri_ri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_apb_eri_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_ab_xc_ri">
<span class="sig-name descname"><span class="pre">get_ab_xc_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.get_ab_xc_ri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_ab_xc_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.get_cderi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.test_spectral_rep">
<span class="sig-name descname"><span class="pre">test_spectral_rep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.test_spectral_rep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.test_spectral_rep" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.ssRIRRPA.record_memory">
<span class="sig-name descname"><span class="pre">record_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#ssRIRRPA.record_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA.record_memory" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.construct_product_RI">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIRPA.</span></span><span class="sig-name descname"><span class="pre">construct_product_RI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#construct_product_RI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.construct_product_RI" title="Link to this definition"></a></dt>
<dd><p>Given two matrices expressed as low-rank modifications, cderi_1 and cderi_2, of some full-rank matrix D,
construct the RI expression for the deviation of their product from D**2.
The rank of the resulting deviation is at most the sum of the ranks of the original modifications.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.construct_inverse_RI">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIRPA.</span></span><span class="sig-name descname"><span class="pre">construct_inverse_RI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#construct_inverse_RI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.construct_inverse_RI" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIRPA.compress_low_rank">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIRPA.</span></span><span class="sig-name descname"><span class="pre">compress_low_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIRPA.html#compress_low_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIRPA.compress_low_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa.RIURPA">
<span id="vayesta-rpa-rirpa-riurpa"></span><h2>vayesta.rpa.rirpa.RIURPA<a class="headerlink" href="#module-vayesta.rpa.rirpa.RIURPA" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIURPA.</span></span><span class="sig-name descname"><span class="pre">ssRIURPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rixc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIURPA.html#ssRIURPA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA" title="vayesta.rpa.rirpa.RIRPA.ssRIRRPA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssRIRRPA</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_occ" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.nmo" title="Link to this definition"></a></dt>
<dd><p>Total number of molecular orbitals (MOs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.nocc" title="Link to this definition"></a></dt>
<dd><p>Number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.nvir" title="Link to this definition"></a></dt>
<dd><p>Number of virtual MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.naux_eri">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux_eri</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.naux_eri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy_occ" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mo_energy_vir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.ov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.ov" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.ov_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.ov_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.D">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_apb_eri_ri">
<span class="sig-name descname"><span class="pre">get_apb_eri_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIURPA.html#ssRIURPA.get_apb_eri_ri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_apb_eri_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.check_errors">
<span class="sig-name descname"><span class="pre">check_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.check_errors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.compress_low_rank">
<span class="sig-name descname"><span class="pre">compress_low_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.compress_low_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.construct_RI_AB">
<span class="sig-name descname"><span class="pre">construct_RI_AB</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.construct_RI_AB" title="Link to this definition"></a></dt>
<dd><p>Construct the RI expressions for the deviation of A+B and A-B from D.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.direct_AC_integration">
<span class="sig-name descname"><span class="pre">direct_AC_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_projectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_constrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.direct_AC_integration" title="Link to this definition"></a></dt>
<dd><p>Perform direct integration of the adiabatic connection for RPA correlation energy.
This will be preferable when the xc kernel is comparable or larger in magnitude to the coulomb kernel, as it
only requires evaluation of the moment and not its inverse.
local_rot describes the rotation of the ov-excitations to the space of local excitations within a cluster, while
fragment_projectors gives the projector within this local excitation space to the actual fragment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.e_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_corr</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.e_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.eps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_ab_xc_ri">
<span class="sig-name descname"><span class="pre">get_ab_xc_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIURPA.html#ssRIURPA.get_ab_xc_ri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_ab_xc_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_compressed_MP">
<span class="sig-name descname"><span class="pre">get_compressed_MP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_compressed_MP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_gap">
<span class="sig-name descname"><span class="pre">get_gap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calc_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_gap" title="Link to this definition"></a></dt>
<dd><p>Calculate the RPA gap using a Davidson solver. First checks that A+B and A-B are PSD by calculating their
lowest eigenvalues. For a fixed number of eigenvalues in each case this scales as O(N^3), so shouldn’t be
prohibitively expensive.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.kdf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kdf</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.kdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_energy">
<span class="sig-name descname"><span class="pre">kernel_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_moms">
<span class="sig-name descname"><span class="pre">kernel_moms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_moment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_moms" title="Link to this definition"></a></dt>
<dd><p>Calculates all density-density moments up to and including <a href="#id39"><span class="problematic" id="id40">`</span></a>max_moment’ with one index projected into
<a href="#id41"><span class="problematic" id="id42">`</span></a>target_rot’  space.
For details of numerical integration approach see <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p>
<p>Runtime: O(n_{points} ((n_{target} + n_{aux}) n_{aux} ov + n_{aux}^3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_moment</strong> (<em>int</em>) – Maximum moment of the dd response to return.</p></li>
<li><p><strong>target_rot</strong> (<em>array_like</em><em>, of </em><em>size</em><em> (</em><em>n_{target}</em><em>, </em><em>o_a v_a + o_b v_b</em><em>)</em>) – Projector for one index of the moment.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional.</em>) – Integer number of points to use in numerical integrations; will be increased to next highest multiple of
4 for error estimation purposes. Default: 48 (excessive).</p></li>
<li><p><strong>integral_deduct</strong> (<em>str</em><em>, </em><em>optional.</em>) – What terms to deduct from numerical integration.
Options are “HO” (default), “D”, and None, corresponding to deducting both the mean-field contribution
and additional higher-order terms, just the mean-field contribution, or nothing.
For discussion of the specific approaches see Appendix A of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p></li>
<li><p><strong>ainit</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value of grid scaling to initialise optimisation from. If <a href="#id43"><span class="problematic" id="id44">`</span></a>opt_quad’ is False, this value of a is used.
Default: 10.0</p></li>
<li><p><strong>opt_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to optimise the grid spacing <a href="#id45"><span class="problematic" id="id46">`</span></a>a’. Default: True</p></li>
<li><p><strong>adaptive_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to use scipy adaptive quadrature for calculation. Requires prohibitively more evaluations but can
provide validation of usual approach. Default: False</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value or electron interaction scaling in adiabatic connection. Default: 1.0</p></li>
<li><p><strong>ri_decomps</strong> (<em>iterable</em><em> of </em><em>three tuples</em><em> of </em><em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional.</em>) – Low-rank RI expressions (S_L,S_R) for (A-B)(A+B), A+B and A-B, such that the non-diagonal contribution
to each is given by S_L S_R^T. If <a href="#id47"><span class="problematic" id="id48">`</span></a>None’ these will be contructed at O(N^4) cost. Default: None</p></li>
<li><p><strong>analytic_lower_bound</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to compute analytic lower bound on the error of the computed zeroth dd moment. Computation
requires O(N^4) operation, and given limited utility of lower bound this is optional.
Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments</strong> (<em>array_like, shape (max_moment + 1, n_{tar}, o_a v_a + o_b v_b)</em>) – Array storing the i^th dd moment in the space defined by <a href="#id49"><span class="problematic" id="id50">`</span></a>target_rot’ in moments[i].</p></li>
<li><p><strong>err0</strong> (<em>tuple.</em>) – Bounds on the error, in form (upper_bound, lower_bound). If <a href="#id51"><span class="problematic" id="id52">`</span></a>analytic_lower_bound’=False lower bound
will be None.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_trMPrt">
<span class="sig-name descname"><span class="pre">kernel_trMPrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.kernel_trMPrt" title="Link to this definition"></a></dt>
<dd><p>Evaluate Tr((MP)^(1/2)).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.mult_apbinv">
<span class="sig-name descname"><span class="pre">mult_apbinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integral</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb_inv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.mult_apbinv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.record_memory">
<span class="sig-name descname"><span class="pre">record_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.record_memory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.test_eta0_error">
<span class="sig-name descname"><span class="pre">test_eta0_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_amb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.test_eta0_error" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Test how well our obtained zeroth moment obeys relation used to derive it, namely</dt><dd><p>A-B = eta0 (A+B) eta0</p>
</dd>
</dl>
<p>From this we can estimate the error in eta0 using Cauchy-Schwartz.
For details see Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eq. 96-99.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.test_spectral_rep">
<span class="sig-name descname"><span class="pre">test_spectral_rep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.test_spectral_rep" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIURPA.html#ssRIURPA.get_cderi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIURPA.ssRIURPA.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa.RIdRRPA">
<span id="vayesta-rpa-rirpa-ridrrpa"></span><h2>vayesta.rpa.rirpa.RIdRRPA<a class="headerlink" href="#module-vayesta.rpa.rirpa.RIdRRPA" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.RIdRRPA.</span></span><span class="sig-name descname"><span class="pre">ssRIdRRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rixc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.RIRPA.ssRIRRPA" title="vayesta.rpa.rirpa.RIRPA.ssRIRRPA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssRIRRPA</span></code></a></p>
<p>Class for computing direct RPA correlated quantites with a restricted reference state.</p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_moms">
<span class="sig-name descname"><span class="pre">kernel_moms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_moment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_spatial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.kernel_moms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_moms" title="Link to this definition"></a></dt>
<dd><p>Calculates all density-density moments up to and including <a href="#id53"><span class="problematic" id="id54">`</span></a>max_moment’ with one index projected into
<a href="#id55"><span class="problematic" id="id56">`</span></a>target_rot’  space.
For details of numerical integration approach see <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p>
<p>Runtime: O(n_{points} ((n_{target} + n_{aux}) n_{aux} ov + n_{aux}^3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_moment</strong> (<em>int</em>) – Maximum moment of the dd response to return.</p></li>
<li><p><strong>target_rot</strong> (<em>array_like</em><em>, of </em><em>size</em><em> (</em><em>n_{target}</em><em>, </em><em>o_a v_a + o_b v_b</em><em>)</em>) – Projector for one index of the moment.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional.</em>) – Integer number of points to use in numerical integrations; will be increased to next highest multiple of
4 for error estimation purposes. Default: 48 (excessive).</p></li>
<li><p><strong>integral_deduct</strong> (<em>str</em><em>, </em><em>optional.</em>) – What terms to deduct from numerical integration.
Options are “HO” (default), “D”, and None, corresponding to deducting both the mean-field contribution
and additional higher-order terms, just the mean-field contribution, or nothing.
For discussion of the specific approaches see Appendix A of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>.</p></li>
<li><p><strong>ainit</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value of grid scaling to initialise optimisation from. If <a href="#id57"><span class="problematic" id="id58">`</span></a>opt_quad’ is False, this value of a is used.
Default: 10.0</p></li>
<li><p><strong>opt_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to optimise the grid spacing <a href="#id59"><span class="problematic" id="id60">`</span></a>a’. Default: True</p></li>
<li><p><strong>adaptive_quad</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to use scipy adaptive quadrature for calculation. Requires prohibitively more evaluations but can
provide validation of usual approach. Default: False</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional.</em>) – Value or electron interaction scaling in adiabatic connection. Default: 1.0</p></li>
<li><p><strong>ri_decomps</strong> (<em>iterable</em><em> of </em><em>three tuples</em><em> of </em><em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional.</em>) – Low-rank RI expressions (S_L,S_R) for (A-B)(A+B), A+B and A-B, such that the non-diagonal contribution
to each is given by S_L S_R^T. If <a href="#id61"><span class="problematic" id="id62">`</span></a>None’ these will be contructed at O(N^4) cost. Default: None</p></li>
<li><p><strong>analytic_lower_bound</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to compute analytic lower bound on the error of the computed zeroth dd moment. Computation
requires O(N^4) operation, and given limited utility of lower bound this is optional.
Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>moments</strong> (<em>array_like, shape (max_moment + 1, n_{tar}, o_a v_a + o_b v_b)</em>) – Array storing the i^th dd moment in the space defined by <a href="#id63"><span class="problematic" id="id64">`</span></a>target_rot’ in moments[i].</p></li>
<li><p><strong>err0</strong> (<em>tuple.</em>) – Bounds on the error, in form (upper_bound, lower_bound). If <a href="#id65"><span class="problematic" id="id66">`</span></a>analytic_lower_bound’=False lower bound
will be None.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_trMPrt">
<span class="sig-name descname"><span class="pre">kernel_trMPrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.kernel_trMPrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_trMPrt" title="Link to this definition"></a></dt>
<dd><p>Evaluate Tr((MP)^(1/2)).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_energy">
<span class="sig-name descname"><span class="pre">kernel_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.kernel_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kernel_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_compressed_MP">
<span class="sig-name descname"><span class="pre">get_compressed_MP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.get_compressed_MP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_compressed_MP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.check_target_rot">
<span class="sig-name descname"><span class="pre">check_target_rot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.check_target_rot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.check_target_rot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.compress_target_rot">
<span class="sig-name descname"><span class="pre">compress_target_rot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/RIdRRPA.html#ssRIdRRPA.compress_target_rot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.compress_target_rot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.D">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.check_errors">
<span class="sig-name descname"><span class="pre">check_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.check_errors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.compress_low_rank">
<span class="sig-name descname"><span class="pre">compress_low_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.compress_low_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.construct_RI_AB">
<span class="sig-name descname"><span class="pre">construct_RI_AB</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.construct_RI_AB" title="Link to this definition"></a></dt>
<dd><p>Construct the RI expressions for the deviation of A+B and A-B from D.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.direct_AC_integration">
<span class="sig-name descname"><span class="pre">direct_AC_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_projectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_constrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.direct_AC_integration" title="Link to this definition"></a></dt>
<dd><p>Perform direct integration of the adiabatic connection for RPA correlation energy.
This will be preferable when the xc kernel is comparable or larger in magnitude to the coulomb kernel, as it
only requires evaluation of the moment and not its inverse.
local_rot describes the rotation of the ov-excitations to the space of local excitations within a cluster, while
fragment_projectors gives the projector within this local excitation space to the actual fragment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.e_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_corr</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.e_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.eps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_ab_xc_ri">
<span class="sig-name descname"><span class="pre">get_ab_xc_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_ab_xc_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_apb_eri_ri">
<span class="sig-name descname"><span class="pre">get_apb_eri_ri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_apb_eri_ri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_gap">
<span class="sig-name descname"><span class="pre">get_gap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calc_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.get_gap" title="Link to this definition"></a></dt>
<dd><p>Calculate the RPA gap using a Davidson solver. First checks that A+B and A-B are PSD by calculating their
lowest eigenvalues. For a fixed number of eigenvalues in each case this scales as O(N^3), so shouldn’t be
prohibitively expensive.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kdf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kdf</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.kdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy_occ" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mo_energy_vir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mult_apbinv">
<span class="sig-name descname"><span class="pre">mult_apbinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integral</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb_inv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.mult_apbinv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.naux_eri">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux_eri</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.naux_eri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.nocc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.nvir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.ov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.ov" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.ov_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_tot</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.ov_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.record_memory">
<span class="sig-name descname"><span class="pre">record_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.record_memory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.test_eta0_error">
<span class="sig-name descname"><span class="pre">test_eta0_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_apb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_amb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.test_eta0_error" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Test how well our obtained zeroth moment obeys relation used to derive it, namely</dt><dd><p>A-B = eta0 (A+B) eta0</p>
</dd>
</dl>
<p>From this we can estimate the error in eta0 using Cauchy-Schwartz.
For details see Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eq. 96-99.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.test_spectral_rep">
<span class="sig-name descname"><span class="pre">test_spectral_rep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.RIdRRPA.ssRIdRRPA.test_spectral_rep" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa.energy_NI">
<span id="vayesta-rpa-rirpa-energy-ni"></span><h2>vayesta.rpa.rirpa.energy_NI<a class="headerlink" href="#module-vayesta.rpa.rirpa.energy_NI" title="Link to this heading"></a></h2>
<p>Functionality to calculate zeroth moment via numerical integration</p>
<dl class="py exception">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NIError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.energy_NI.</span></span><span class="sig-name descname"><span class="pre">NIError</span></span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NIError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NIError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NIError.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NIError.args" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NIError.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NIError.with_traceback" title="Link to this definition"></a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.energy_NI.</span></span><span class="sig-name descname"><span class="pre">NITrRootMP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCurInfinite</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.get_F"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.get_Q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R (D^{-1} G) S_L^T
This is generally the limiting</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.eval_diag_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.eval_diag_deriv_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.eval_diag_deriv2_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.eval_diag_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id67"><span class="problematic" id="id68">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id69"><span class="problematic" id="id70">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.energy_NI.</span></span><span class="sig-name descname"><span class="pre">NITrRootMP_dRHF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP_dRHF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP" title="vayesta.rpa.rirpa.energy_NI.NITrRootMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">NITrRootMP</span></code></a></p>
<p>All provided quantities are now in spatial orbitals. This actually only requires an additional factor in the
get_Q method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id71"><span class="problematic" id="id72">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id73"><span class="problematic" id="id74">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP_dRHF.get_Q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R (D^{-1} G) S_L^T
This is generally the limiting</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/energy_NI.html#NITrRootMP_dRHF.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.energy_NI.NITrRootMP_dRHF.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa.momzero_NI">
<span id="vayesta-rpa-rirpa-momzero-ni"></span><h2>vayesta.rpa.rirpa.momzero_NI<a class="headerlink" href="#module-vayesta.rpa.rirpa.momzero_NI" title="Link to this heading"></a></h2>
<p>Functionality to calculate zeroth moment via numerical integration</p>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">NIMomZero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#NIMomZero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurInfinite"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCurInfinite</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#NIMomZero.get_F"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#NIMomZero.get_Q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R F S_L^T
This is generally the limiting step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id75"><span class="problematic" id="id76">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id77"><span class="problematic" id="id78">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.NIMomZero.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroDeductNone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.NIMomZero" title="vayesta.rpa.rirpa.momzero_NI.NIMomZero"><code class="xref py py-class docutils literal notranslate"><span class="pre">NIMomZero</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone.eval_diag_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone.eval_diag_deriv_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone.eval_diag_deriv2_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone.eval_diag_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductNone.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id79"><span class="problematic" id="id80">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id81"><span class="problematic" id="id82">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R F S_L^T
This is generally the limiting step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroDeductD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone" title="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductNone"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomzeroDeductNone</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductD.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id83"><span class="problematic" id="id84">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id85"><span class="problematic" id="id86">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R F S_L^T
This is generally the limiting step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroDeductHigherOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD" title="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductD"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomzeroDeductD</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder.eval_diag_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder.eval_diag_deriv_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder.eval_diag_deriv2_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder.eval_diag_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id87"><span class="problematic" id="id88">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id89"><span class="problematic" id="id90">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R F S_L^T
This is generally the limiting step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">BaseMomzeroOffset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorBase</span></code></a></p>
<p>NB this is an abstract class!</p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.get_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.eval_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.eval_diag_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.eval_diag_deriv_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.eval_diag_deriv2_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#BaseMomzeroOffset.eval_diag_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id91"><span class="problematic" id="id92">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id93"><span class="problematic" id="id94">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroOffsetCalcGaussLag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroOffsetCalcGaussLag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset" title="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMomzeroOffset</span></code></a>, <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorGaussianSemiInfinite"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorGaussianSemiInfinite</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id95"><span class="problematic" id="id96">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id97"><span class="problematic" id="id98">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcGaussLag.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroOffsetCalcCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroOffsetCalcCC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset" title="vayesta.rpa.rirpa.momzero_NI.BaseMomzeroOffset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMomzeroOffset</span></code></a>, <a class="reference internal" href="#vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite" title="vayesta.rpa.rirpa.NI_eval.NumericalIntegratorClenCurSemiInfinite"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalIntegratorClenCurSemiInfinite</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id99"><span class="problematic" id="id100">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id101"><span class="problematic" id="id102">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroOffsetCalcCC.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.diag_sqrt_contrib">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">diag_sqrt_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#diag_sqrt_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.diag_sqrt_contrib" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.diag_sqrt_grad">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">diag_sqrt_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#diag_sqrt_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.diag_sqrt_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.diag_sqrt_deriv2">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">diag_sqrt_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#diag_sqrt_deriv2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.diag_sqrt_deriv2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.momzero_NI.</span></span><span class="sig-name descname"><span class="pre">MomzeroDeductHigherOrder_dRHF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder_dRHF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder" title="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomzeroDeductHigherOrder</span></code></a></p>
<p>All provided quantities are now in spatial orbitals. This actually only requires an additional factor in the
get_Q method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.calculate_error">
<span class="sig-name descname"><span class="pre">calculate_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.calculate_error" title="Link to this definition"></a></dt>
<dd><p>Calculate error by solving cubic equation to model convergence as lpha e^{-eta n_p}.
This relies upon the Cauchy-Schwartz inequality, and assumes all errors are at their maximum values, so
generally overestimates the resulting error, which suits us well.
This also overestimates the error since it doesn’t account for the effect of quadrature grid optimisation, which
leads to our actual estimates converging more rapidly than they would with a static grid spacing parameter.</p>
<p>This approach is detailed in Appendix B of <a class="reference external" href="https://arxiv.org/abs/2301.09107">https://arxiv.org/abs/2301.09107</a>, Eqs. 100-104.</p>
<p>To understand the general behaviour of this approach, we can instead consider the simpler approximation that
the magnitude of a given difference is dominated by the least accurate estimate. This leads to the estimate of
the error resulting from our most accurate estimate as</p>
<blockquote>
<div><p>error = b ** 3 / a ** 2</p>
</div></blockquote>
<dl class="simple">
<dt>with the error in this approximation given by</dt><dd><p>error_error = b ** 2 / a ** 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.diagmat1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat1</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.diagmat1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.diagmat2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagmat2</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.diagmat2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_NI_approx">
<span class="sig-name descname"><span class="pre">eval_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation of the integral with a provided quadrature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_contrib">
<span class="sig-name descname"><span class="pre">eval_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to numerical integral of result at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx" title="Link to this definition"></a></dt>
<dd><p>Evaluate the NI approximation to the diagonal approximation of the integral.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx_deriv2">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_deriv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx_deriv2" title="Link to this definition"></a></dt>
<dd><p>Evaluate the second derivative w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id103"><span class="problematic" id="id104">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx_grad">
<span class="sig-name descname"><span class="pre">eval_diag_NI_approx_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_NI_approx_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluate the gradient w.r.t a of NI diagonal expression.
Note that for all quadratures the weights and quadrature point positions are proportional to the arbitrary
parameter <a href="#id105"><span class="problematic" id="id106">`</span></a>a’, so we can use the same expressions for the derivatives.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate contribution to integral of diagonal approximation at given frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_deriv2_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv2_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_deriv2_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate second derivative of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_deriv_contrib">
<span class="sig-name descname"><span class="pre">eval_diag_deriv_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_deriv_contrib" title="Link to this definition"></a></dt>
<dd><p>Evaluate gradient of contribution to integral of diagonal approximation at given frequency point,
w.r.t that frequency point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_exact">
<span class="sig-name descname"><span class="pre">eval_diag_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.eval_diag_exact" title="Link to this definition"></a></dt>
<dd><p>Provides an exact evaluation of the integral for the diagonal approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.fix_params" title="Link to this definition"></a></dt>
<dd><p>If required set parameters within ansatz; defined to ensure hook for functionality in future, will
not always be needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_F">
<span class="sig-name descname"><span class="pre">get_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_F" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_quad">
<span class="sig-name descname"><span class="pre">get_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_quad" title="Link to this definition"></a></dt>
<dd><p>Generate the appropriate Clenshaw-Curtis quadrature points and weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_quad_vals">
<span class="sig-name descname"><span class="pre">get_quad_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_quad_vals" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_quad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.kernel" title="Link to this definition"></a></dt>
<dd><p>Perform numerical integration. Put simply, fix any arbitrary parameters in the integral to be evaluated,
optimise the quadrature grid to ensure a diagonal approximation is exactly integrated then evaluate full
expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.kernel_adaptive">
<span class="sig-name descname"><span class="pre">kernel_adaptive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.kernel_adaptive" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.l2_scan">
<span class="sig-name descname"><span class="pre">l2_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.l2_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.max_scan">
<span class="sig-name descname"><span class="pre">max_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.max_scan" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.n_aux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_aux</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.n_aux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.npoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npoints</span></span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.opt_quadrature_diag">
<span class="sig-name descname"><span class="pre">opt_quadrature_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ainit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.opt_quadrature_diag" title="Link to this definition"></a></dt>
<dd><p>Optimise the quadrature to exactly integrate a diagonal approximation to the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.test_diag_derivs">
<span class="sig-name descname"><span class="pre">test_diag_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.test_diag_derivs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_Q">
<span class="sig-name descname"><span class="pre">get_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa/momzero_NI.html#MomzeroDeductHigherOrder_dRHF.get_Q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.momzero_NI.MomzeroDeductHigherOrder_dRHF.get_Q" title="Link to this definition"></a></dt>
<dd><p>Efficiently construct Q = S_R F S_L^T
This is generally the limiting step.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.rpa.rirpa">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vayesta.rpa.rirpa" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.rpa.rirpa.ssRIRPA">
<span class="sig-prename descclassname"><span class="pre">vayesta.rpa.rirpa.</span></span><span class="sig-name descname"><span class="pre">ssRIRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/rpa/rirpa.html#ssRIRPA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.rpa.rirpa.ssRIRPA" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vayesta.rpa.html" class="btn btn-neutral float-left" title="vayesta.rpa" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vayesta.solver.html" class="btn btn-neutral float-right" title="vayesta.solver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>