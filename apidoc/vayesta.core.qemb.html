

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vayesta.core.qemb &mdash; Vayesta 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vayesta.core.scmf" href="vayesta.core.scmf.html" />
    <link rel="prev" title="vayesta.core.fragmentation" href="vayesta.core.fragmentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Vayesta
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vayesta</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">API</a></li>
          <li class="breadcrumb-item"><a href="vayesta.core.html">vayesta.core</a></li>
      <li class="breadcrumb-item active">vayesta.core.qemb</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/vayesta.core.qemb.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vayesta-core-qemb">
<h1>vayesta.core.qemb<a class="headerlink" href="#vayesta-core-qemb" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-vayesta.core.qemb.corrfunc">
<span id="vayesta-core-qemb-corrfunc"></span><h2>vayesta.core.qemb.corrfunc<a class="headerlink" href="#module-vayesta.core.qemb.corrfunc" title="Link to this heading"></a></h2>
<p>Expectation values for quantum embedding methods.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.corrfunc.get_corrfunc_mf">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.corrfunc.</span></span><span class="sig-name descname"><span class="pre">get_corrfunc_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/corrfunc.html#get_corrfunc_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.corrfunc.get_corrfunc_mf" title="Link to this definition"></a></dt>
<dd><p>dm1 in MO basis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.corrfunc.get_corrfunc">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.corrfunc.</span></span><span class="sig-name descname"><span class="pre">get_corrfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2_with_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/corrfunc.html#get_corrfunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.corrfunc.get_corrfunc" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.corrfunc.get_corrfunc_unrestricted">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.corrfunc.</span></span><span class="sig-name descname"><span class="pre">get_corrfunc_unrestricted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2_with_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/corrfunc.html#get_corrfunc_unrestricted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.corrfunc.get_corrfunc_unrestricted" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vayesta.core.qemb.fragment">
<span id="vayesta-core-qemb-fragment"></span><h2>vayesta.core.qemb.fragment<a class="headerlink" href="#module-vayesta.core.qemb.fragment" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.get_fragment_mpi_rank">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.fragment.</span></span><span class="sig-name descname"><span class="pre">get_fragment_mpi_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.get_fragment_mpi_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.fragment.</span></span><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.fragment.</span></span><span class="sig-name descname"><span class="pre">Fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Flags">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_envelop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_secfrag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_parent_fragment_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.Flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Flags" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Flags.is_envelop">
<span class="sig-name descname"><span class="pre">is_envelop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Flags.is_envelop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Flags.is_secfrag">
<span class="sig-name descname"><span class="pre">is_secfrag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Flags.is_secfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Flags.bath_parent_fragment_id">
<span class="sig-name descname"><span class="pre">bath_parent_fragment_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Flags.bath_parent_fragment_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converged</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr_rpa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.Results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.fid">
<span class="sig-name descname"><span class="pre">fid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.fid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.converged" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.e_corr_rpa">
<span class="sig-name descname"><span class="pre">e_corr_rpa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.e_corr_rpa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.wf">
<span class="sig-name descname"><span class="pre">wf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.wf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.pwf">
<span class="sig-name descname"><span class="pre">pwf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.pwf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.Results.moms">
<span class="sig-name descname"><span class="pre">moms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.Results.moms" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.log_info">
<span class="sig-name descname"><span class="pre">log_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.log_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.log_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.n_frag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frag</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.n_frag" title="Link to this definition"></a></dt>
<dd><p>Number of fragment orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.nelectron">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelectron</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.nelectron" title="Link to this definition"></a></dt>
<dd><p>Number of mean-field electrons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.trimmed_name">
<span class="sig-name descname"><span class="pre">trimmed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.trimmed_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.trimmed_name" title="Link to this definition"></a></dt>
<dd><p>Fragment name trimmed to a given maximum length.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.id_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id_name</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.id_name" title="Link to this definition"></a></dt>
<dd><p>Use this whenever a unique name is needed (for example to open a separate file for each fragment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.change_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.hamil">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hamil</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_overlap">
<span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Get overlap between cluster orbitals, fragment orbitals, or MOs.</p>
<p>The return value is cached but not copied; do not modify the array in place without
creating a copy!</p>
<p>Examples:
&gt;&gt;&gt; s = self.get_overlap(‘cluster|mo’)
&gt;&gt;&gt; s = self.get_overlap(‘cluster|frag’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[occ]|cluster[occ]’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[vir]|cluster[vir]’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_coeff_env">
<span class="sig-name descname"><span class="pre">get_coeff_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_coeff_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_coeff_env" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.cluster">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_fragments_with_overlap">
<span class="sig-name descname"><span class="pre">get_fragments_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_fragments_with_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_fragments_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Get list of fragments which overlap both in occupied and virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.couple_to_fragment">
<span class="sig-name descname"><span class="pre">couple_to_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.couple_to_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.couple_to_fragment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.couple_to_fragments">
<span class="sig-name descname"><span class="pre">couple_to_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.couple_to_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.couple_to_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_fragment_mf_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mf_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_fragment_mf_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_fragment_mf_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the part of the mean-field energy associated with the fragment.</p>
<p>Does not include nuclear-nuclear repulsion!</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.contributes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contributes</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.contributes" title="Link to this definition"></a></dt>
<dd><p>True if fragment contributes to expectation values, else False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_fragment_projector">
<span class="sig-name descname"><span class="pre">get_fragment_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_fragment_projector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_fragment_projector" title="Link to this definition"></a></dt>
<dd><p>Projector for one index of amplitudes local energy expression.</p>
<p>Cost: N^2 if O(1) coeffs , N^3 if O(N) coeffs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>N</em><em>)</em>) – Occupied or virtual orbital coefficients.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return 1-p instead. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – Projection matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_mo_occupation">
<span class="sig-name descname"><span class="pre">get_mo_occupation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_mo_occupation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_mo_occupation" title="Link to this definition"></a></dt>
<dd><p>Get mean-field occupation numbers (diagonal of 1-RDM) of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>N</em><em>, </em><em>M</em><em>)</em>) – Orbital coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>occup</strong> – Occupation numbers of orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.canonicalize_mo">
<span class="sig-name descname"><span class="pre">canonicalize_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.canonicalize_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.canonicalize_mo" title="Link to this definition"></a></dt>
<dd><p>Diagonalize Fock matrix within subspace.</p>
<p>TODO: move to Embedding class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>eigenvalues</strong> (<em>ndarray</em>) – Return MO energies of canonicalized orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mo_canon</strong> (<em>ndarray</em>) – Canonicalized orbital coefficients.</p></li>
<li><p><strong>rot</strong> (<em>ndarray</em>) – Rotation matrix: np.dot(mo_coeff, rot) = mo_canon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.diagonalize_cluster_dm">
<span class="sig-name descname"><span class="pre">diagonalize_cluster_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.diagonalize_cluster_dm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.diagonalize_cluster_dm" title="Link to this definition"></a></dt>
<dd><p>Diagonalize cluster (fragment+bath) DM to get fully occupied and virtual orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>array</em><em> or </em><em>list</em><em> of </em><em>arrays</em>) – Orbital coefficients. If multiple are given, they will be stacked along their second dimension.</p></li>
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Mean-field density matrix, used to separate occupied and virtual cluster orbitals.
If None, <cite>self.mf.make_rdm1()</cite> is used. Default: None.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – If set, check that all eigenvalues of the cluster DM are close
to 0 or 2, with the tolerance given by tol. Default= 1e-4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c_cluster_occ</strong> (<em>(n(AO), n(occ cluster)) array</em>) – Occupied cluster orbital coefficients.</p></li>
<li><p><strong>c_cluster_vir</strong> (<em>(n(AO), n(vir cluster)) array</em>) – Virtual cluster orbital coefficients.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.project_ref_orbitals">
<span class="sig-name descname"><span class="pre">project_ref_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.project_ref_orbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.project_ref_orbitals" title="Link to this definition"></a></dt>
<dd><p>Project reference orbitals into available space in new geometry.</p>
<p>The projected orbitals will be ordered according to their eigenvalues within the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>ndarray</em>) – Orbital coefficients.</p></li>
<li><p><strong>c_ref</strong> (<em>ndarray</em>) – Orbital coefficients of reference orbitals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.copy" title="Link to this definition"></a></dt>
<dd><p>Create copy of fragment, without adding it to the fragments list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.add_tsymmetric_fragments">
<span class="sig-name descname"><span class="pre">add_tsymmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.add_tsymmetric_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.add_tsymmetric_fragments" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tvecs</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>symtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will be automatically added to base.fragments and
have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_parent">
<span class="sig-name descname"><span class="pre">get_symmetry_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_parent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_operation">
<span class="sig-name descname"><span class="pre">get_symmetry_operation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_generations">
<span class="sig-name descname"><span class="pre">get_symmetry_generations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_generations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_generations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_children">
<span class="sig-name descname"><span class="pre">get_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_children" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_tree">
<span class="sig-name descname"><span class="pre">get_symmetry_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_tree" title="Link to this definition"></a></dt>
<dd><p>Returns a recursive tree:</p>
<p>[(x, [children of x]), (y, [children of y]), …]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.loop_symmetry_children">
<span class="sig-name descname"><span class="pre">loop_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.loop_symmetry_children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.loop_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Loop over all symmetry related fragments, including children of children, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em><em> or </em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>optional</em>) – If arrays are passed, the symmetry operation of each symmetry related fragment will be
applied to this array along the axis given in <cite>axes</cite>.</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of axes, along which the symmetry operation is applied for each element of <cite>arrays</cite>.
If None, the first axis will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.n_symmetry_children">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_symmetry_children</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.n_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.symmetry_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symmetry_factor</span></span><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.symmetry_factor" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_symmetry_error">
<span class="sig-name descname"><span class="pre">get_symmetry_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_symmetry_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_symmetry_error" title="Link to this definition"></a></dt>
<dd><p>Get translational symmetry error between two fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.make_bath">
<span class="sig-name descname"><span class="pre">make_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.make_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.make_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.make_cluster">
<span class="sig-name descname"><span class="pre">make_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.make_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.make_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.make_bosonic_bath_target">
<span class="sig-name descname"><span class="pre">make_bosonic_bath_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.make_bosonic_bath_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.make_bosonic_bath_target" title="Link to this definition"></a></dt>
<dd><p>Get the target space for bosonic bath orbitals. This can either be the DMET cluster or the full space, and
can include a projection onto the fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.make_bosonic_cluster">
<span class="sig-name descname"><span class="pre">make_bosonic_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.make_bosonic_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.make_bosonic_cluster" title="Link to this definition"></a></dt>
<dd><p>Set bosonic component of the cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_fragment_mo_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mo_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_fragment_mo_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_fragment_mo_energy" title="Link to this definition"></a></dt>
<dd><p>Returns approximate MO energies, using the the diagonal of the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_active</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>fock</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_fragment_dmet_energy">
<span class="sig-name descname"><span class="pre">get_fragment_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_fragment_dmet_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_fragment_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Get fragment contribution to whole system DMET energy from cluster DMs.</p>
<p>After fragment summation, the nuclear-nuclear repulsion must be added to get the total energy!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster one-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm1</cite> is used. Default: None.</p></li>
<li><p><strong>dm2</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster two-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm2</cite> is used. Default: None.</p></li>
<li><p><strong>hamil</strong> (<em>ClusterHamiltonian object.</em>) – Object representing cluster hamiltonian, possibly including cached ERIs.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic fragment DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.make_counterpoise_mol">
<span class="sig-name descname"><span class="pre">make_counterpoise_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.make_counterpoise_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.make_counterpoise_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 5.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>) or Bohr (<cite>B</cite>).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.pop_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.pop_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.plot3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.plot3d" title="Link to this definition"></a></dt>
<dd><p>Write cube density data of fragment orbitals to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.check_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_local_rpa_correction">
<span class="sig-name descname"><span class="pre">get_local_rpa_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_local_rpa_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_local_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_frag_hamil">
<span class="sig-name descname"><span class="pre">get_frag_hamil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_frag_hamil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_frag_hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.fragment.Fragment.get_solver_options">
<span class="sig-name descname"><span class="pre">get_solver_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/fragment.html#Fragment.get_solver_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.fragment.Fragment.get_solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.core.qemb.qemb">
<span id="vayesta-core-qemb-qemb"></span><h2>vayesta.core.qemb.qemb<a class="headerlink" href="#module-vayesta.core.qemb.qemb" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.qemb.</span></span><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.qemb.</span></span><span class="sig-name descname"><span class="pre">Embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CCSD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for quantum embedding methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – PySCF mean-field object.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>) – Default solver for cluster problems. The available solvers depend on the embedding class.
Default: ‘CCSD’.</p></li>
<li><p><strong>log</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Vayesta logger object. Default: None</p></li>
<li><p><strong>bath_options</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>Bath specific options. The bath type is determined by the key <cite>bathtype</cite> (default: ‘DMET’).
The following bath specific options can be specified.</p>
<p>All bath types:</p>
<blockquote>
<div><dl class="simple">
<dt>dmet_threshold<span class="classifier">float, optional</span></dt><dd><p>Threshold for DMET bath orbitals. Orbitals with eigenvalues larger than <cite>dmet_threshold</cite>
or smaller than 1-<cite>dmet_threshold</cite> will be added as bath orbitals. Default: 1e-6.</p>
</dd>
</dl>
</div></blockquote>
<p>MP2 bath (<cite>bathtype = ‘MP2’</cite>):</p>
<blockquote>
<div><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Threshold for MP2 natural orbital truncation. Orbitals with eigenvalues larger than
<cite>threshold</cite> will be added as bath orbitals.</p>
</dd>
</dl>
</div></blockquote>
<p>R2 bath (<cite>bathtype = ‘R2’</cite>):</p>
<blockquote>
<div><dl class="simple">
<dt>rcut<span class="classifier">float</span></dt><dd><p>Range cutoff for R2 bath. Orbitals with eigenvalues smaller than <cite>rcut</cite> will be added
as bath orbitals.</p>
</dd>
<dt>unit<span class="classifier">{‘Ang’, ‘Bohr’}, optional</span></dt><dd><p>Unit of <cite>rcut</cite>. Default: ‘Ang’.</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>solver_options</strong> – Solver specific options. The following solver specific options can be specified.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.nao">
<span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.nao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.ncells">
<span class="sig-name descname"><span class="pre">ncells</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.ncells" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.nmo">
<span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.nmo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.nfrag">
<span class="sig-name descname"><span class="pre">nfrag</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.nfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.e_mf">
<span class="sig-name descname"><span class="pre">e_mf</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.e_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.log">
<span class="sig-name descname"><span class="pre">log</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.log" title="Link to this definition"></a></dt>
<dd><p>Logger object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.mf">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.mf" title="Link to this definition"></a></dt>
<dd><p>PySCF mean-field object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.scf.SCF</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.mo_energy">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.mo_energy" title="Link to this definition"></a></dt>
<dd><p>MO energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(nMO) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.mo_occ">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.mo_occ" title="Link to this definition"></a></dt>
<dd><p>MO occupation numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(nMO) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.mo_coeff">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>MO coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(nAO, nMO) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.fragments">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">fragments</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.fragments" title="Link to this definition"></a></dt>
<dd><p>List of fragments for embedding calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.kcell">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">kcell</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.kcell" title="Link to this definition"></a></dt>
<dd><p>For k-point sampled mean-field calculation, which have been folded to the supercell,
this will hold the original primitive unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.kpts">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">kpts</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.kpts" title="Link to this definition"></a></dt>
<dd><p>For k-point sampled mean-field calculation, which have been folded to the supercell,
this will hold the original k-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(nK, 3) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.self.kdf">
<span class="sig-prename descclassname"><span class="pre">self.</span></span><span class="sig-name descname"><span class="pre">kdf</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.self.kdf" title="Link to this definition"></a></dt>
<dd><p>For k-point sampled mean-field calculation, which have been folded to the supercell,
this will hold the original Gaussian density-fitting object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.pbc.df.GDF</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Flags">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_envelop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_secfrag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_parent_fragment_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Flags" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Flags.bath_parent_fragment_id">
<span class="sig-name descname"><span class="pre">bath_parent_fragment_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Flags.bath_parent_fragment_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Flags.is_envelop">
<span class="sig-name descname"><span class="pre">is_envelop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Flags.is_envelop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Flags.is_secfrag">
<span class="sig-name descname"><span class="pre">is_secfrag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Flags.is_secfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converged</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr_rpa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.converged" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.e_corr_rpa">
<span class="sig-name descname"><span class="pre">e_corr_rpa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.e_corr_rpa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.fid">
<span class="sig-name descname"><span class="pre">fid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.fid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.moms">
<span class="sig-name descname"><span class="pre">moms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.moms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.pwf">
<span class="sig-name descname"><span class="pre">pwf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.pwf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.Results.wf">
<span class="sig-name descname"><span class="pre">wf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.Results.wf" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.add_tsymmetric_fragments">
<span class="sig-name descname"><span class="pre">add_tsymmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.add_tsymmetric_fragments" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tvecs</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>symtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will be automatically added to base.fragments and
have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.canonicalize_mo">
<span class="sig-name descname"><span class="pre">canonicalize_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.canonicalize_mo" title="Link to this definition"></a></dt>
<dd><p>Diagonalize Fock matrix within subspace.</p>
<p>TODO: move to Embedding class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>eigenvalues</strong> (<em>ndarray</em>) – Return MO energies of canonicalized orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mo_canon</strong> (<em>ndarray</em>) – Canonicalized orbital coefficients.</p></li>
<li><p><strong>rot</strong> (<em>ndarray</em>) – Rotation matrix: np.dot(mo_coeff, rot) = mo_canon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.cluster">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.contributes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contributes</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.contributes" title="Link to this definition"></a></dt>
<dd><p>True if fragment contributes to expectation values, else False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.copy" title="Link to this definition"></a></dt>
<dd><p>Create copy of fragment, without adding it to the fragments list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.couple_to_fragment">
<span class="sig-name descname"><span class="pre">couple_to_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.couple_to_fragment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.couple_to_fragments">
<span class="sig-name descname"><span class="pre">couple_to_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.couple_to_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.diagonalize_cluster_dm">
<span class="sig-name descname"><span class="pre">diagonalize_cluster_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.diagonalize_cluster_dm" title="Link to this definition"></a></dt>
<dd><p>Diagonalize cluster (fragment+bath) DM to get fully occupied and virtual orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>array</em><em> or </em><em>list</em><em> of </em><em>arrays</em>) – Orbital coefficients. If multiple are given, they will be stacked along their second dimension.</p></li>
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Mean-field density matrix, used to separate occupied and virtual cluster orbitals.
If None, <cite>self.mf.make_rdm1()</cite> is used. Default: None.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – If set, check that all eigenvalues of the cluster DM are close
to 0 or 2, with the tolerance given by tol. Default= 1e-4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c_cluster_occ</strong> (<em>(n(AO), n(occ cluster)) array</em>) – Occupied cluster orbital coefficients.</p></li>
<li><p><strong>c_cluster_vir</strong> (<em>(n(AO), n(vir cluster)) array</em>) – Virtual cluster orbital coefficients.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_coeff_env">
<span class="sig-name descname"><span class="pre">get_coeff_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_coeff_env" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_frag_hamil">
<span class="sig-name descname"><span class="pre">get_frag_hamil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_frag_hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_dmet_energy">
<span class="sig-name descname"><span class="pre">get_fragment_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Get fragment contribution to whole system DMET energy from cluster DMs.</p>
<p>After fragment summation, the nuclear-nuclear repulsion must be added to get the total energy!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster one-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm1</cite> is used. Default: None.</p></li>
<li><p><strong>dm2</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster two-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm2</cite> is used. Default: None.</p></li>
<li><p><strong>hamil</strong> (<em>ClusterHamiltonian object.</em>) – Object representing cluster hamiltonian, possibly including cached ERIs.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic fragment DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_mf_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mf_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_mf_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the part of the mean-field energy associated with the fragment.</p>
<p>Does not include nuclear-nuclear repulsion!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_mo_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mo_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_mo_energy" title="Link to this definition"></a></dt>
<dd><p>Returns approximate MO energies, using the the diagonal of the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_active</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>fock</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_projector">
<span class="sig-name descname"><span class="pre">get_fragment_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_fragment_projector" title="Link to this definition"></a></dt>
<dd><p>Projector for one index of amplitudes local energy expression.</p>
<p>Cost: N^2 if O(1) coeffs , N^3 if O(N) coeffs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>N</em><em>)</em>) – Occupied or virtual orbital coefficients.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return 1-p instead. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – Projection matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_fragments_with_overlap">
<span class="sig-name descname"><span class="pre">get_fragments_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_fragments_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Get list of fragments which overlap both in occupied and virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_local_rpa_correction">
<span class="sig-name descname"><span class="pre">get_local_rpa_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_local_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_mo_occupation">
<span class="sig-name descname"><span class="pre">get_mo_occupation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_mo_occupation" title="Link to this definition"></a></dt>
<dd><p>Get mean-field occupation numbers (diagonal of 1-RDM) of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>N</em><em>, </em><em>M</em><em>)</em>) – Orbital coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>occup</strong> – Occupation numbers of orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_overlap">
<span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Get overlap between cluster orbitals, fragment orbitals, or MOs.</p>
<p>The return value is cached but not copied; do not modify the array in place without
creating a copy!</p>
<p>Examples:
&gt;&gt;&gt; s = self.get_overlap(‘cluster|mo’)
&gt;&gt;&gt; s = self.get_overlap(‘cluster|frag’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[occ]|cluster[occ]’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[vir]|cluster[vir]’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_solver_options">
<span class="sig-name descname"><span class="pre">get_solver_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_children">
<span class="sig-name descname"><span class="pre">get_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_children" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_error">
<span class="sig-name descname"><span class="pre">get_symmetry_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_error" title="Link to this definition"></a></dt>
<dd><p>Get translational symmetry error between two fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_generations">
<span class="sig-name descname"><span class="pre">get_symmetry_generations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_generations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_operation">
<span class="sig-name descname"><span class="pre">get_symmetry_operation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_parent">
<span class="sig-name descname"><span class="pre">get_symmetry_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_tree">
<span class="sig-name descname"><span class="pre">get_symmetry_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.get_symmetry_tree" title="Link to this definition"></a></dt>
<dd><p>Returns a recursive tree:</p>
<p>[(x, [children of x]), (y, [children of y]), …]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.hamil">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hamil</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.id_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id_name</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.id_name" title="Link to this definition"></a></dt>
<dd><p>Use this whenever a unique name is needed (for example to open a separate file for each fragment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.log_info">
<span class="sig-name descname"><span class="pre">log_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.log_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.loop_symmetry_children">
<span class="sig-name descname"><span class="pre">loop_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.loop_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Loop over all symmetry related fragments, including children of children, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em><em> or </em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>optional</em>) – If arrays are passed, the symmetry operation of each symmetry related fragment will be
applied to this array along the axis given in <cite>axes</cite>.</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of axes, along which the symmetry operation is applied for each element of <cite>arrays</cite>.
If None, the first axis will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.make_bath">
<span class="sig-name descname"><span class="pre">make_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.make_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.make_bosonic_bath_target">
<span class="sig-name descname"><span class="pre">make_bosonic_bath_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.make_bosonic_bath_target" title="Link to this definition"></a></dt>
<dd><p>Get the target space for bosonic bath orbitals. This can either be the DMET cluster or the full space, and
can include a projection onto the fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.make_bosonic_cluster">
<span class="sig-name descname"><span class="pre">make_bosonic_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.make_bosonic_cluster" title="Link to this definition"></a></dt>
<dd><p>Set bosonic component of the cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.make_cluster">
<span class="sig-name descname"><span class="pre">make_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.make_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.make_counterpoise_mol">
<span class="sig-name descname"><span class="pre">make_counterpoise_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.make_counterpoise_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 5.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>) or Bohr (<cite>B</cite>).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.n_frag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frag</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.n_frag" title="Link to this definition"></a></dt>
<dd><p>Number of fragment orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.n_symmetry_children">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_symmetry_children</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.n_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.nelectron">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelectron</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.nelectron" title="Link to this definition"></a></dt>
<dd><p>Number of mean-field electrons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.plot3d" title="Link to this definition"></a></dt>
<dd><p>Write cube density data of fragment orbitals to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.pop_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.project_ref_orbitals">
<span class="sig-name descname"><span class="pre">project_ref_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.project_ref_orbitals" title="Link to this definition"></a></dt>
<dd><p>Project reference orbitals into available space in new geometry.</p>
<p>The projected orbitals will be ordered according to their eigenvalues within the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>ndarray</em>) – Orbital coefficients.</p></li>
<li><p><strong>c_ref</strong> (<em>ndarray</em>) – Orbital coefficients of reference orbitals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.symmetry_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symmetry_factor</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.symmetry_factor" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Fragment.trimmed_name">
<span class="sig-name descname"><span class="pre">trimmed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Fragment.trimmed_name" title="Link to this definition"></a></dt>
<dd><p>Fragment name trimmed to a given maximum length.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.is_rhf">
<span class="sig-name descname"><span class="pre">is_rhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.is_rhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.is_uhf">
<span class="sig-name descname"><span class="pre">is_uhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.is_uhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.spinsym">
<span class="sig-name descname"><span class="pre">spinsym</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'restricted'</span></em><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.spinsym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.init_mf">
<span class="sig-name descname"><span class="pre">init_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.init_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.init_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.change_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Mole or Cell object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_exxdiv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_exxdiv</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Correction for divergent exact-exchange potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_exxdiv">
<span class="sig-name descname"><span class="pre">get_exxdiv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_exxdiv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Get divergent exact-exchange (exxdiv) energy correction and potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>e_exxdiv</strong> (<em>float</em>) – Divergent exact-exchange energy correction per unit cell.</p></li>
<li><p><strong>v_exxdiv</strong> (<em>array</em>) – Divergent exact-exchange potential correction in AO basis.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.pbc_dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pbc_dimension</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.pbc_dimension" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Number of atomic orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncells</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Number of primitive cells within supercell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_df</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_energy" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_occ" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital occupations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Total number of molecular orbitals (MOs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.nocc" title="Link to this definition"></a></dt>
<dd><p>Number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.nvir" title="Link to this definition"></a></dt>
<dd><p>Number of virtual MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_energy_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_energy_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id4">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_mf</span></span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Total mean-field energy per unit cell (not folded supercell).
Note that the input unit cell itself can be a supercell, in which case
<cite>e_mf</cite> refers to this cell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.e_nuc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nuc</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.e_nuc" title="Link to this definition"></a></dt>
<dd><p>Nuclear-repulsion energy per unit cell (not folded supercell).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.e_nonlocal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nonlocal</span></span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.e_nonlocal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nfrag</span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Number of fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.loop">
<span class="sig-name descname"><span class="pre">loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.loop" title="Link to this definition"></a></dt>
<dd><p>Loop over fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_ovlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_ovlp" title="Link to this definition"></a></dt>
<dd><p>AO-overlap matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_hcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_hcore" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian (kinetic energy plus nuclear-electron attraction).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock Coulomb and exchange potential in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_fock" title="Link to this definition"></a></dt>
<dd><p>Fock matrix in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.set_ovlp">
<span class="sig-name descname"><span class="pre">set_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.set_ovlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.set_ovlp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.set_hcore">
<span class="sig-name descname"><span class="pre">set_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.set_hcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.set_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.set_veff">
<span class="sig-name descname"><span class="pre">set_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.set_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.set_veff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_hcore_for_energy">
<span class="sig-name descname"><span class="pre">get_hcore_for_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_hcore_for_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_hcore_for_energy" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_veff_for_energy">
<span class="sig-name descname"><span class="pre">get_veff_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_veff_for_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_veff_for_energy" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_fock_for_energy">
<span class="sig-name descname"><span class="pre">get_fock_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_fock_for_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_fock_for_energy" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_fock_for_bath">
<span class="sig-name descname"><span class="pre">get_fock_for_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_fock_for_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_fock_for_bath" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for bath orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_ovlp_power">
<span class="sig-name descname"><span class="pre">get_ovlp_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_ovlp_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_ovlp_power" title="Link to this definition"></a></dt>
<dd><p>get power of AO overlap matrix.</p>
<p>For folded calculations, this uses the k-point sampled overlap, for better performance and accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>power</strong> (<em>float</em>) – Matrix power.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spow</strong> – Matrix power of AO overlap matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(AO), n(AO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_cderi_exspace">
<span class="sig-name descname"><span class="pre">get_cderi_exspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_cderi_exspace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_eris_array">
<span class="sig-name descname"><span class="pre">get_eris_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_eris_array" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>[</em><em>list</em><em>(</em><em>4</em><em>) </em><em>of</em><em>] </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(MO), n(MO), n(MO), n(MO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_eris_object">
<span class="sig-name descname"><span class="pre">get_eris_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">postscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_eris_object" title="Link to this definition"></a></dt>
<dd><p>Get ERIs for post-SCF methods.</p>
<p>For folded PBC calculations, this folds the MO back into k-space
and contracts with the k-space three-center integrals..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>postscf</strong> (<em>one</em><em> of </em><em>the following PySCF methods: MP2</em><em>, </em><em>CCSD</em><em>, </em><em>RCCSD</em><em>, </em><em>DFCCSD</em>) – Post-SCF method with attribute mo_coeff set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – ERIs which can be used for the respective post-scf method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_ChemistsERIs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.build_screened_interactions">
<span class="sig-name descname"><span class="pre">build_screened_interactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.build_screened_interactions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.build_screened_interactions" title="Link to this definition"></a></dt>
<dd><p>Build screened interactions, be they dynamic or static.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.build_bosonic_bath">
<span class="sig-name descname"><span class="pre">build_bosonic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.build_bosonic_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.build_bosonic_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.build_screened_eris">
<span class="sig-name descname"><span class="pre">build_screened_eris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.build_screened_eris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.build_screened_eris" title="Link to this definition"></a></dt>
<dd><p>Generates renormalised coulomb interactions for use in local cluster calculations.
Currently requires unrestricted system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<a class="reference internal" href="#vayesta.core.qemb.qemb.Embedding" title="vayesta.core.qemb.qemb.Embedding"><em>Embedding</em></a>) – Embedding instance.</p></li>
<li><p><strong>fragments</strong> (<em>list</em><em> of </em><em>vayesta.qemb.Fragment subclasses</em><em>, </em><em>optional</em>) – List of fragments for the calculation, used to define local interaction spaces.
If None, <cite>emb.get_fragments(sym_parent=None)</cite> is used. Default: None.</p></li>
<li><p><strong>cderi_ov</strong> (<em>np.array</em><em> or </em><em>tuple</em><em> of </em><em>np.array</em><em>, </em><em>optional.</em>) – Cholesky-decomposed ERIs in the particle-hole basis of mf. If mf is unrestricted
this should be a list of arrays corresponding to the different spin channels.</p></li>
<li><p><strong>store_m0</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to store the local zeroth moment in the fragment class for use later.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points for numerical integration. Default: 48.</p></li>
<li><p><strong>log</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger object. If None, the logger of the <cite>emb</cite> object is used. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>seris_ov</strong> (<em>list of tuples of np.array</em>) – List of spin-dependent screened (ov|ov), for each fragment provided.</p></li>
<li><p><strong>erpa</strong> (<em>float</em>) – Delta RPA correction computed as difference between full system RPA energy and
cluster correlation energies; currently only functional in CAS fragmentations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.create_symmetric_fragments">
<span class="sig-name descname"><span class="pre">create_symmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.create_symmetric_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.create_symmetric_fragments" title="Link to this definition"></a></dt>
<dd><p>Add rotationally or translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: self.opts.symmetry_mf_tol.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.create_invsym_fragments">
<span class="sig-name descname"><span class="pre">create_invsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.create_invsym_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.create_invsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create inversion symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of inversion-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.create_mirrorsym_fragments">
<span class="sig-name descname"><span class="pre">create_mirrorsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.create_mirrorsym_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.create_mirrorsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create mirror symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of mirror-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.create_rotsym_fragments">
<span class="sig-name descname"><span class="pre">create_rotsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.create_rotsym_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.create_rotsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create rotationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of rotationally-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.create_transsym_fragments">
<span class="sig-name descname"><span class="pre">create_transsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.create_transsym_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.create_transsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>translation</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_symmetry_parent_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_parent_fragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_symmetry_parent_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_symmetry_parent_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are parents to symmetry related child fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parents</strong> – A list of all parent fragments, ordered in the same way as they appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_symmetry_child_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_child_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_symmetry_child_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_symmetry_child_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are children to symmetry related parent fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_parents</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, the parent fragment of each symmetry group is prepended to each symmetry sublist.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>children</strong> – A list with the length of the number of parent fragments in the system, each element
being another list containing all the children fragments of the given parent fragment.
Both the outer and inner lists are ordered in the same way that the fragments appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_fragments">
<span class="sig-name descname"><span class="pre">get_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_fragments" title="Link to this definition"></a></dt>
<dd><p>Return all fragments which obey the specified conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**filters</strong> – List of returned fragments will be filtered according to specified
keyword arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of fragments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Only returns fragments with mpi_rank 0, 1, or 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">mpi_rank</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Only returns fragments with no symmetry parent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">sym_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_fragment_overlap_norm">
<span class="sig-name descname"><span class="pre">get_fragment_overlap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupied</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_fragment_overlap_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_fragment_overlap_norm" title="Link to this definition"></a></dt>
<dd><p>Get matrix of overlap norms between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.communicate_clusters">
<span class="sig-name descname"><span class="pre">communicate_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.communicate_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.communicate_clusters" title="Link to this definition"></a></dt>
<dd><p>Communicate cluster orbitals between MPI ranks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.make_rdm1_demo">
<span class="sig-name descname"><span class="pre">make_rdm1_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.make_rdm1_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.make_rdm1_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – One-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.make_rdm2_demo">
<span class="sig-name descname"><span class="pre">make_rdm2_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.make_rdm2_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.make_rdm2_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_dmet_elec_energy">
<span class="sig-name descname"><span class="pre">get_dmet_elec_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_dmet_elec_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_dmet_elec_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_dmet_energy">
<span class="sig-name descname"><span class="pre">get_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_nuc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_dmet_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>with_nuc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include nuclear-repulsion energy. Default: True.</p></li>
<li><p><strong>with_exxdiv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include divergent exact-exchange correction. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_corrfunc_mf">
<span class="sig-name descname"><span class="pre">get_corrfunc_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_corrfunc_mf" title="Link to this definition"></a></dt>
<dd><p>dm1 in MO basis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_corrfunc">
<span class="sig-name descname"><span class="pre">get_corrfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2_with_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_corrfunc" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_mean_cluster_size">
<span class="sig-name descname"><span class="pre">get_mean_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_mean_cluster_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_mean_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_average_cluster_size">
<span class="sig-name descname"><span class="pre">get_average_cluster_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_average_cluster_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_average_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_min_cluster_size">
<span class="sig-name descname"><span class="pre">get_min_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_min_cluster_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_min_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_max_cluster_size">
<span class="sig-name descname"><span class="pre">get_max_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_max_cluster_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_max_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_lo_coeff">
<span class="sig-name descname"><span class="pre">get_lo_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_lo_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_lo_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.pop_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.pop_analysis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>(</em><em>N</em><em>, </em><em>N</em><em>) </em><em>array</em>) – If <cite>mo_coeff</cite> is None, AO representation is assumed.</p></li>
<li><p><strong>local_orbitals</strong> (<em>{'lowdin'</em><em>, </em><em>'mulliken'</em><em>, </em><em>'iao+pao'}</em><em> or </em><em>array</em>) – Kind of population analysis. Default: ‘lowdin’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pop</strong> – Population of atomic orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ol class="upperalpha simple" start="14">
<li><p>array</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.get_atomic_charges">
<span class="sig-name descname"><span class="pre">get_atomic_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.get_atomic_charges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.get_atomic_charges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.write_population">
<span class="sig-name descname"><span class="pre">write_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.write_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.write_population" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.sao_fragmentation">
<span class="sig-name descname"><span class="pre">sao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.sao_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.sao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of SAO (Lowdin-AO) fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.site_fragmentation">
<span class="sig-name descname"><span class="pre">site_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.site_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.site_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.iao_fragmentation">
<span class="sig-name descname"><span class="pre">iao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.iao_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.iao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.iaopao_fragmentation">
<span class="sig-name descname"><span class="pre">iaopao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.iaopao_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.iaopao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO+PAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.cas_fragmentation">
<span class="sig-name descname"><span class="pre">cas_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.cas_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.cas_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_orthonormal_fragmentation">
<span class="sig-name descname"><span class="pre">has_orthonormal_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.has_orthonormal_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_orthonormal_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_complete_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.has_complete_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_complete_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_complete_occupied_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_occupied_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.has_complete_occupied_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_complete_occupied_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the occupied space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.has_complete_virtual_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_virtual_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.has_complete_virtual_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.has_complete_virtual_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.require_complete_fragmentation">
<span class="sig-name descname"><span class="pre">require_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.require_complete_fragmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.require_complete_fragmentation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.update_mf">
<span class="sig-name descname"><span class="pre">update_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.update_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.update_mf" title="Link to this definition"></a></dt>
<dd><p>Update underlying mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.check_fragment_symmetry">
<span class="sig-name descname"><span class="pre">check_fragment_symmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.check_fragment_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.check_fragment_symmetry" title="Link to this definition"></a></dt>
<dd><p>Check that the mean-field obeys the symmetry between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.optimize_chempot">
<span class="sig-name descname"><span class="pre">optimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpt_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.optimize_chempot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.optimize_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.pdmet_scmf">
<span class="sig-name descname"><span class="pre">pdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.pdmet_scmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.pdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for p-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.brueckner_scmf">
<span class="sig-name descname"><span class="pre">brueckner_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.brueckner_scmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.brueckner_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for Brueckner-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.qpewdmet_scmf">
<span class="sig-name descname"><span class="pre">qpewdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.qpewdmet_scmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.qpewdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for QP-EWDMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.qemb.Embedding.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/qemb.html#Embedding.check_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.qemb.Embedding.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.core.qemb.register">
<span id="vayesta-core-qemb-register"></span><h2>vayesta.core.qemb.register<a class="headerlink" href="#module-vayesta.core.qemb.register" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.register.FragmentRegister">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.register.</span></span><span class="sig-name descname"><span class="pre">FragmentRegister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpi_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/register.html#FragmentRegister"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.register.FragmentRegister" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.register.FragmentRegister.get_next_id">
<span class="sig-name descname"><span class="pre">get_next_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/register.html#FragmentRegister.get_next_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.register.FragmentRegister.get_next_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.register.FragmentRegister.get_next_mpi_rank">
<span class="sig-name descname"><span class="pre">get_next_mpi_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/register.html#FragmentRegister.get_next_mpi_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.register.FragmentRegister.get_next_mpi_rank" title="Link to this definition"></a></dt>
<dd><p>TODO: get next MPI rank based on runtime and memory estimates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.register.FragmentRegister.get_next">
<span class="sig-name descname"><span class="pre">get_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/register.html#FragmentRegister.get_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.register.FragmentRegister.get_next" title="Link to this definition"></a></dt>
<dd><p>Get next free fragment ID and MPI rank.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.core.qemb.self_energy">
<span id="vayesta-core-qemb-self-energy"></span><h2>vayesta.core.qemb.self_energy<a class="headerlink" href="#module-vayesta.core.qemb.self_energy" title="Link to this heading"></a></h2>
<p>Routines to reconstruct the full system self-energy from cluster spectral moments</p>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.make_self_energy_moments">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">make_self_energy_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_se_mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#make_self_energy_moments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.make_self_energy_moments" title="Link to this definition"></a></dt>
<dd><p>Construct full system self-energy moments from cluster spectral moments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<em>EWF object</em>) – Embedding object</p></li>
<li><p><strong>n_se_mom</strong> (<em>int</em>) – Number of self-energy moments</p></li>
<li><p><strong>use_sym</strong> (<em>bool</em>) – Use symmetry to reconstruct self-energy</p></li>
<li><p><strong>proj</strong> (<em>int</em>) – Number of projectors to use (1 or 2)</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – Broadening factor for static potential</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self_energy_moms</strong> (<em>ndarry (n_se_mom, nmo, nmo)</em>) – Full system self-energy moments (MO basis)</p></li>
<li><p><strong>static_self_energy</strong> (<em>ndarray (nmo,nmo)</em>) – Static part of self-energy (MO basis)</p></li>
<li><p><strong>static_potential</strong> (<em>ndarray (nao,nao)</em>) – Static potential (AO basis)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.make_self_energy_1proj">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">make_self_energy_1proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_svd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux_shift_frag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_degen_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_eval_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_non_causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#make_self_energy_1proj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.make_self_energy_1proj" title="Link to this definition"></a></dt>
<dd><p>Construct full system self-energy in Lehmann representation from cluster spectral moments using 1 projector</p>
<p>TODO: MPI, SVD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<em>EWF object</em>) – Embedding object</p></li>
<li><p><strong>use_sym</strong> (<em>bool</em>) – Use symmetry to reconstruct self-energy</p></li>
<li><p><strong>use_svd</strong> (<em>bool</em>) – Use SVD to decompose the self-energy as outer product</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – Broadening factor for static potential</p></li>
<li><p><strong>se_degen_tol</strong> (<em>float</em>) – Tolerance for degeneracy in Lehmann representation</p></li>
<li><p><strong>se_eval_tol</strong> (<em>float</em>) – Tolerance for self-energy eigenvalues assumed to be kept</p></li>
<li><p><strong>drop_non_causal</strong> (<em>bool</em>) – Drop non-causal poles (negative eigenvalues) of self-energy</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self_energy</strong> (<em>Lehmann object</em>) – Reconstructed self-energy in Lehmann representation (MO basis)</p></li>
<li><p><strong>static_self_energy</strong> (<em>ndarray (nmo,nmo)</em>) – Static part of self-energy (MO basis)</p></li>
<li><p><strong>static_potential</strong> (<em>ndarray (nao,nao)</em>) – Static potential (AO basis)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.make_self_energy_2proj">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">make_self_energy_2proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#make_self_energy_2proj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.make_self_energy_2proj" title="Link to this definition"></a></dt>
<dd><p>Construct full system self-energy in Lehmann representation from cluster spectral moments using 2 projectors</p>
<p>TODO: MPI, SVD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<em>EWF object</em>) – Embedding object</p></li>
<li><p><strong>use_sym</strong> (<em>bool</em>) – Use symmetry to reconstruct self-energy</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – Broadening factor for static potential</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self_energy</strong> (<em>Lehmann object</em>) – Reconstructed self-energy in Lehmann representation (MO basis)</p></li>
<li><p><strong>static_self_energy</strong> (<em>ndarray (nmo,nmo)</em>) – Static part of self-energy (MO basis)</p></li>
<li><p><strong>static_potential</strong> (<em>ndarray (nao,nao)</em>) – Static potential (AO basis)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.remove_se_degeneracy">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">remove_se_degeneracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_non_causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#remove_se_degeneracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.remove_se_degeneracy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.get_unique">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">get_unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#get_unique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.get_unique" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.core.qemb.self_energy.fit_hermitian">
<span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.self_energy.</span></span><span class="sig-name descname"><span class="pre">fit_hermitian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/self_energy.html#fit_hermitian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.self_energy.fit_hermitian" title="Link to this definition"></a></dt>
<dd><p>Fit a causal self-energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>se</strong> (<em>Lehmann</em>) – Self-energy in Lehmann representation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>se</strong> – Fitted causal self-energy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Lehmann</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vayesta.core.qemb.ufragment">
<span id="vayesta-core-qemb-ufragment"></span><h2>vayesta.core.qemb.ufragment<a class="headerlink" href="#module-vayesta.core.qemb.ufragment" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.ufragment.</span></span><span class="sig-name descname"><span class="pre">UFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.core.qemb.fragment.Fragment" title="vayesta.core.qemb.fragment.Fragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fragment</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.log_info">
<span class="sig-name descname"><span class="pre">log_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.log_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.log_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.n_frag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frag</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.n_frag" title="Link to this definition"></a></dt>
<dd><p>Number of fragment orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.nelectron">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelectron</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.nelectron" title="Link to this definition"></a></dt>
<dd><p>Number of mean-field electrons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_mo_occupation">
<span class="sig-name descname"><span class="pre">get_mo_occupation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_mo_occupation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_mo_occupation" title="Link to this definition"></a></dt>
<dd><p>Get mean-field occupation numbers (diagonal of 1-RDM) of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>N</em><em>, </em><em>M</em><em>)</em>) – Orbital coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>occ</strong> – Occupation numbers of orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.canonicalize_mo">
<span class="sig-name descname"><span class="pre">canonicalize_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.canonicalize_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.canonicalize_mo" title="Link to this definition"></a></dt>
<dd><p>Diagonalize Fock matrix within subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>eigenvalues</strong> (<em>ndarray</em>) – Return MO energies of canonicalized orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mo_canon</strong> (<em>ndarray</em>) – Canonicalized orbital coefficients.</p></li>
<li><p><strong>rot</strong> (<em>ndarray</em>) – Rotation matrix: np.dot(mo_coeff, rot) = mo_canon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.diagonalize_cluster_dm">
<span class="sig-name descname"><span class="pre">diagonalize_cluster_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.diagonalize_cluster_dm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.diagonalize_cluster_dm" title="Link to this definition"></a></dt>
<dd><p>Diagonalize cluster (fragment+bath) DM to get fully occupied and virtual orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – If set, check that all eigenvalues of the cluster DM are close
to 0 or 1, with the tolerance given by tol. Default= 1e-4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c_cluster_occ</strong> (<em>ndarray</em>) – Occupied cluster orbitals.</p></li>
<li><p><strong>c_cluster_vir</strong> (<em>ndarray</em>) – Virtual cluster orbitals.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_fragment_projector">
<span class="sig-name descname"><span class="pre">get_fragment_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_fragment_projector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_fragment_projector" title="Link to this definition"></a></dt>
<dd><p>Projector for one index of amplitudes local energy expression.</p>
<p>Cost: N^2 if O(1) coeffs , N^3 if O(N) coeffs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>N</em><em>)</em>) – Occupied or virtual orbital coefficients.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return 1-p instead. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – Projection matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_fragment_mf_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mf_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_fragment_mf_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_fragment_mf_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the part of the mean-field energy associated with the fragment.</p>
<p>Does not include nuclear-nuclear repulsion!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_fragment_mo_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mo_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_fragment_mo_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_fragment_mo_energy" title="Link to this definition"></a></dt>
<dd><p>Returns approximate MO energies, using the the diagonal of the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_active</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>fock</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_fragment_dmet_energy">
<span class="sig-name descname"><span class="pre">get_fragment_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_fragment_dmet_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_fragment_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Get fragment contribution to whole system DMET energy from cluster DMs.</p>
<p>After fragment summation, the nuclear-nuclear repulsion must be added to get the total energy!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster one-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm1</cite> is used. Default: None.</p></li>
<li><p><strong>dm2</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster two-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm2</cite> is used. Default: None.</p></li>
<li><p><strong>hamil</strong> (<em>ClusterHamiltonian object.</em>) – Object representing cluster hamiltonian, possibly including cached ERIs.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic fragment DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_error">
<span class="sig-name descname"><span class="pre">get_symmetry_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/ufragment.html#UFragment.get_symmetry_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_error" title="Link to this definition"></a></dt>
<dd><p>Get translational symmetry error between two fragments.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Flags">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_envelop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_secfrag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_parent_fragment_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Flags" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Flags.bath_parent_fragment_id">
<span class="sig-name descname"><span class="pre">bath_parent_fragment_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Flags.bath_parent_fragment_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Flags.is_envelop">
<span class="sig-name descname"><span class="pre">is_envelop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Flags.is_envelop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Flags.is_secfrag">
<span class="sig-name descname"><span class="pre">is_secfrag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Flags.is_secfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converged</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr_rpa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.converged" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.e_corr_rpa">
<span class="sig-name descname"><span class="pre">e_corr_rpa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.e_corr_rpa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.fid">
<span class="sig-name descname"><span class="pre">fid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.fid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.moms">
<span class="sig-name descname"><span class="pre">moms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.moms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.pwf">
<span class="sig-name descname"><span class="pre">pwf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.pwf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.Results.wf">
<span class="sig-name descname"><span class="pre">wf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.Results.wf" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.add_tsymmetric_fragments">
<span class="sig-name descname"><span class="pre">add_tsymmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.add_tsymmetric_fragments" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tvecs</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>symtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will be automatically added to base.fragments and
have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.cluster">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.contributes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contributes</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.contributes" title="Link to this definition"></a></dt>
<dd><p>True if fragment contributes to expectation values, else False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.copy" title="Link to this definition"></a></dt>
<dd><p>Create copy of fragment, without adding it to the fragments list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.couple_to_fragment">
<span class="sig-name descname"><span class="pre">couple_to_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.couple_to_fragment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.couple_to_fragments">
<span class="sig-name descname"><span class="pre">couple_to_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.couple_to_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_coeff_env">
<span class="sig-name descname"><span class="pre">get_coeff_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_coeff_env" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_frag_hamil">
<span class="sig-name descname"><span class="pre">get_frag_hamil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_frag_hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_fragments_with_overlap">
<span class="sig-name descname"><span class="pre">get_fragments_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_fragments_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Get list of fragments which overlap both in occupied and virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_local_rpa_correction">
<span class="sig-name descname"><span class="pre">get_local_rpa_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_local_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_overlap">
<span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Get overlap between cluster orbitals, fragment orbitals, or MOs.</p>
<p>The return value is cached but not copied; do not modify the array in place without
creating a copy!</p>
<p>Examples:
&gt;&gt;&gt; s = self.get_overlap(‘cluster|mo’)
&gt;&gt;&gt; s = self.get_overlap(‘cluster|frag’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[occ]|cluster[occ]’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[vir]|cluster[vir]’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_solver_options">
<span class="sig-name descname"><span class="pre">get_solver_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_children">
<span class="sig-name descname"><span class="pre">get_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_children" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_generations">
<span class="sig-name descname"><span class="pre">get_symmetry_generations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_generations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_operation">
<span class="sig-name descname"><span class="pre">get_symmetry_operation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_parent">
<span class="sig-name descname"><span class="pre">get_symmetry_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.get_symmetry_tree">
<span class="sig-name descname"><span class="pre">get_symmetry_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.get_symmetry_tree" title="Link to this definition"></a></dt>
<dd><p>Returns a recursive tree:</p>
<p>[(x, [children of x]), (y, [children of y]), …]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.hamil">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hamil</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.id_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id_name</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.id_name" title="Link to this definition"></a></dt>
<dd><p>Use this whenever a unique name is needed (for example to open a separate file for each fragment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.loop_symmetry_children">
<span class="sig-name descname"><span class="pre">loop_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.loop_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Loop over all symmetry related fragments, including children of children, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em><em> or </em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>optional</em>) – If arrays are passed, the symmetry operation of each symmetry related fragment will be
applied to this array along the axis given in <cite>axes</cite>.</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of axes, along which the symmetry operation is applied for each element of <cite>arrays</cite>.
If None, the first axis will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.make_bath">
<span class="sig-name descname"><span class="pre">make_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.make_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.make_bosonic_bath_target">
<span class="sig-name descname"><span class="pre">make_bosonic_bath_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.make_bosonic_bath_target" title="Link to this definition"></a></dt>
<dd><p>Get the target space for bosonic bath orbitals. This can either be the DMET cluster or the full space, and
can include a projection onto the fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.make_bosonic_cluster">
<span class="sig-name descname"><span class="pre">make_bosonic_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.make_bosonic_cluster" title="Link to this definition"></a></dt>
<dd><p>Set bosonic component of the cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.make_cluster">
<span class="sig-name descname"><span class="pre">make_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.make_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.make_counterpoise_mol">
<span class="sig-name descname"><span class="pre">make_counterpoise_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.make_counterpoise_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 5.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>) or Bohr (<cite>B</cite>).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.n_symmetry_children">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_symmetry_children</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.n_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.plot3d" title="Link to this definition"></a></dt>
<dd><p>Write cube density data of fragment orbitals to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.pop_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.project_ref_orbitals">
<span class="sig-name descname"><span class="pre">project_ref_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.project_ref_orbitals" title="Link to this definition"></a></dt>
<dd><p>Project reference orbitals into available space in new geometry.</p>
<p>The projected orbitals will be ordered according to their eigenvalues within the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>ndarray</em>) – Orbital coefficients.</p></li>
<li><p><strong>c_ref</strong> (<em>ndarray</em>) – Orbital coefficients of reference orbitals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.symmetry_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symmetry_factor</span></span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.symmetry_factor" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.ufragment.UFragment.trimmed_name">
<span class="sig-name descname"><span class="pre">trimmed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.ufragment.UFragment.trimmed_name" title="Link to this definition"></a></dt>
<dd><p>Fragment name trimmed to a given maximum length.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.core.qemb.uqemb">
<span id="vayesta-core-qemb-uqemb"></span><h2>vayesta.core.qemb.uqemb<a class="headerlink" href="#module-vayesta.core.qemb.uqemb" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.core.qemb.uqemb.</span></span><span class="sig-name descname"><span class="pre">UEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CCSD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.core.qemb.qemb.Embedding" title="vayesta.core.qemb.qemb.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Spin unrestricted quantum embedding.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Fragment">
<span class="sig-name descname"><span class="pre">Fragment</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Fragment" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#vayesta.core.qemb.ufragment.UFragment" title="vayesta.core.qemb.ufragment.UFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">UFragment</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.is_rhf">
<span class="sig-name descname"><span class="pre">is_rhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.is_rhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.is_uhf">
<span class="sig-name descname"><span class="pre">is_uhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.is_uhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.spinsym">
<span class="sig-name descname"><span class="pre">spinsym</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'unrestricted'</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.spinsym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.nmo" title="Link to this definition"></a></dt>
<dd><p>Total number of molecular orbitals (MOs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.nocc" title="Link to this definition"></a></dt>
<dd><p>Number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.nvir" title="Link to this definition"></a></dt>
<dd><p>Number of virtual MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_exxdiv">
<span class="sig-name descname"><span class="pre">get_exxdiv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.get_exxdiv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Get divergent exact-exchange (exxdiv) energy correction and potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>e_exxdiv</strong> (<em>float</em>) – Divergent exact-exchange energy correction per unit cell.</p></li>
<li><p><strong>v_exxdiv</strong> (<em>array</em>) – Divergent exact-exchange potential correction in AO basis.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_eris_array_uhf">
<span class="sig-name descname"><span class="pre">get_eris_array_uhf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.get_eris_array_uhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_eris_array_uhf" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>tuple</em><em>(</em><em>2</em><em>) of </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>eris</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_eris_object">
<span class="sig-name descname"><span class="pre">get_eris_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">postscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.get_eris_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_eris_object" title="Link to this definition"></a></dt>
<dd><p>Get ERIs for post-SCF methods.</p>
<p>For folded PBC calculations, this folds the MO back into k-space
and contracts with the k-space three-center integrals..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>postscf</strong> (<em>one</em><em> of </em><em>the following post-SCF methods: MP2</em><em>, </em><em>CCSD</em><em>, </em><em>RCCSD</em><em>, </em><em>DFCCSD</em>) – Post-SCF method with attribute mo_coeff set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – ERIs which can be used for the respective post-SCF method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_ChemistsERIs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.build_screened_eris">
<span class="sig-name descname"><span class="pre">build_screened_eris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.build_screened_eris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.build_screened_eris" title="Link to this definition"></a></dt>
<dd><p>Generates renormalised coulomb interactions for use in local cluster calculations.
Currently requires unrestricted system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<a class="reference internal" href="#vayesta.core.qemb.qemb.Embedding" title="vayesta.core.qemb.qemb.Embedding"><em>Embedding</em></a>) – Embedding instance.</p></li>
<li><p><strong>fragments</strong> (<em>list</em><em> of </em><em>vayesta.qemb.Fragment subclasses</em><em>, </em><em>optional</em>) – List of fragments for the calculation, used to define local interaction spaces.
If None, <cite>emb.get_fragments(sym_parent=None)</cite> is used. Default: None.</p></li>
<li><p><strong>cderi_ov</strong> (<em>np.array</em><em> or </em><em>tuple</em><em> of </em><em>np.array</em><em>, </em><em>optional.</em>) – Cholesky-decomposed ERIs in the particle-hole basis of mf. If mf is unrestricted
this should be a list of arrays corresponding to the different spin channels.</p></li>
<li><p><strong>store_m0</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to store the local zeroth moment in the fragment class for use later.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points for numerical integration. Default: 48.</p></li>
<li><p><strong>log</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger object. If None, the logger of the <cite>emb</cite> object is used. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>seris_ov</strong> (<em>list of tuples of np.array</em>) – List of spin-dependent screened (ov|ov), for each fragment provided.</p></li>
<li><p><strong>erpa</strong> (<em>float</em>) – Delta RPA correction computed as difference between full system RPA energy and
cluster correlation energies; currently only functional in CAS fragmentations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.update_mf">
<span class="sig-name descname"><span class="pre">update_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.update_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.update_mf" title="Link to this definition"></a></dt>
<dd><p>Update underlying mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.check_fragment_symmetry">
<span class="sig-name descname"><span class="pre">check_fragment_symmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.check_fragment_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.check_fragment_symmetry" title="Link to this definition"></a></dt>
<dd><p>Check that the mean-field obeys the symmetry between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.make_rdm1_demo">
<span class="sig-name descname"><span class="pre">make_rdm1_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.make_rdm1_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.make_rdm1_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – Alpha- and beta one-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (n, n) arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.make_rdm2_demo">
<span class="sig-name descname"><span class="pre">make_rdm2_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.make_rdm2_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.make_rdm2_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.pop_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.pop_analysis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>(</em><em>N</em><em>, </em><em>N</em><em>) </em><em>array</em>) – If <cite>mo_coeff</cite> is None, AO representation is assumed.</p></li>
<li><p><strong>local_orbitals</strong> (<em>{'lowdin'</em><em>, </em><em>'mulliken'</em><em>, </em><em>'iao+pao'}</em><em> or </em><em>array</em>) – Kind of population analysis. Default: ‘lowdin’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pop</strong> – Population of atomic orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ol class="upperalpha simple" start="14">
<li><p>array</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_atomic_charges">
<span class="sig-name descname"><span class="pre">get_atomic_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/core/qemb/uqemb.html#UEmbedding.get_atomic_charges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_atomic_charges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_corrfunc">
<span class="sig-name descname"><span class="pre">get_corrfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2_with_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_corrfunc" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.html#vayesta.core.util.OptionsBase" title="vayesta.core.util.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.brueckner_scmf">
<span class="sig-name descname"><span class="pre">brueckner_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.brueckner_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for Brueckner-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.build_bosonic_bath">
<span class="sig-name descname"><span class="pre">build_bosonic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.build_bosonic_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.build_screened_interactions">
<span class="sig-name descname"><span class="pre">build_screened_interactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.build_screened_interactions" title="Link to this definition"></a></dt>
<dd><p>Build screened interactions, be they dynamic or static.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.cas_fragmentation">
<span class="sig-name descname"><span class="pre">cas_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.cas_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.communicate_clusters">
<span class="sig-name descname"><span class="pre">communicate_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.communicate_clusters" title="Link to this definition"></a></dt>
<dd><p>Communicate cluster orbitals between MPI ranks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.create_invsym_fragments">
<span class="sig-name descname"><span class="pre">create_invsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.create_invsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create inversion symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of inversion-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.create_mirrorsym_fragments">
<span class="sig-name descname"><span class="pre">create_mirrorsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.create_mirrorsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create mirror symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of mirror-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.create_rotsym_fragments">
<span class="sig-name descname"><span class="pre">create_rotsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.create_rotsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create rotationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of rotationally-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.create_symmetric_fragments">
<span class="sig-name descname"><span class="pre">create_symmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.create_symmetric_fragments" title="Link to this definition"></a></dt>
<dd><p>Add rotationally or translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: self.opts.symmetry_mf_tol.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.create_transsym_fragments">
<span class="sig-name descname"><span class="pre">create_transsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.create_transsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>translation</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.e_mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_mf</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.e_mf" title="Link to this definition"></a></dt>
<dd><p>Total mean-field energy per unit cell (not folded supercell).
Note that the input unit cell itself can be a supercell, in which case
<cite>e_mf</cite> refers to this cell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.e_nonlocal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nonlocal</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.e_nonlocal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.e_nuc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nuc</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.e_nuc" title="Link to this definition"></a></dt>
<dd><p>Nuclear-repulsion energy per unit cell (not folded supercell).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_average_cluster_size">
<span class="sig-name descname"><span class="pre">get_average_cluster_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_average_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_cderi_exspace">
<span class="sig-name descname"><span class="pre">get_cderi_exspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_cderi_exspace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_corrfunc_mf">
<span class="sig-name descname"><span class="pre">get_corrfunc_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_corrfunc_mf" title="Link to this definition"></a></dt>
<dd><p>dm1 in MO basis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_dmet_elec_energy">
<span class="sig-name descname"><span class="pre">get_dmet_elec_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_dmet_elec_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_dmet_energy">
<span class="sig-name descname"><span class="pre">get_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_nuc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>with_nuc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include nuclear-repulsion energy. Default: True.</p></li>
<li><p><strong>with_exxdiv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include divergent exact-exchange correction. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_eris_array">
<span class="sig-name descname"><span class="pre">get_eris_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_eris_array" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>[</em><em>list</em><em>(</em><em>4</em><em>) </em><em>of</em><em>] </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(MO), n(MO), n(MO), n(MO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_fock" title="Link to this definition"></a></dt>
<dd><p>Fock matrix in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_fock_for_bath">
<span class="sig-name descname"><span class="pre">get_fock_for_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_fock_for_bath" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for bath orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_fock_for_energy">
<span class="sig-name descname"><span class="pre">get_fock_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_fock_for_energy" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_fragment_overlap_norm">
<span class="sig-name descname"><span class="pre">get_fragment_overlap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupied</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_fragment_overlap_norm" title="Link to this definition"></a></dt>
<dd><p>Get matrix of overlap norms between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_fragments">
<span class="sig-name descname"><span class="pre">get_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_fragments" title="Link to this definition"></a></dt>
<dd><p>Return all fragments which obey the specified conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**filters</strong> – List of returned fragments will be filtered according to specified
keyword arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of fragments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Only returns fragments with mpi_rank 0, 1, or 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">mpi_rank</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Only returns fragments with no symmetry parent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">sym_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_hcore" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian (kinetic energy plus nuclear-electron attraction).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_hcore_for_energy">
<span class="sig-name descname"><span class="pre">get_hcore_for_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_hcore_for_energy" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_lo_coeff">
<span class="sig-name descname"><span class="pre">get_lo_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_lo_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_max_cluster_size">
<span class="sig-name descname"><span class="pre">get_max_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_max_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_mean_cluster_size">
<span class="sig-name descname"><span class="pre">get_mean_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_mean_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_min_cluster_size">
<span class="sig-name descname"><span class="pre">get_min_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_min_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_ovlp" title="Link to this definition"></a></dt>
<dd><p>AO-overlap matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_ovlp_power">
<span class="sig-name descname"><span class="pre">get_ovlp_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_ovlp_power" title="Link to this definition"></a></dt>
<dd><p>get power of AO overlap matrix.</p>
<p>For folded calculations, this uses the k-point sampled overlap, for better performance and accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>power</strong> (<em>float</em>) – Matrix power.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spow</strong> – Matrix power of AO overlap matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(AO), n(AO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_symmetry_child_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_child_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_symmetry_child_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are children to symmetry related parent fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_parents</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, the parent fragment of each symmetry group is prepended to each symmetry sublist.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>children</strong> – A list with the length of the number of parent fragments in the system, each element
being another list containing all the children fragments of the given parent fragment.
Both the outer and inner lists are ordered in the same way that the fragments appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_symmetry_parent_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_parent_fragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_symmetry_parent_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are parents to symmetry related child fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parents</strong> – A list of all parent fragments, ordered in the same way as they appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock Coulomb and exchange potential in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.get_veff_for_energy">
<span class="sig-name descname"><span class="pre">get_veff_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.get_veff_for_energy" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_complete_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_complete_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_complete_occupied_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_occupied_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_complete_occupied_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the occupied space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_complete_virtual_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_virtual_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_complete_virtual_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the virtual space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_df</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_exxdiv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_exxdiv</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Correction for divergent exact-exchange potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.has_orthonormal_fragmentation">
<span class="sig-name descname"><span class="pre">has_orthonormal_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.has_orthonormal_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.iao_fragmentation">
<span class="sig-name descname"><span class="pre">iao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.iao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.iaopao_fragmentation">
<span class="sig-name descname"><span class="pre">iaopao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.iaopao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO+PAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.init_mf">
<span class="sig-name descname"><span class="pre">init_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.init_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.loop">
<span class="sig-name descname"><span class="pre">loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.loop" title="Link to this definition"></a></dt>
<dd><p>Loop over fragments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_energy" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_energy_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_energy_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mo_occ" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital occupations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.mol" title="Link to this definition"></a></dt>
<dd><p>Mole or Cell object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.nao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.nao" title="Link to this definition"></a></dt>
<dd><p>Number of atomic orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.ncells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncells</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.ncells" title="Link to this definition"></a></dt>
<dd><p>Number of primitive cells within supercell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.nfrag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nfrag</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.nfrag" title="Link to this definition"></a></dt>
<dd><p>Number of fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.optimize_chempot">
<span class="sig-name descname"><span class="pre">optimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpt_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.optimize_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.pbc_dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pbc_dimension</span></span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.pbc_dimension" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.pdmet_scmf">
<span class="sig-name descname"><span class="pre">pdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.pdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for p-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.qpewdmet_scmf">
<span class="sig-name descname"><span class="pre">qpewdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.qpewdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for QP-EWDMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.require_complete_fragmentation">
<span class="sig-name descname"><span class="pre">require_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.require_complete_fragmentation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.sao_fragmentation">
<span class="sig-name descname"><span class="pre">sao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.sao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of SAO (Lowdin-AO) fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.set_hcore">
<span class="sig-name descname"><span class="pre">set_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.set_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.set_ovlp">
<span class="sig-name descname"><span class="pre">set_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.set_ovlp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.set_veff">
<span class="sig-name descname"><span class="pre">set_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.set_veff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.site_fragmentation">
<span class="sig-name descname"><span class="pre">site_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.site_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.core.qemb.uqemb.UEmbedding.write_population">
<span class="sig-name descname"><span class="pre">write_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.core.qemb.uqemb.UEmbedding.write_population" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.core.qemb">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vayesta.core.qemb" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vayesta.core.fragmentation.html" class="btn btn-neutral float-left" title="vayesta.core.fragmentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vayesta.core.scmf.html" class="btn btn-neutral float-right" title="vayesta.core.scmf" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>