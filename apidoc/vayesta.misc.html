

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vayesta.misc &mdash; Vayesta 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vayesta.misc.molecules" href="vayesta.misc.molecules.html" />
    <link rel="prev" title="vayesta.libs" href="vayesta.libs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Vayesta
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vayesta</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">API</a></li>
      <li class="breadcrumb-item active">vayesta.misc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/vayesta.misc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vayesta-misc">
<h1>vayesta.misc<a class="headerlink" href="#vayesta-misc" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="vayesta.misc.molecules.html">vayesta.misc.molecules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.molecules.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.molecules.html#module-vayesta.misc.molecules.molecules">vayesta.misc.molecules.molecules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.water"><code class="docutils literal notranslate"><span class="pre">water()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.alkane"><code class="docutils literal notranslate"><span class="pre">alkane()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.alkene"><code class="docutils literal notranslate"><span class="pre">alkene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.arene"><code class="docutils literal notranslate"><span class="pre">arene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.no2"><code class="docutils literal notranslate"><span class="pre">no2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.ethanol"><code class="docutils literal notranslate"><span class="pre">ethanol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.ketene"><code class="docutils literal notranslate"><span class="pre">ketene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.ring"><code class="docutils literal notranslate"><span class="pre">ring()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.chain"><code class="docutils literal notranslate"><span class="pre">chain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.acetic_acid"><code class="docutils literal notranslate"><span class="pre">acetic_acid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.ferrocene_b3lyp"><code class="docutils literal notranslate"><span class="pre">ferrocene_b3lyp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.ferrocene"><code class="docutils literal notranslate"><span class="pre">ferrocene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.propyl"><code class="docutils literal notranslate"><span class="pre">propyl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.phenyl"><code class="docutils literal notranslate"><span class="pre">phenyl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.propanol"><code class="docutils literal notranslate"><span class="pre">propanol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.chloroethanol"><code class="docutils literal notranslate"><span class="pre">chloroethanol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.neopentane"><code class="docutils literal notranslate"><span class="pre">neopentane()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.boronene"><code class="docutils literal notranslate"><span class="pre">boronene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.coronene"><code class="docutils literal notranslate"><span class="pre">coronene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.molecules.html#vayesta.misc.molecules.molecules.glycine"><code class="docutils literal notranslate"><span class="pre">glycine()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.molecules.html#module-vayesta.misc.molecules">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vayesta.misc.solids.html">vayesta.misc.solids</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.solids.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.solids.html#module-vayesta.misc.solids.solids">vayesta.misc.solids.solids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.bcc"><code class="docutils literal notranslate"><span class="pre">bcc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.diamond"><code class="docutils literal notranslate"><span class="pre">diamond()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.graphene"><code class="docutils literal notranslate"><span class="pre">graphene()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.graphite"><code class="docutils literal notranslate"><span class="pre">graphite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.rocksalt"><code class="docutils literal notranslate"><span class="pre">rocksalt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.perovskite"><code class="docutils literal notranslate"><span class="pre">perovskite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="vayesta.misc.solids.html#vayesta.misc.solids.solids.perovskite_tetragonal"><code class="docutils literal notranslate"><span class="pre">perovskite_tetragonal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.solids.html#module-vayesta.misc.solids">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vayesta.misc.variational_embedding.html">vayesta.misc.variational_embedding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.variational_embedding.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.variational_embedding.html#vayesta-misc-variational-embedding-calc-nonorth-couplings">vayesta.misc.variational_embedding.calc_nonorth_couplings</a></li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.variational_embedding.html#vayesta-misc-variational-embedding-variational-params">vayesta.misc.variational_embedding.variational_params</a></li>
<li class="toctree-l2"><a class="reference internal" href="vayesta.misc.variational_embedding.html#module-contents">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-vayesta.misc.brueckner">
<span id="vayesta-misc-brueckner"></span><h2>vayesta.misc.brueckner<a class="headerlink" href="#module-vayesta.misc.brueckner" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.brueckner.update_mo_coeff">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.brueckner.</span></span><span class="sig-name descname"><span class="pre">update_mo_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/brueckner.html#update_mo_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.brueckner.update_mo_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.brueckner.update_mf">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.brueckner.</span></span><span class="sig-name descname"><span class="pre">update_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/brueckner.html#update_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.brueckner.update_mf" title="Link to this definition"></a></dt>
<dd><p>Update occupied MOs based on T1 amplitudes, to converge to Brueckner MOs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>pyscf.scf.SCF</em>) – Mean-field object.</p></li>
<li><p><strong>t1</strong> (<em>(</em><em>n</em><em>(</em><em>Occ</em><em>)</em><em>, </em><em>n</em><em>(</em><em>Vir</em><em>)</em><em>) </em><em>array</em>) – T1 amplitudes (i.e. C1 in intermediate normalization).</p></li>
<li><p><strong>mo_coeff</strong> (<em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em><em>, </em><em>optional</em>) – Molecular orbital coefficients. If None, <cite>mf.mo_coeff</cite> is used. Default: None.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the mf object is updated inplace and the previous MO coefficients are overwritten. Default: False.</p></li>
<li><p><strong>canonicalize</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Diagonalize the Fock matrix within the new occupied and virtual space, to obtain quasi-canonical orbitals.
Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mf</strong> – Mean-field object with updated mf.mo_coeff and mf.e_tot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.scf.SCF</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vayesta.misc.corrfunc">
<span id="vayesta-misc-corrfunc"></span><h2>vayesta.misc.corrfunc<a class="headerlink" href="#module-vayesta.misc.corrfunc" title="Link to this heading"></a></h2>
<p>Correlation function</p>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.chargecharge">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">chargecharge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_indep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#chargecharge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.chargecharge" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spin_z">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spin_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spin_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spin_z" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spin_z_unrestricted">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spin_z_unrestricted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spin_z_unrestricted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spin_z_unrestricted" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spinspin_z">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spinspin_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spinspin_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spinspin_z" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spinspin_z_unrestricted">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spinspin_z_unrestricted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spinspin_z_unrestricted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spinspin_z_unrestricted" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.chargecharge_mf">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">chargecharge_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_indep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#chargecharge_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.chargecharge_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spinspin_z_mf">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spinspin_z_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spinspin_z_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spinspin_z_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.corrfunc.spinspin_z_mf_unrestricted">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.corrfunc.</span></span><span class="sig-name descname"><span class="pre">spinspin_z_mf_unrestricted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/corrfunc.html#spinspin_z_mf_unrestricted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.corrfunc.spinspin_z_mf_unrestricted" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vayesta.misc.counterpoise">
<span id="vayesta-misc-counterpoise"></span><h2>vayesta.misc.counterpoise<a class="headerlink" href="#module-vayesta.misc.counterpoise" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.counterpoise.make_cp_mol">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.counterpoise.</span></span><span class="sig-name descname"><span class="pre">make_cp_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/counterpoise.html#make_cp_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.counterpoise.make_cp_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>pyscf.gto.Mole</em><em> or </em><em>pyscf.pbc.gto.Cell object</em>) – PySCF molecule or cell object.</p></li>
<li><p><strong>atom</strong> (<em>int</em>) – Atom index for which the counterpoise correction should be calculated.
TODO: allow list of atoms.</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 1.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>, </em><em>'a1'</em><em>, </em><em>'a2'</em><em>, </em><em>'a3'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>), Bohr (<cite>B</cite>), or a lattice vector (‘a1’, ‘a2’, ‘a3’).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vayesta.misc.cptbisect">
<span id="vayesta-misc-cptbisect"></span><h2>vayesta.misc.cptbisect<a class="headerlink" href="#module-vayesta.misc.cptbisect" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.misc.cptbisect.ChempotBisection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.misc.cptbisect.</span></span><span class="sig-name descname"><span class="pre">ChempotBisection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpt_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cptbisect.html#ChempotBisection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cptbisect.ChempotBisection" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cptbisect.ChempotBisection.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cptbisect.html#ChempotBisection.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cptbisect.ChempotBisection.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.misc.cubefile">
<span id="vayesta-misc-cubefile"></span><h2>vayesta.misc.cubefile<a class="headerlink" href="#module-vayesta.misc.cubefile" title="Link to this heading"></a></h2>
<p>Modified from PySCF - at the moment only for PBC systems</p>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.misc.cubefile.</span></span><span class="sig-name descname"><span class="pre">CubeFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%13.5E'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.has_pbc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_pbc</span></span><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.has_pbc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.get_box_and_origin">
<span class="sig-name descname"><span class="pre">get_box_and_origin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.get_box_and_origin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.get_box_and_origin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.get_coords">
<span class="sig-name descname"><span class="pre">get_coords</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.get_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.get_coords" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.ncoords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncoords</span></span><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.ncoords" title="Link to this definition"></a></dt>
<dd><p>Number of grod points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.nfields">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nfields</span></span><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.nfields" title="Link to this definition"></a></dt>
<dd><p>Number of datasets (orbitals + density matrices).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.save_state">
<span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.save_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.save_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.load_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.load_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.add_orbital">
<span class="sig-name descname"><span class="pre">add_orbital</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.add_orbital"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.add_orbital" title="Link to this definition"></a></dt>
<dd><p>Add one or more orbitals to the cube file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> – AO coefficients of orbitals. Supports adding a single orbitals,
where <cite>coeff</cite> is a one-dimensional array, or multiple orbitals,
in which case the second dimension of <cite>coeff</cite> labels the orbitals.</p></li>
<li><p><strong>dset_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – Dataset index of orbital(s). In the application, the orbitals will
be labelled as ‘Orbital &lt;dset_idx&gt;’ or similar. If set to <cite>None</cite>,
the smallest unused, positive integer will be used. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.add_density">
<span class="sig-name descname"><span class="pre">add_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.add_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.add_density" title="Link to this definition"></a></dt>
<dd><p>Add one or more densities to the cube file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>(</em><em>N</em><em>,</em><em>N</em><em>) or </em><em>(</em><em>M</em><em>,</em><em>N</em><em>,</em><em>N</em><em>) </em><em>array</em>) – Density-matrix in AO-representation. Supports adding a single density-matrix,
where <cite>dm</cite> is a two-dimensional array, or multiple density-matrices,
in which case the first dimension of <cite>dm</cite> labels the matrices.</p></li>
<li><p><strong>dset_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – Dataset index of density-matrix. In the application, the density-matrix will
be labelled as ‘Orbital &lt;dset_idx&gt;’ or similar. If set to <cite>None</cite>,
the smallest unused, positive integer will be used. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.add_mep">
<span class="sig-name descname"><span class="pre">add_mep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.add_mep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.add_mep" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.write" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.write_header">
<span class="sig-name descname"><span class="pre">write_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.write_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.write_header" title="Link to this definition"></a></dt>
<dd><p>Write header of cube-file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.cubefile.CubeFile.write_fields">
<span class="sig-name descname"><span class="pre">write_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/cubefile.html#CubeFile.write_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.cubefile.CubeFile.write_fields" title="Link to this definition"></a></dt>
<dd><p>Write voxel data of registered fields in <cite>self.fields</cite> to cube-file.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.misc.gto_helper">
<span id="vayesta-misc-gto-helper"></span><h2>vayesta.misc.gto_helper<a class="headerlink" href="#module-vayesta.misc.gto_helper" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.gto_helper.loop_neighbor_cells">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.gto_helper.</span></span><span class="sig-name descname"><span class="pre">loop_neighbor_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/gto_helper.html#loop_neighbor_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.gto_helper.loop_neighbor_cells" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.gto_helper.get_atom_distances">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.gto_helper.</span></span><span class="sig-name descname"><span class="pre">get_atom_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/gto_helper.html#get_atom_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.gto_helper.get_atom_distances" title="Link to this definition"></a></dt>
<dd><p>Get array containing the distances of all atoms to the specified point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>PySCF Mole</em><em> or </em><em>Cell object</em>)</p></li>
<li><p><strong>point</strong> (<em>Array</em><em>(</em><em>3</em><em>)</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Distances</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array(n(atom))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.gto_helper.get_atom_shells">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.gto_helper.</span></span><span class="sig-name descname"><span class="pre">get_atom_shells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/gto_helper.html#get_atom_shells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.gto_helper.get_atom_shells" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.misc.gto_helper.make_counterpoise_fragments">
<span class="sig-prename descclassname"><span class="pre">vayesta.misc.gto_helper.</span></span><span class="sig-name descname"><span class="pre">make_counterpoise_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_rest_fragment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/gto_helper.html#make_counterpoise_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.gto_helper.make_counterpoise_fragments" title="Link to this definition"></a></dt>
<dd><p>Make mol objects for counterpoise calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragments</strong> (<em>iterable</em>)</p></li>
<li><p><strong>full_basis</strong> (<em>bool</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>add_rest_fragment</strong> (<em>bool</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fmols</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vayesta.misc.pcdiis">
<span id="vayesta-misc-pcdiis"></span><h2>vayesta.misc.pcdiis<a class="headerlink" href="#module-vayesta.misc.pcdiis" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.misc.pcdiis.</span></span><span class="sig-name descname"><span class="pre">PCDIIS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pref</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/pcdiis.html#PCDIIS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DIIS</span></code></p>
<p><a class="reference external" href="https://doi.org/10.1021/acs.jctc.7b00892">https://doi.org/10.1021/acs.jctc.7b00892</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/misc/pcdiis.html#PCDIIS.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.update" title="Link to this definition"></a></dt>
<dd><p>Extrapolate vector</p>
<ul class="simple">
<li><p>If xerr the error vector is given, this function will push the target</p></li>
</ul>
<p>vector and error vector in the DIIS subspace, and use the error vector
to extrapolate the vector and return the extrapolated vector.
* If xerr is None, this function will take the difference between
the current given vector and the last given vector as the error
vector to extrapolate the vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.extrapolate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.get_err_vec">
<span class="sig-name descname"><span class="pre">get_err_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.get_err_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.get_num_vec">
<span class="sig-name descname"><span class="pre">get_num_vec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.get_num_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.get_vec">
<span class="sig-name descname"><span class="pre">get_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.get_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.push_err_vec">
<span class="sig-name descname"><span class="pre">push_err_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.push_err_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.push_vec">
<span class="sig-name descname"><span class="pre">push_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.push_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.restore" title="Link to this definition"></a></dt>
<dd><p>Read diis contents from a diis file and replace the attributes of
current diis object if needed, then construct the vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.misc.pcdiis.PCDIIS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.misc.pcdiis.PCDIIS.to_gpu" title="Link to this definition"></a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.misc">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vayesta.misc" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vayesta.libs.html" class="btn btn-neutral float-left" title="vayesta.libs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vayesta.misc.molecules.html" class="btn btn-neutral float-right" title="vayesta.misc.molecules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>