

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vayesta.edmet &mdash; Vayesta 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vayesta.ewf" href="vayesta.ewf.html" />
    <link rel="prev" title="vayesta.dmet" href="vayesta.dmet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Vayesta
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vayesta</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">API</a></li>
      <li class="breadcrumb-item active">vayesta.edmet</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/vayesta.edmet.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vayesta-edmet">
<h1>vayesta.edmet<a class="headerlink" href="#vayesta-edmet" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-vayesta.edmet.edmet">
<span id="vayesta-edmet-edmet"></span><h2>vayesta.edmet.edmet<a class="headerlink" href="#module-vayesta.edmet.edmet" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.edmet.</span></span><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iao_minao:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_consistent:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_elec_err:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_param:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_variable:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'hl</span> <span class="pre">rdm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oneshot:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'xc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'CCSD-S-1-1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#Options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.dmet.Options" title="vayesta.dmet.dmet.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.maxiter">
<span class="sig-name descname"><span class="pre">maxiter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.maxiter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'xc'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'CCSD-S-1-1'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.charge_consistent">
<span class="sig-name descname"><span class="pre">charge_consistent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.charge_consistent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.diis">
<span class="sig-name descname"><span class="pre">diis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.diis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.iao_minao">
<span class="sig-name descname"><span class="pre">iao_minao</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'auto'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.iao_minao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.max_elec_err">
<span class="sig-name descname"><span class="pre">max_elec_err</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.max_elec_err" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.mixing_param">
<span class="sig-name descname"><span class="pre">mixing_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.mixing_param" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.mixing_variable">
<span class="sig-name descname"><span class="pre">mixing_variable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hl</span> <span class="pre">rdm'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.mixing_variable" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.oneshot">
<span class="sig-name descname"><span class="pre">oneshot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.oneshot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMETResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.edmet.</span></span><span class="sig-name descname"><span class="pre">EDMETResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMETResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMETResults" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMETResults.cluster_sizes">
<span class="sig-name descname"><span class="pre">cluster_sizes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMETResults.cluster_sizes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMETResults.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMETResults.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.edmet.</span></span><span class="sig-name descname"><span class="pre">EDMET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EBFCI'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.dmet.DMET" title="vayesta.dmet.dmet.DMET"><code class="xref py py-class docutils literal notranslate"><span class="pre">DMET</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Fragment">
<span class="sig-name descname"><span class="pre">Fragment</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Fragment" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#vayesta.edmet.fragment.EDMETFragment" title="vayesta.edmet.fragment.EDMETFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">EDMETFragment</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iao_minao:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_consistent:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_elec_err:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_param:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_variable:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'hl</span> <span class="pre">rdm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oneshot:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'xc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'CCSD-S-1-1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.dmet.Options" title="vayesta.dmet.dmet.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'xc'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.charge_consistent">
<span class="sig-name descname"><span class="pre">charge_consistent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.charge_consistent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.diis">
<span class="sig-name descname"><span class="pre">diis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.diis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.iao_minao">
<span class="sig-name descname"><span class="pre">iao_minao</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'auto'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.iao_minao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.max_elec_err">
<span class="sig-name descname"><span class="pre">max_elec_err</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.max_elec_err" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.maxiter">
<span class="sig-name descname"><span class="pre">maxiter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.maxiter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.mixing_param">
<span class="sig-name descname"><span class="pre">mixing_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.mixing_param" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.mixing_variable">
<span class="sig-name descname"><span class="pre">mixing_variable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hl</span> <span class="pre">rdm'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.mixing_variable" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.oneshot">
<span class="sig-name descname"><span class="pre">oneshot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.oneshot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'CCSD-S-1-1'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.with_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.eps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.e_nonlocal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nonlocal</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.e_nonlocal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.check_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.kernel" title="Link to this definition"></a></dt>
<dd><p>Run DMET calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.set_up_fragments">
<span class="sig-name descname"><span class="pre">set_up_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sym_parents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.set_up_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.set_up_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.calc_electron_number_defect">
<span class="sig-name descname"><span class="pre">calc_electron_number_defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chempot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_fragments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construct_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.calc_electron_number_defect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.calc_electron_number_defect" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_updated_correlation_kernel">
<span class="sig-name descname"><span class="pre">get_updated_correlation_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_dd0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_dd1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_parents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_children</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.get_updated_correlation_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_updated_correlation_kernel" title="Link to this definition"></a></dt>
<dd><p>Generate the update to our RPA exchange-correlation kernel this iteration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.improve_nl_energy">
<span class="sig-name descname"><span class="pre">improve_nl_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.improve_nl_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.improve_nl_energy" title="Link to this definition"></a></dt>
<dd><p>Perform exact adiabatic-connection integration to obtain improved estimate for the nonlocal correlation
energy at the level of RPA. This is initially only calculated using a linear approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.run_exact_full_ac">
<span class="sig-name descname"><span class="pre">run_exact_full_ac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_constrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/edmet.html#EDMET.run_exact_full_ac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.run_exact_full_ac" title="Link to this definition"></a></dt>
<dd><p>During calculation we only calculate the linearised nonlocal correlation energy, since this is relatively
cheap (only a single RPA numerical integration). This instead performs the exact energy via numerical
integration of the adiabatic connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.brueckner_scmf">
<span class="sig-name descname"><span class="pre">brueckner_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.brueckner_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for Brueckner-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.build_bosonic_bath">
<span class="sig-name descname"><span class="pre">build_bosonic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.build_bosonic_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.build_screened_eris">
<span class="sig-name descname"><span class="pre">build_screened_eris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.build_screened_eris" title="Link to this definition"></a></dt>
<dd><p>Generates renormalised coulomb interactions for use in local cluster calculations.
Currently requires unrestricted system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<a class="reference internal" href="vayesta.core.qemb.html#vayesta.core.qemb.qemb.Embedding" title="vayesta.core.qemb.qemb.Embedding"><em>Embedding</em></a>) – Embedding instance.</p></li>
<li><p><strong>fragments</strong> (<em>list</em><em> of </em><em>vayesta.qemb.Fragment subclasses</em><em>, </em><em>optional</em>) – List of fragments for the calculation, used to define local interaction spaces.
If None, <cite>emb.get_fragments(sym_parent=None)</cite> is used. Default: None.</p></li>
<li><p><strong>cderi_ov</strong> (<em>np.array</em><em> or </em><em>tuple</em><em> of </em><em>np.array</em><em>, </em><em>optional.</em>) – Cholesky-decomposed ERIs in the particle-hole basis of mf. If mf is unrestricted
this should be a list of arrays corresponding to the different spin channels.</p></li>
<li><p><strong>store_m0</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to store the local zeroth moment in the fragment class for use later.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points for numerical integration. Default: 48.</p></li>
<li><p><strong>log</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger object. If None, the logger of the <cite>emb</cite> object is used. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>seris_ov</strong> (<em>list of tuples of np.array</em>) – List of spin-dependent screened (ov|ov), for each fragment provided.</p></li>
<li><p><strong>erpa</strong> (<em>float</em>) – Delta RPA correction computed as difference between full system RPA energy and
cluster correlation energies; currently only functional in CAS fragmentations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.build_screened_interactions">
<span class="sig-name descname"><span class="pre">build_screened_interactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.build_screened_interactions" title="Link to this definition"></a></dt>
<dd><p>Build screened interactions, be they dynamic or static.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.cas_fragmentation">
<span class="sig-name descname"><span class="pre">cas_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.cas_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.check_fragment_symmetry">
<span class="sig-name descname"><span class="pre">check_fragment_symmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.check_fragment_symmetry" title="Link to this definition"></a></dt>
<dd><p>Check that the mean-field obeys the symmetry between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.communicate_clusters">
<span class="sig-name descname"><span class="pre">communicate_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.communicate_clusters" title="Link to this definition"></a></dt>
<dd><p>Communicate cluster orbitals between MPI ranks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.create_invsym_fragments">
<span class="sig-name descname"><span class="pre">create_invsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.create_invsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create inversion symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of inversion-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.create_mirrorsym_fragments">
<span class="sig-name descname"><span class="pre">create_mirrorsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.create_mirrorsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create mirror symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of mirror-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.create_rotsym_fragments">
<span class="sig-name descname"><span class="pre">create_rotsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.create_rotsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create rotationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of rotationally-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.create_symmetric_fragments">
<span class="sig-name descname"><span class="pre">create_symmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.create_symmetric_fragments" title="Link to this definition"></a></dt>
<dd><p>Add rotationally or translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: self.opts.symmetry_mf_tol.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.create_transsym_fragments">
<span class="sig-name descname"><span class="pre">create_transsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.create_transsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>translation</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.e_mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_mf</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.e_mf" title="Link to this definition"></a></dt>
<dd><p>Total mean-field energy per unit cell (not folded supercell).
Note that the input unit cell itself can be a supercell, in which case
<cite>e_mf</cite> refers to this cell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.e_nuc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nuc</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.e_nuc" title="Link to this definition"></a></dt>
<dd><p>Nuclear-repulsion energy per unit cell (not folded supercell).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.e_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_atomic_charges">
<span class="sig-name descname"><span class="pre">get_atomic_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_atomic_charges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_average_cluster_size">
<span class="sig-name descname"><span class="pre">get_average_cluster_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_average_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_cderi_exspace">
<span class="sig-name descname"><span class="pre">get_cderi_exspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_cderi_exspace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_corrfunc">
<span class="sig-name descname"><span class="pre">get_corrfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_corrfunc" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_corrfunc_mf">
<span class="sig-name descname"><span class="pre">get_corrfunc_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_corrfunc_mf" title="Link to this definition"></a></dt>
<dd><p>dm1 in MO basis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_dmet_elec_energy">
<span class="sig-name descname"><span class="pre">get_dmet_elec_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_dmet_elec_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_dmet_energy">
<span class="sig-name descname"><span class="pre">get_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_nuc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>with_nuc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include nuclear-repulsion energy. Default: True.</p></li>
<li><p><strong>with_exxdiv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include divergent exact-exchange correction. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_eris_array">
<span class="sig-name descname"><span class="pre">get_eris_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_eris_array" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>[</em><em>list</em><em>(</em><em>4</em><em>) </em><em>of</em><em>] </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(MO), n(MO), n(MO), n(MO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_eris_object">
<span class="sig-name descname"><span class="pre">get_eris_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">postscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_eris_object" title="Link to this definition"></a></dt>
<dd><p>Get ERIs for post-SCF methods.</p>
<p>For folded PBC calculations, this folds the MO back into k-space
and contracts with the k-space three-center integrals..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>postscf</strong> (<em>one</em><em> of </em><em>the following PySCF methods: MP2</em><em>, </em><em>CCSD</em><em>, </em><em>RCCSD</em><em>, </em><em>DFCCSD</em>) – Post-SCF method with attribute mo_coeff set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – ERIs which can be used for the respective post-scf method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_ChemistsERIs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_exxdiv">
<span class="sig-name descname"><span class="pre">get_exxdiv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Get divergent exact-exchange (exxdiv) energy correction and potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>e_exxdiv</strong> (<em>float</em>) – Divergent exact-exchange energy correction per unit cell.</p></li>
<li><p><strong>v_exxdiv</strong> (<em>array</em>) – Divergent exact-exchange potential correction in AO basis.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_fock" title="Link to this definition"></a></dt>
<dd><p>Fock matrix in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_fock_for_bath">
<span class="sig-name descname"><span class="pre">get_fock_for_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_fock_for_bath" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for bath orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_fock_for_energy">
<span class="sig-name descname"><span class="pre">get_fock_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_fock_for_energy" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_fragment_overlap_norm">
<span class="sig-name descname"><span class="pre">get_fragment_overlap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupied</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_fragment_overlap_norm" title="Link to this definition"></a></dt>
<dd><p>Get matrix of overlap norms between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_fragments">
<span class="sig-name descname"><span class="pre">get_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_fragments" title="Link to this definition"></a></dt>
<dd><p>Return all fragments which obey the specified conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**filters</strong> – List of returned fragments will be filtered according to specified
keyword arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of fragments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Only returns fragments with mpi_rank 0, 1, or 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">mpi_rank</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Only returns fragments with no symmetry parent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">sym_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_hcore" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian (kinetic energy plus nuclear-electron attraction).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_hcore_for_energy">
<span class="sig-name descname"><span class="pre">get_hcore_for_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_hcore_for_energy" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_impurity_coeffs">
<span class="sig-name descname"><span class="pre">get_impurity_coeffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_impurity_coeffs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_lo_coeff">
<span class="sig-name descname"><span class="pre">get_lo_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_lo_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_max_cluster_size">
<span class="sig-name descname"><span class="pre">get_max_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_max_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_mean_cluster_size">
<span class="sig-name descname"><span class="pre">get_mean_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_mean_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_min_cluster_size">
<span class="sig-name descname"><span class="pre">get_min_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_min_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_ovlp" title="Link to this definition"></a></dt>
<dd><p>AO-overlap matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_ovlp_power">
<span class="sig-name descname"><span class="pre">get_ovlp_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_ovlp_power" title="Link to this definition"></a></dt>
<dd><p>get power of AO overlap matrix.</p>
<p>For folded calculations, this uses the k-point sampled overlap, for better performance and accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>power</strong> (<em>float</em>) – Matrix power.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spow</strong> – Matrix power of AO overlap matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(AO), n(AO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_symmetry_child_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_child_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_symmetry_child_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are children to symmetry related parent fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_parents</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, the parent fragment of each symmetry group is prepended to each symmetry sublist.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>children</strong> – A list with the length of the number of parent fragments in the system, each element
being another list containing all the children fragments of the given parent fragment.
Both the outer and inner lists are ordered in the same way that the fragments appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_symmetry_parent_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_parent_fragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_symmetry_parent_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are parents to symmetry related child fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parents</strong> – A list of all parent fragments, ordered in the same way as they appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock Coulomb and exchange potential in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.get_veff_for_energy">
<span class="sig-name descname"><span class="pre">get_veff_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.get_veff_for_energy" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_complete_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_complete_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_complete_occupied_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_occupied_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_complete_occupied_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the occupied space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_complete_virtual_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_virtual_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_complete_virtual_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the virtual space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_df</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_exxdiv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_exxdiv</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Correction for divergent exact-exchange potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.has_orthonormal_fragmentation">
<span class="sig-name descname"><span class="pre">has_orthonormal_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.has_orthonormal_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.iao_fragmentation">
<span class="sig-name descname"><span class="pre">iao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.iao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.iaopao_fragmentation">
<span class="sig-name descname"><span class="pre">iaopao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.iaopao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO+PAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.init_mf">
<span class="sig-name descname"><span class="pre">init_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.init_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.is_rhf">
<span class="sig-name descname"><span class="pre">is_rhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.is_rhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.is_uhf">
<span class="sig-name descname"><span class="pre">is_uhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.is_uhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.loop">
<span class="sig-name descname"><span class="pre">loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.loop" title="Link to this definition"></a></dt>
<dd><p>Loop over fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.make_rdm1" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – Alpha- and beta one-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (n, n) arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.make_rdm1_demo">
<span class="sig-name descname"><span class="pre">make_rdm1_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.make_rdm1_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – One-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.make_rdm2" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.make_rdm2_demo">
<span class="sig-name descname"><span class="pre">make_rdm2_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.make_rdm2_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_energy" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_energy_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_energy_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mo_occ" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital occupations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.mol" title="Link to this definition"></a></dt>
<dd><p>Mole or Cell object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.nao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.nao" title="Link to this definition"></a></dt>
<dd><p>Number of atomic orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.ncells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncells</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.ncells" title="Link to this definition"></a></dt>
<dd><p>Number of primitive cells within supercell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.nfrag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nfrag</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.nfrag" title="Link to this definition"></a></dt>
<dd><p>Number of fragments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.nmo" title="Link to this definition"></a></dt>
<dd><p>Total number of molecular orbitals (MOs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.nocc" title="Link to this definition"></a></dt>
<dd><p>Number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.nvir" title="Link to this definition"></a></dt>
<dd><p>Number of virtual MOs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.optimize_chempot">
<span class="sig-name descname"><span class="pre">optimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpt_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.optimize_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.pbc_dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pbc_dimension</span></span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.pbc_dimension" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.pdmet_scmf">
<span class="sig-name descname"><span class="pre">pdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.pdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for p-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.pop_analysis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>(</em><em>N</em><em>, </em><em>N</em><em>) </em><em>array</em>) – If <cite>mo_coeff</cite> is None, AO representation is assumed.</p></li>
<li><p><strong>local_orbitals</strong> (<em>{'lowdin'</em><em>, </em><em>'mulliken'</em><em>, </em><em>'iao+pao'}</em><em> or </em><em>array</em>) – Kind of population analysis. Default: ‘lowdin’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pop</strong> – Population of atomic orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ol class="upperalpha simple" start="14">
<li><p>array</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.print_clusters">
<span class="sig-name descname"><span class="pre">print_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.print_clusters" title="Link to this definition"></a></dt>
<dd><p>Print fragments of calculations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.print_results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.qpewdmet_scmf">
<span class="sig-name descname"><span class="pre">qpewdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.qpewdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for QP-EWDMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.require_complete_fragmentation">
<span class="sig-name descname"><span class="pre">require_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.require_complete_fragmentation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.sao_fragmentation">
<span class="sig-name descname"><span class="pre">sao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.sao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of SAO (Lowdin-AO) fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.set_hcore">
<span class="sig-name descname"><span class="pre">set_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.set_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.set_ovlp">
<span class="sig-name descname"><span class="pre">set_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.set_ovlp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.set_veff">
<span class="sig-name descname"><span class="pre">set_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.set_veff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.site_fragmentation">
<span class="sig-name descname"><span class="pre">site_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.site_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.spinsym">
<span class="sig-name descname"><span class="pre">spinsym</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'restricted'</span></em><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.spinsym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.update_mf">
<span class="sig-name descname"><span class="pre">update_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.update_mf" title="Link to this definition"></a></dt>
<dd><p>Update underlying mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.update_vcorr">
<span class="sig-name descname"><span class="pre">update_vcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_rdms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.update_vcorr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.EDMET.write_population">
<span class="sig-name descname"><span class="pre">write_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.edmet.EDMET.write_population" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.edmet.REDMET">
<span class="sig-prename descclassname"><span class="pre">vayesta.edmet.edmet.</span></span><span class="sig-name descname"><span class="pre">REDMET</span></span><a class="headerlink" href="#vayesta.edmet.edmet.REDMET" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#vayesta.edmet.edmet.EDMET" title="vayesta.edmet.edmet.EDMET"><code class="xref py py-class docutils literal notranslate"><span class="pre">EDMET</span></code></a></p>
</dd></dl>

</section>
<section id="module-vayesta.edmet.fragment">
<span id="vayesta-edmet-fragment"></span><h2>vayesta.edmet.fragment<a class="headerlink" href="#module-vayesta.edmet.fragment" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragmentExit">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.fragment.</span></span><span class="sig-name descname"><span class="pre">EDMETFragmentExit</span></span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragmentExit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragmentExit" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragmentExit.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragmentExit.args" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragmentExit.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragmentExit.with_traceback" title="Link to this definition"></a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.fragment.</span></span><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#Options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.qemb.html#vayesta.core.qemb.fragment.Options" title="vayesta.core.qemb.fragment.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.edmet.fragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.fragment.</span></span><span class="sig-name descname"><span class="pre">EDMETFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.fragment.DMETFragment" title="vayesta.dmet.fragment.DMETFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DMETFragment</span></code></a></p>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.qemb.html#vayesta.core.qemb.fragment.Options" title="vayesta.core.qemb.fragment.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converged</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr_rpa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_eb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eb_couplings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_freqs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd_mom0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd_mom1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_fb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.Results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.fragment.DMETFragment.Results" title="vayesta.dmet.fragment.DMETFragment.Results"><code class="xref py py-class docutils literal notranslate"><span class="pre">Results</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.dm_eb">
<span class="sig-name descname"><span class="pre">dm_eb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.dm_eb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.eb_couplings">
<span class="sig-name descname"><span class="pre">eb_couplings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.eb_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.boson_freqs">
<span class="sig-name descname"><span class="pre">boson_freqs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.boson_freqs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.dd_mom0">
<span class="sig-name descname"><span class="pre">dd_mom0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.dd_mom0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.dd_mom1">
<span class="sig-name descname"><span class="pre">dd_mom1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.dd_mom1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.e_fb">
<span class="sig-name descname"><span class="pre">e_fb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.e_fb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.converged" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.dm1">
<span class="sig-name descname"><span class="pre">dm1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.dm1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.dm2">
<span class="sig-name descname"><span class="pre">dm2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.dm2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.e1">
<span class="sig-name descname"><span class="pre">e1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.e1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.e2">
<span class="sig-name descname"><span class="pre">e2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.e2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.e_corr_rpa">
<span class="sig-name descname"><span class="pre">e_corr_rpa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.e_corr_rpa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.fid">
<span class="sig-name descname"><span class="pre">fid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.fid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.moms">
<span class="sig-name descname"><span class="pre">moms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.moms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.n_active">
<span class="sig-name descname"><span class="pre">n_active</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.n_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.pwf">
<span class="sig-name descname"><span class="pre">pwf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.pwf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Results.wf">
<span class="sig-name descname"><span class="pre">wf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Results.wf" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.ov_active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.ov_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.ov_active_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active_tot</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.ov_active_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.ov_mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_mf</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.ov_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.nbos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nbos</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.nbos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.r_bos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_bos</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.r_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.r_bos_ao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_bos_ao</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.r_bos_ao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.r_ao_bos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_ao_bos</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.r_ao_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.energy_couplings">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_couplings</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.energy_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.check_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_co_active">
<span class="sig-name descname"><span class="pre">get_co_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_co_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_co_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_cv_active">
<span class="sig-name descname"><span class="pre">get_cv_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_cv_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_cv_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_rot_to_mf_ov">
<span class="sig-name descname"><span class="pre">get_rot_to_mf_ov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_rot_to_mf_ov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_rot_to_mf_ov" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragment_projector_ov">
<span class="sig-name descname"><span class="pre">get_fragment_projector_ov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_bosons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_fragment_projector_ov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragment_projector_ov" title="Link to this definition"></a></dt>
<dd><p>In space of cluster p-h excitations, generate the projector to the impurity portion of the occupied index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.set_up_fermionic_bath">
<span class="sig-name descname"><span class="pre">set_up_fermionic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.set_up_fermionic_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.set_up_fermionic_bath" title="Link to this definition"></a></dt>
<dd><p>Set up the fermionic bath orbitals</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.define_bosons">
<span class="sig-name descname"><span class="pre">define_bosons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rpa_mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_ov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.define_bosons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.define_bosons" title="Link to this definition"></a></dt>
<dd><p>Given the RPA zeroth moment between the fermionic cluster excitations and the rest of the space, define
our cluster bosons.
Note that this doesn’t define our Hamiltonian, since we don’t yet have the required portion of our
zeroth moment for the bosonic degrees of freedom.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.construct_boson_hamil">
<span class="sig-name descname"><span class="pre">construct_boson_hamil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta0_bos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.construct_boson_hamil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.construct_boson_hamil" title="Link to this definition"></a></dt>
<dd><p>Given the zeroth moment coupling of our bosons to the remainder of the space, along with stored information,
generate the components of our interacting electron-boson Hamiltonian.
At the same time, calculate the local RPA correlation energy since this requires all the same information we
already have to hand.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.store_cluster_rpa">
<span class="sig-name descname"><span class="pre">store_cluster_rpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta0_bos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.store_cluster_rpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.store_cluster_rpa" title="Link to this definition"></a></dt>
<dd><p>This function just stores all required information for the</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_eri_couplings">
<span class="sig-name descname"><span class="pre">get_eri_couplings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_eri_couplings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_eri_couplings" title="Link to this definition"></a></dt>
<dd><p>Obtain eri in a space defined by an arbitrary rotation of the mean-field particle-hole excitations of our
systems. Note that this should only really be used in the case that such a rotation cannot be described by a
rotation of the underlying single-particle basis, since highly efficient routines already exist for this case..</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.conv_to_aos">
<span class="sig-name descname"><span class="pre">conv_to_aos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.conv_to_aos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.conv_to_aos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_xc_couplings">
<span class="sig-name descname"><span class="pre">get_xc_couplings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_xc_couplings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_xc_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_loc_eps">
<span class="sig-name descname"><span class="pre">get_loc_eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_loc_eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_loc_eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.proj_hamil_qba">
<span class="sig-name descname"><span class="pre">proj_hamil_qba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exchange_between_bos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.proj_hamil_qba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.proj_hamil_qba" title="Link to this definition"></a></dt>
<dd><p>Generate quasi-bosonic Hamiltonian via projection of appropriate Hamiltonian elements of full system.
This represents the bosons as an explicit sum of environmental excitations, which we then approximate as bosonic</p>
<blockquote>
<div><p>degrees of freedom.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.check_qba_approx">
<span class="sig-name descname"><span class="pre">check_qba_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.check_qba_approx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.check_qba_approx" title="Link to this definition"></a></dt>
<dd><p>Given boson and cluster coefficient definitions, checks deviation from exact bosonic commutation relations
within our cluster projected onto the ground state.
This will hopefully tell us whether our bosons are likely to be a good approximation to the full system.
We could take the L2 norm of the overall deviation, but given most of the resultant operators have essentially
negligible expectation values with the ground state this is an unnecessarily pessimistic
estimator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_rbos_split">
<span class="sig-name descname"><span class="pre">get_rbos_split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_rbos_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_rbos_split" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construct_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.kernel" title="Link to this definition"></a></dt>
<dd><p>Solve the fragment with the specified solver and chemical potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_solver_options">
<span class="sig-name descname"><span class="pre">get_solver_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_solver_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_edmet_energy_contrib">
<span class="sig-name descname"><span class="pre">get_edmet_energy_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_edmet_energy_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_edmet_energy_contrib" title="Link to this definition"></a></dt>
<dd><p>Generate EDMET energy contribution, according to expression given in appendix of EDMET preprint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.construct_correlation_kernel_contrib">
<span class="sig-name descname"><span class="pre">construct_correlation_kernel_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svdtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.construct_correlation_kernel_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.construct_correlation_kernel_contrib" title="Link to this definition"></a></dt>
<dd><p>Generate the contribution to the correlation kernel arising from this fragment, in terms of local degrees of
freedom (ie cluster orbitals and bosons).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_correlation_kernel_contrib">
<span class="sig-name descname"><span class="pre">get_correlation_kernel_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contrib</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_correlation_kernel_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_correlation_kernel_contrib" title="Link to this definition"></a></dt>
<dd><p>Gets contribution to xc kernel in full space of system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_composite_moments">
<span class="sig-name descname"><span class="pre">get_composite_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_composite_moments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_composite_moments" title="Link to this definition"></a></dt>
<dd><p>Construct composite moments using the local solver dd moments and the lattice RPA moments</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_rot_ov_frag">
<span class="sig-name descname"><span class="pre">get_rot_ov_frag</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.get_rot_ov_frag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_rot_ov_frag" title="Link to this definition"></a></dt>
<dd><p>Get rotations between the relevant space for fragment two-point excitations and the cluster active occupied-
virtual excitations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.calc_exact_ac">
<span class="sig-name descname"><span class="pre">calc_exact_ac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.calc_exact_ac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.calc_exact_ac" title="Link to this definition"></a></dt>
<dd><p>Evaluate the exact local energy for RPA in this cluster via the Adiabatic Connection, with or without
the plasmon formula. Note that although</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.test_total_rpa_energy">
<span class="sig-name descname"><span class="pre">test_total_rpa_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.test_total_rpa_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.test_total_rpa_energy" title="Link to this definition"></a></dt>
<dd><p>Evaluate the exact local energy for RPA in this cluster via the Adiabatic Connection, with or without
the plasmon formula. Note that although</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.ov_active_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active_ab</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.ov_active_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.nocc_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc_ab</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.nocc_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.nclus_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nclus_ab</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.nclus_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.nvir_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir_ab</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.nvir_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Flags">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_envelop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_secfrag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_parent_fragment_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Flags" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Flags.bath_parent_fragment_id">
<span class="sig-name descname"><span class="pre">bath_parent_fragment_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Flags.bath_parent_fragment_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Flags.is_envelop">
<span class="sig-name descname"><span class="pre">is_envelop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Flags.is_envelop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.Flags.is_secfrag">
<span class="sig-name descname"><span class="pre">is_secfrag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.Flags.is_secfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.add_tsymmetric_fragments">
<span class="sig-name descname"><span class="pre">add_tsymmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.add_tsymmetric_fragments" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tvecs</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>symtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will be automatically added to base.fragments and
have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.canonicalize_mo">
<span class="sig-name descname"><span class="pre">canonicalize_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.canonicalize_mo" title="Link to this definition"></a></dt>
<dd><p>Diagonalize Fock matrix within subspace.</p>
<p>TODO: move to Embedding class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>eigenvalues</strong> (<em>ndarray</em>) – Return MO energies of canonicalized orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mo_canon</strong> (<em>ndarray</em>) – Canonicalized orbital coefficients.</p></li>
<li><p><strong>rot</strong> (<em>ndarray</em>) – Rotation matrix: np.dot(mo_coeff, rot) = mo_canon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.cluster">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.contributes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contributes</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.contributes" title="Link to this definition"></a></dt>
<dd><p>True if fragment contributes to expectation values, else False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.copy" title="Link to this definition"></a></dt>
<dd><p>Create copy of fragment, without adding it to the fragments list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.couple_to_fragment">
<span class="sig-name descname"><span class="pre">couple_to_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.couple_to_fragment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.couple_to_fragments">
<span class="sig-name descname"><span class="pre">couple_to_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.couple_to_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.diagonalize_cluster_dm">
<span class="sig-name descname"><span class="pre">diagonalize_cluster_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.diagonalize_cluster_dm" title="Link to this definition"></a></dt>
<dd><p>Diagonalize cluster (fragment+bath) DM to get fully occupied and virtual orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>array</em><em> or </em><em>list</em><em> of </em><em>arrays</em>) – Orbital coefficients. If multiple are given, they will be stacked along their second dimension.</p></li>
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Mean-field density matrix, used to separate occupied and virtual cluster orbitals.
If None, <cite>self.mf.make_rdm1()</cite> is used. Default: None.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – If set, check that all eigenvalues of the cluster DM are close
to 0 or 2, with the tolerance given by tol. Default= 1e-4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c_cluster_occ</strong> (<em>(n(AO), n(occ cluster)) array</em>) – Occupied cluster orbital coefficients.</p></li>
<li><p><strong>c_cluster_vir</strong> (<em>(n(AO), n(vir cluster)) array</em>) – Virtual cluster orbital coefficients.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_coeff_env">
<span class="sig-name descname"><span class="pre">get_coeff_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_coeff_env" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_dmet_energy_contrib">
<span class="sig-name descname"><span class="pre">get_dmet_energy_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_dmet_energy_contrib" title="Link to this definition"></a></dt>
<dd><p>Calculate the contribution of this fragment to the overall DMET energy.</p>
<p>TODO: use core.qemb.fragment.get_fragment_dmet_energy instead?</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_frag_hamil">
<span class="sig-name descname"><span class="pre">get_frag_hamil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_frag_hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_frag_hl_dm">
<span class="sig-name descname"><span class="pre">get_frag_hl_dm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_frag_hl_dm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragment_dmet_energy">
<span class="sig-name descname"><span class="pre">get_fragment_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragment_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Get fragment contribution to whole system DMET energy from cluster DMs.</p>
<p>After fragment summation, the nuclear-nuclear repulsion must be added to get the total energy!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster one-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm1</cite> is used. Default: None.</p></li>
<li><p><strong>dm2</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster two-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm2</cite> is used. Default: None.</p></li>
<li><p><strong>hamil</strong> (<em>ClusterHamiltonian object.</em>) – Object representing cluster hamiltonian, possibly including cached ERIs.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic fragment DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragment_mf_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mf_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragment_mf_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the part of the mean-field energy associated with the fragment.</p>
<p>Does not include nuclear-nuclear repulsion!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragment_mo_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mo_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragment_mo_energy" title="Link to this definition"></a></dt>
<dd><p>Returns approximate MO energies, using the the diagonal of the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_active</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>fock</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragment_projector">
<span class="sig-name descname"><span class="pre">get_fragment_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragment_projector" title="Link to this definition"></a></dt>
<dd><p>Projector for one index of amplitudes local energy expression.</p>
<p>Cost: N^2 if O(1) coeffs , N^3 if O(N) coeffs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>N</em><em>)</em>) – Occupied or virtual orbital coefficients.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return 1-p instead. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – Projection matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_fragments_with_overlap">
<span class="sig-name descname"><span class="pre">get_fragments_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_fragments_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Get list of fragments which overlap both in occupied and virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_local_rpa_correction">
<span class="sig-name descname"><span class="pre">get_local_rpa_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_local_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_mo_occupation">
<span class="sig-name descname"><span class="pre">get_mo_occupation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_mo_occupation" title="Link to this definition"></a></dt>
<dd><p>Get mean-field occupation numbers (diagonal of 1-RDM) of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>N</em><em>, </em><em>M</em><em>)</em>) – Orbital coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>occup</strong> – Occupation numbers of orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_nelectron_hl">
<span class="sig-name descname"><span class="pre">get_nelectron_hl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_nelectron_hl" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_overlap">
<span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Get overlap between cluster orbitals, fragment orbitals, or MOs.</p>
<p>The return value is cached but not copied; do not modify the array in place without
creating a copy!</p>
<p>Examples:
&gt;&gt;&gt; s = self.get_overlap(‘cluster|mo’)
&gt;&gt;&gt; s = self.get_overlap(‘cluster|frag’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[occ]|cluster[occ]’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[vir]|cluster[vir]’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_children">
<span class="sig-name descname"><span class="pre">get_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_children" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_error">
<span class="sig-name descname"><span class="pre">get_symmetry_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_error" title="Link to this definition"></a></dt>
<dd><p>Get translational symmetry error between two fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_generations">
<span class="sig-name descname"><span class="pre">get_symmetry_generations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_generations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_operation">
<span class="sig-name descname"><span class="pre">get_symmetry_operation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_parent">
<span class="sig-name descname"><span class="pre">get_symmetry_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.get_symmetry_tree">
<span class="sig-name descname"><span class="pre">get_symmetry_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.get_symmetry_tree" title="Link to this definition"></a></dt>
<dd><p>Returns a recursive tree:</p>
<p>[(x, [children of x]), (y, [children of y]), …]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.hamil">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hamil</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.id_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id_name</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.id_name" title="Link to this definition"></a></dt>
<dd><p>Use this whenever a unique name is needed (for example to open a separate file for each fragment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.log_info">
<span class="sig-name descname"><span class="pre">log_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.log_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.loop_symmetry_children">
<span class="sig-name descname"><span class="pre">loop_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.loop_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Loop over all symmetry related fragments, including children of children, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em><em> or </em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>optional</em>) – If arrays are passed, the symmetry operation of each symmetry related fragment will be
applied to this array along the axis given in <cite>axes</cite>.</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of axes, along which the symmetry operation is applied for each element of <cite>arrays</cite>.
If None, the first axis will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.make_bath">
<span class="sig-name descname"><span class="pre">make_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.make_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.make_bosonic_bath_target">
<span class="sig-name descname"><span class="pre">make_bosonic_bath_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.make_bosonic_bath_target" title="Link to this definition"></a></dt>
<dd><p>Get the target space for bosonic bath orbitals. This can either be the DMET cluster or the full space, and
can include a projection onto the fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.make_bosonic_cluster">
<span class="sig-name descname"><span class="pre">make_bosonic_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.make_bosonic_cluster" title="Link to this definition"></a></dt>
<dd><p>Set bosonic component of the cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.make_cluster">
<span class="sig-name descname"><span class="pre">make_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.make_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.make_counterpoise_mol">
<span class="sig-name descname"><span class="pre">make_counterpoise_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.make_counterpoise_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 5.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>) or Bohr (<cite>B</cite>).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.n_frag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frag</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.n_frag" title="Link to this definition"></a></dt>
<dd><p>Number of fragment orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.n_symmetry_children">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_symmetry_children</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.n_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.nelectron">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelectron</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.nelectron" title="Link to this definition"></a></dt>
<dd><p>Number of mean-field electrons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.plot3d" title="Link to this definition"></a></dt>
<dd><p>Write cube density data of fragment orbitals to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.pop_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.project_ref_orbitals">
<span class="sig-name descname"><span class="pre">project_ref_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.project_ref_orbitals" title="Link to this definition"></a></dt>
<dd><p>Project reference orbitals into available space in new geometry.</p>
<p>The projected orbitals will be ordered according to their eigenvalues within the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>ndarray</em>) – Orbital coefficients.</p></li>
<li><p><strong>c_ref</strong> (<em>ndarray</em>) – Orbital coefficients of reference orbitals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.split_ov_spin_components">
<span class="sig-name descname"><span class="pre">split_ov_spin_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#EDMETFragment.split_ov_spin_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.split_ov_spin_components" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.symmetry_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symmetry_factor</span></span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.symmetry_factor" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.EDMETFragment.trimmed_name">
<span class="sig-name descname"><span class="pre">trimmed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.fragment.EDMETFragment.trimmed_name" title="Link to this definition"></a></dt>
<dd><p>Fragment name trimmed to a given maximum length.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vayesta.edmet.fragment.bogoliubov_decouple">
<span class="sig-prename descclassname"><span class="pre">vayesta.edmet.fragment.</span></span><span class="sig-name descname"><span class="pre">bogoliubov_decouple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/fragment.html#bogoliubov_decouple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.fragment.bogoliubov_decouple" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vayesta.edmet.uedmet">
<span id="vayesta-edmet-uedmet"></span><h2>vayesta.edmet.uedmet<a class="headerlink" href="#module-vayesta.edmet.uedmet" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.uedmet.</span></span><span class="sig-name descname"><span class="pre">UEDMET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EBFCI'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/uedmet.html#UEDMET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#vayesta.edmet.edmet.EDMET" title="vayesta.edmet.edmet.EDMET"><code class="xref py py-class docutils literal notranslate"><span class="pre">EDMET</span></code></a>, <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.udmet.UDMET" title="vayesta.dmet.udmet.UDMET"><code class="xref py py-class docutils literal notranslate"><span class="pre">UDMET</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.eps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Fragment">
<span class="sig-name descname"><span class="pre">Fragment</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Fragment" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#vayesta.edmet.ufragment.UEDMETFragment" title="vayesta.edmet.ufragment.UEDMETFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">UEDMETFragment</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_frag_chempot:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_mf_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_rpa_correction:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iao_minao:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_consistent:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_elec_err:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_param:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_variable:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'hl</span> <span class="pre">rdm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oneshot:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'xc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'CCSD-S-1-1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.dmet.Options" title="vayesta.dmet.dmet.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'xc'</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.charge_consistent">
<span class="sig-name descname"><span class="pre">charge_consistent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.charge_consistent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.diis">
<span class="sig-name descname"><span class="pre">diis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.diis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.ext_rpa_correction">
<span class="sig-name descname"><span class="pre">ext_rpa_correction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.ext_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.global_frag_chempot">
<span class="sig-name descname"><span class="pre">global_frag_chempot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.global_frag_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.iao_minao">
<span class="sig-name descname"><span class="pre">iao_minao</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'auto'</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.iao_minao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.max_elec_err">
<span class="sig-name descname"><span class="pre">max_elec_err</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.max_elec_err" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.maxiter">
<span class="sig-name descname"><span class="pre">maxiter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.maxiter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.mixing_param">
<span class="sig-name descname"><span class="pre">mixing_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.mixing_param" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.mixing_variable">
<span class="sig-name descname"><span class="pre">mixing_variable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hl</span> <span class="pre">rdm'</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.mixing_variable" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.oneshot">
<span class="sig-name descname"><span class="pre">oneshot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.oneshot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'CCSD-S-1-1'</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.symmetry_mf_tol">
<span class="sig-name descname"><span class="pre">symmetry_mf_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.symmetry_mf_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.symmetry_tol">
<span class="sig-name descname"><span class="pre">symmetry_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.symmetry_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.brueckner_scmf">
<span class="sig-name descname"><span class="pre">brueckner_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.brueckner_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for Brueckner-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.build_bosonic_bath">
<span class="sig-name descname"><span class="pre">build_bosonic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.build_bosonic_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.build_screened_eris">
<span class="sig-name descname"><span class="pre">build_screened_eris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.build_screened_eris" title="Link to this definition"></a></dt>
<dd><p>Generates renormalised coulomb interactions for use in local cluster calculations.
Currently requires unrestricted system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb</strong> (<a class="reference internal" href="vayesta.core.qemb.html#vayesta.core.qemb.qemb.Embedding" title="vayesta.core.qemb.qemb.Embedding"><em>Embedding</em></a>) – Embedding instance.</p></li>
<li><p><strong>fragments</strong> (<em>list</em><em> of </em><em>vayesta.qemb.Fragment subclasses</em><em>, </em><em>optional</em>) – List of fragments for the calculation, used to define local interaction spaces.
If None, <cite>emb.get_fragments(sym_parent=None)</cite> is used. Default: None.</p></li>
<li><p><strong>cderi_ov</strong> (<em>np.array</em><em> or </em><em>tuple</em><em> of </em><em>np.array</em><em>, </em><em>optional.</em>) – Cholesky-decomposed ERIs in the particle-hole basis of mf. If mf is unrestricted
this should be a list of arrays corresponding to the different spin channels.</p></li>
<li><p><strong>store_m0</strong> (<em>bool</em><em>, </em><em>optional.</em>) – Whether to store the local zeroth moment in the fragment class for use later.</p></li>
<li><p><strong>npoints</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points for numerical integration. Default: 48.</p></li>
<li><p><strong>log</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger object. If None, the logger of the <cite>emb</cite> object is used. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>seris_ov</strong> (<em>list of tuples of np.array</em>) – List of spin-dependent screened (ov|ov), for each fragment provided.</p></li>
<li><p><strong>erpa</strong> (<em>float</em>) – Delta RPA correction computed as difference between full system RPA energy and
cluster correlation energies; currently only functional in CAS fragmentations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.build_screened_interactions">
<span class="sig-name descname"><span class="pre">build_screened_interactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.build_screened_interactions" title="Link to this definition"></a></dt>
<dd><p>Build screened interactions, be they dynamic or static.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.calc_electron_number_defect">
<span class="sig-name descname"><span class="pre">calc_electron_number_defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chempot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_fragments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construct_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.calc_electron_number_defect" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.cas_fragmentation">
<span class="sig-name descname"><span class="pre">cas_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.cas_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.check_fragment_symmetry">
<span class="sig-name descname"><span class="pre">check_fragment_symmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.check_fragment_symmetry" title="Link to this definition"></a></dt>
<dd><p>Check that the mean-field obeys the symmetry between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.communicate_clusters">
<span class="sig-name descname"><span class="pre">communicate_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.communicate_clusters" title="Link to this definition"></a></dt>
<dd><p>Communicate cluster orbitals between MPI ranks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.create_invsym_fragments">
<span class="sig-name descname"><span class="pre">create_invsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.create_invsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create inversion symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of inversion-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.create_mirrorsym_fragments">
<span class="sig-name descname"><span class="pre">create_mirrorsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.create_mirrorsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create mirror symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of mirror-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.create_rotsym_fragments">
<span class="sig-name descname"><span class="pre">create_rotsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.create_rotsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create rotationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of rotationally-symmetry related fragments. These will have have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.create_symmetric_fragments">
<span class="sig-name descname"><span class="pre">create_symmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.create_symmetric_fragments" title="Link to this definition"></a></dt>
<dd><p>Add rotationally or translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: self.opts.symmetry_mf_tol.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.create_transsym_fragments">
<span class="sig-name descname"><span class="pre">create_transsym_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.create_transsym_fragments" title="Link to this definition"></a></dt>
<dd><p>Create translationally symmetric fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>translation</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>mf_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.e_mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_mf</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.e_mf" title="Link to this definition"></a></dt>
<dd><p>Total mean-field energy per unit cell (not folded supercell).
Note that the input unit cell itself can be a supercell, in which case
<cite>e_mf</cite> refers to this cell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.e_nonlocal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nonlocal</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.e_nonlocal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.e_nuc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_nuc</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.e_nuc" title="Link to this definition"></a></dt>
<dd><p>Nuclear-repulsion energy per unit cell (not folded supercell).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.e_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_atomic_charges">
<span class="sig-name descname"><span class="pre">get_atomic_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_atomic_charges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_average_cluster_size">
<span class="sig-name descname"><span class="pre">get_average_cluster_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_average_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_cderi">
<span class="sig-name descname"><span class="pre">get_cderi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_cderi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_cderi_exspace">
<span class="sig-name descname"><span class="pre">get_cderi_exspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_cderi_exspace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_corrfunc">
<span class="sig-name descname"><span class="pre">get_corrfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2_with_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_corrfunc" title="Link to this definition"></a></dt>
<dd><p>Get expectation values &lt;P(A) S_z P(B) S_z&gt;, where P(X) are projectors onto atoms X.</p>
<p>TODO: MPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Atom indices for which the spin-spin correlation function should be evaluated.
If set to None (default), all atoms of the system will be considered.
If a list is given, all atom pairs formed from this list will be considered.
If a list of two lists is given, the first list contains the indices of atom A,
and the second of atom B, for which &lt;Sz(A) Sz(B)&gt; will be evaluated.
This is useful in cases where one is only interested in the correlation to
a small subset of atoms. Default: None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corr</strong> – Atom projected correlation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array(N,M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_corrfunc_mf">
<span class="sig-name descname"><span class="pre">get_corrfunc_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_corrfunc_mf" title="Link to this definition"></a></dt>
<dd><p>dm1 in MO basis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_dmet_elec_energy">
<span class="sig-name descname"><span class="pre">get_dmet_elec_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_dmet_elec_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_dmet_energy">
<span class="sig-name descname"><span class="pre">get_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_nuc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate DMET energy via democratically partitioned density-matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
<li><p><strong>with_nuc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include nuclear-repulsion energy. Default: True.</p></li>
<li><p><strong>with_exxdiv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include divergent exact-exchange correction. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_eris_array">
<span class="sig-name descname"><span class="pre">get_eris_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_eris_array" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>[</em><em>list</em><em>(</em><em>4</em><em>) </em><em>of</em><em>] </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(MO), n(MO), n(MO), n(MO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_eris_array_uhf">
<span class="sig-name descname"><span class="pre">get_eris_array_uhf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_eris_array_uhf" title="Link to this definition"></a></dt>
<dd><p>Get electron-repulsion integrals in MO basis as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>tuple</em><em>(</em><em>2</em><em>) of </em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>n</em><em>(</em><em>MO</em><em>)</em><em>) </em><em>array</em>) – MO coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Electron-repulsion integrals in MO basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>eris</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_eris_object">
<span class="sig-name descname"><span class="pre">get_eris_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">postscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_eris_object" title="Link to this definition"></a></dt>
<dd><p>Get ERIs for post-SCF methods.</p>
<p>For folded PBC calculations, this folds the MO back into k-space
and contracts with the k-space three-center integrals..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>postscf</strong> (<em>one</em><em> of </em><em>the following post-SCF methods: MP2</em><em>, </em><em>CCSD</em><em>, </em><em>RCCSD</em><em>, </em><em>DFCCSD</em>) – Post-SCF method with attribute mo_coeff set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eris</strong> – ERIs which can be used for the respective post-SCF method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_ChemistsERIs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_exxdiv">
<span class="sig-name descname"><span class="pre">get_exxdiv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Get divergent exact-exchange (exxdiv) energy correction and potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>e_exxdiv</strong> (<em>float</em>) – Divergent exact-exchange energy correction per unit cell.</p></li>
<li><p><strong>v_exxdiv</strong> (<em>array</em>) – Divergent exact-exchange potential correction in AO basis.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_fock" title="Link to this definition"></a></dt>
<dd><p>Fock matrix in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_fock_for_bath">
<span class="sig-name descname"><span class="pre">get_fock_for_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_fock_for_bath" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for bath orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_fock_for_energy">
<span class="sig-name descname"><span class="pre">get_fock_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_fock_for_energy" title="Link to this definition"></a></dt>
<dd><p>Fock matrix used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_fragment_overlap_norm">
<span class="sig-name descname"><span class="pre">get_fragment_overlap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupied</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_fragment_overlap_norm" title="Link to this definition"></a></dt>
<dd><p>Get matrix of overlap norms between fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_fragments">
<span class="sig-name descname"><span class="pre">get_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_fragments" title="Link to this definition"></a></dt>
<dd><p>Return all fragments which obey the specified conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**filters</strong> – List of returned fragments will be filtered according to specified
keyword arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of fragments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Only returns fragments with mpi_rank 0, 1, or 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">mpi_rank</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Only returns fragments with no symmetry parent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">get_fragments</span><span class="p">(</span><span class="n">sym_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_hcore" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian (kinetic energy plus nuclear-electron attraction).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_hcore_for_energy">
<span class="sig-name descname"><span class="pre">get_hcore_for_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_hcore_for_energy" title="Link to this definition"></a></dt>
<dd><p>Core Hamiltonian used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_impurity_coeffs">
<span class="sig-name descname"><span class="pre">get_impurity_coeffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_impurity_coeffs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_lo_coeff">
<span class="sig-name descname"><span class="pre">get_lo_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_lo_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_max_cluster_size">
<span class="sig-name descname"><span class="pre">get_max_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_max_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_mean_cluster_size">
<span class="sig-name descname"><span class="pre">get_mean_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_mean_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_min_cluster_size">
<span class="sig-name descname"><span class="pre">get_min_cluster_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_min_cluster_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_ovlp" title="Link to this definition"></a></dt>
<dd><p>AO-overlap matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_ovlp_power">
<span class="sig-name descname"><span class="pre">get_ovlp_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_ovlp_power" title="Link to this definition"></a></dt>
<dd><p>get power of AO overlap matrix.</p>
<p>For folded calculations, this uses the k-point sampled overlap, for better performance and accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>power</strong> (<em>float</em>) – Matrix power.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spow</strong> – Matrix power of AO overlap matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n(AO), n(AO)) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_symmetry_child_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_child_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_symmetry_child_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are children to symmetry related parent fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_parents</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, the parent fragment of each symmetry group is prepended to each symmetry sublist.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>children</strong> – A list with the length of the number of parent fragments in the system, each element
being another list containing all the children fragments of the given parent fragment.
Both the outer and inner lists are ordered in the same way that the fragments appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_symmetry_parent_fragments">
<span class="sig-name descname"><span class="pre">get_symmetry_parent_fragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_symmetry_parent_fragments" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all fragments, which are parents to symmetry related child fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parents</strong> – A list of all parent fragments, ordered in the same way as they appear in <cite>self.fragments</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_updated_correlation_kernel">
<span class="sig-name descname"><span class="pre">get_updated_correlation_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_dd0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_dd1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_parents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_updated_correlation_kernel" title="Link to this definition"></a></dt>
<dd><p>Generate the update to our RPA exchange-correlation kernel this iteration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock Coulomb and exchange potential in AO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.get_veff_for_energy">
<span class="sig-name descname"><span class="pre">get_veff_for_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.get_veff_for_energy" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential used for energy evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_complete_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_complete_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_complete_occupied_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_occupied_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_complete_occupied_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the occupied space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_complete_virtual_fragmentation">
<span class="sig-name descname"><span class="pre">has_complete_virtual_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_complete_virtual_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal and complete in the virtual space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_df</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_exxdiv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_exxdiv</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_exxdiv" title="Link to this definition"></a></dt>
<dd><p>Correction for divergent exact-exchange potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.has_orthonormal_fragmentation">
<span class="sig-name descname"><span class="pre">has_orthonormal_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.has_orthonormal_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Check if union of fragment spaces is orthonormal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.iao_fragmentation">
<span class="sig-name descname"><span class="pre">iao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.iao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.iaopao_fragmentation">
<span class="sig-name descname"><span class="pre">iaopao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.iaopao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of IAO+PAO fragments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minao</strong> (<em>str</em><em>, </em><em>optional</em>) – IAO reference basis set. Default: ‘auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.improve_nl_energy">
<span class="sig-name descname"><span class="pre">improve_nl_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.improve_nl_energy" title="Link to this definition"></a></dt>
<dd><p>Perform exact adiabatic-connection integration to obtain improved estimate for the nonlocal correlation
energy at the level of RPA. This is initially only calculated using a linear approximation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.init_mf">
<span class="sig-name descname"><span class="pre">init_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.init_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.is_rhf">
<span class="sig-name descname"><span class="pre">is_rhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.is_rhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.is_uhf">
<span class="sig-name descname"><span class="pre">is_uhf</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.is_uhf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.kernel" title="Link to this definition"></a></dt>
<dd><p>Run DMET calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.loop">
<span class="sig-name descname"><span class="pre">loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.loop" title="Link to this definition"></a></dt>
<dd><p>Loop over fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.make_rdm1" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – Alpha- and beta one-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (n, n) arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.make_rdm1_demo">
<span class="sig-name descname"><span class="pre">make_rdm1_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.make_rdm1_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned one-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg, Lowdin-AO or IAO+PAO fragmentation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_mf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add the mean-field contribution to the density-matrix (double counting is accounted for).
Is only used if <cite>partition = ‘dm’</cite>. Default: False.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm1</strong> – Alpha- and beta one-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (n, n) arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.make_rdm2" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.make_rdm2_demo">
<span class="sig-name descname"><span class="pre">make_rdm2_demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.make_rdm2_demo" title="Link to this definition"></a></dt>
<dd><p>Make democratically partitioned two-particle reduced density-matrix from fragment calculations.</p>
<p>Warning: A democratically partitioned DM is only expected to yield reasonable results
for full fragmentations (eg. Lowdin-AO (SAO) or IAO+PAO fragmentation).</p>
<p>Energies can be evaluated as follows from the 1-DM and 2-DM:</p>
<p>1) Literature DMET energy:
&gt;&gt;&gt; e_nuc = mol.energy_nuc()
&gt;&gt;&gt; hcore = mf.get_hcore()
&gt;&gt;&gt; eris = pyscf.ao2mo.kernel(mol, mf.mo_coeff, compact=False).reshape([mol.nao]*4)
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; vhf = mf.get_veff()
&gt;&gt;&gt; ddm1 = 2*dm1 - mf.make_rdm1()
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=False, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*ddm2) + np.sum(vhf*ddm1)/2</p>
<p>2) Improved DMET energy (same as <cite>emb.get_dmet_energy(part_cumulant=True)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the (approximated) cumulant:
&gt;&gt;&gt; fock = mf.get_fock()
&gt;&gt;&gt; ddm1 = emb.make_rdm1_demo(ao_basis=True, with_mf=False)
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=True)
&gt;&gt;&gt; e_tot = mf.e_tot + np.sum(fock*ddm1) + np.sum(eris*ddm2)/2</p>
<p>3) Improved DMET energy with true cumulant
(same as <cite>emb.get_dmet_energy(part_cumulant=True, approx_cumulant=False)</cite>):
&gt;&gt;&gt; dm1 = emb.make_rdm1_demo(ao_basis=True)
&gt;&gt;&gt; dm2 = emb.make_rdm2_demo(ao_basis=True, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; e_tot = e_nuc + np.sum(hcore*dm1) + np.sum(eris*dm2)/2</p>
<p>…or in terms of the cumulant:
&gt;&gt;&gt; ddm2 = emb.make_rdm2_demo(ao_basis=True, with_dm1=False, part_cumulant=True, approx_cumulant=False)
&gt;&gt;&gt; fcorr = mf.get_fock(dm=dm1)
&gt;&gt;&gt; e_tot = e_nuc + np.sum((hcore+fcorr)*dm1)/2 + np.sum(eris*ddm2)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ao_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the density-matrix in the AO basis. Default: False.</p></li>
<li><p><strong>with_dm1</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the non-cumulant part of the 2-DM will be added. See also <cite>approx_cumulant</cite>. Default: False.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the mixed non-cumulant contributions, “DM1(MF) * [DM1(corr)-DM1(MF)]”, will be projected
symmetrically between both factors. This will return a 2-DM will evaluates to the DMET-energy
of the literature. If True, only the second factor will be projected. This will generally
give better expectation values and is the recommended setting. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – If True, the cumulant of the 2-DM will be approximated and contain the non-cumulant contribution
“delta[DM1(corr)-DM1(MF)]^2”. This value is ignored if part_cumulant is False and with_dm1 is True.
Default: True.</p></li>
<li><p><strong>symmetrize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Symmetrize the density-matrix at the end of the calculation. Default: True.</p></li>
<li><p><strong>mpi_target</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set to an integer, the result will only be available at the specified MPI rank.
If set to None, an MPI allreduce will be performed and the result will be available
at all MPI ranks. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dm2</strong> – Two-particle reduced density matrix in AO (if <cite>ao_basis=True</cite>) or MO basis (default).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n, n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_coeff" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_coeff_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_occ</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_coeff_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_coeff_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_coeff_vir</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_coeff_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_energy" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_energy_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_occ</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_energy_occ" title="Link to this definition"></a></dt>
<dd><p>Occupied MO energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_energy_vir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_energy_vir</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_energy_vir" title="Link to this definition"></a></dt>
<dd><p>Virtual MO coefficients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mo_occ</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mo_occ" title="Link to this definition"></a></dt>
<dd><p>Molecular orbital occupations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.mol" title="Link to this definition"></a></dt>
<dd><p>Mole or Cell object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.nao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nao</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.nao" title="Link to this definition"></a></dt>
<dd><p>Number of atomic orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.ncells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncells</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.ncells" title="Link to this definition"></a></dt>
<dd><p>Number of primitive cells within supercell.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.nfrag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nfrag</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.nfrag" title="Link to this definition"></a></dt>
<dd><p>Number of fragments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.nmo" title="Link to this definition"></a></dt>
<dd><p>Total number of molecular orbitals (MOs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.nocc" title="Link to this definition"></a></dt>
<dd><p>Number of occupied MOs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.nvir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.nvir" title="Link to this definition"></a></dt>
<dd><p>Number of virtual MOs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.optimize_chempot">
<span class="sig-name descname"><span class="pre">optimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpt_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.optimize_chempot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.pbc_dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pbc_dimension</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.pbc_dimension" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.pdmet_scmf">
<span class="sig-name descname"><span class="pre">pdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.pdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for p-DMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.pop_analysis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>(</em><em>N</em><em>, </em><em>N</em><em>) </em><em>array</em>) – If <cite>mo_coeff</cite> is None, AO representation is assumed.</p></li>
<li><p><strong>local_orbitals</strong> (<em>{'lowdin'</em><em>, </em><em>'mulliken'</em><em>, </em><em>'iao+pao'}</em><em> or </em><em>array</em>) – Kind of population analysis. Default: ‘lowdin’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pop</strong> – Population of atomic orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ol class="upperalpha simple" start="14">
<li><p>array</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.print_clusters">
<span class="sig-name descname"><span class="pre">print_clusters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.print_clusters" title="Link to this definition"></a></dt>
<dd><p>Print fragments of calculations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.print_results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.qpewdmet_scmf">
<span class="sig-name descname"><span class="pre">qpewdmet_scmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.qpewdmet_scmf" title="Link to this definition"></a></dt>
<dd><p>Decorator for QP-EWDMET.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.require_complete_fragmentation">
<span class="sig-name descname"><span class="pre">require_complete_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.require_complete_fragmentation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.run_exact_full_ac">
<span class="sig-name descname"><span class="pre">run_exact_full_ac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_constrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.run_exact_full_ac" title="Link to this definition"></a></dt>
<dd><p>During calculation we only calculate the linearised nonlocal correlation energy, since this is relatively
cheap (only a single RPA numerical integration). This instead performs the exact energy via numerical
integration of the adiabatic connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.sao_fragmentation">
<span class="sig-name descname"><span class="pre">sao_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.sao_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of SAO (Lowdin-AO) fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.set_hcore">
<span class="sig-name descname"><span class="pre">set_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.set_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.set_ovlp">
<span class="sig-name descname"><span class="pre">set_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.set_ovlp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.set_up_fragments">
<span class="sig-name descname"><span class="pre">set_up_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sym_parents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsym</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.set_up_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.set_veff">
<span class="sig-name descname"><span class="pre">set_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.set_veff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.site_fragmentation">
<span class="sig-name descname"><span class="pre">site_fragmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.site_fragmentation" title="Link to this definition"></a></dt>
<dd><p>Initialize the quantum embedding method for the use of site fragments.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.spinsym">
<span class="sig-name descname"><span class="pre">spinsym</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'unrestricted'</span></em><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.spinsym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.update_mf">
<span class="sig-name descname"><span class="pre">update_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.update_mf" title="Link to this definition"></a></dt>
<dd><p>Update underlying mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.update_vcorr">
<span class="sig-name descname"><span class="pre">update_vcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_rdms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.update_vcorr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.with_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.uedmet.UEDMET.write_population">
<span class="sig-name descname"><span class="pre">write_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filemode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.uedmet.UEDMET.write_population" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.edmet.ufragment">
<span id="vayesta-edmet-ufragment"></span><h2>vayesta.edmet.ufragment<a class="headerlink" href="#module-vayesta.edmet.ufragment" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vayesta.edmet.ufragment.</span></span><span class="sig-name descname"><span class="pre">UEDMETFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.ufragment.UDMETFragment" title="vayesta.dmet.ufragment.UDMETFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">UDMETFragment</span></code></a>, <a class="reference internal" href="#vayesta.edmet.fragment.EDMETFragment" title="vayesta.edmet.fragment.EDMETFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">EDMETFragment</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.ov_active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.ov_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.ov_active_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active_tot</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.ov_active_tot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.ov_mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_mf</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.ov_mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.r_bos_ao">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_bos_ao</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.r_bos_ao" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_co_active">
<span class="sig-name descname"><span class="pre">get_co_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_co_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_co_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_cv_active">
<span class="sig-name descname"><span class="pre">get_cv_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_cv_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_cv_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_rot_to_mf_ov">
<span class="sig-name descname"><span class="pre">get_rot_to_mf_ov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_rot_to_mf_ov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_rot_to_mf_ov" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragment_projector_ov">
<span class="sig-name descname"><span class="pre">get_fragment_projector_ov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_bosons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_fragment_projector_ov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragment_projector_ov" title="Link to this definition"></a></dt>
<dd><p>In space of cluster p-h excitations, generate the projector to the .</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.conv_to_aos">
<span class="sig-name descname"><span class="pre">conv_to_aos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.conv_to_aos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.conv_to_aos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_eri_couplings">
<span class="sig-name descname"><span class="pre">get_eri_couplings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_eri_couplings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_eri_couplings" title="Link to this definition"></a></dt>
<dd><p>Obtain eri in a space defined by an arbitrary rotation of the mean-field particle-hole excitations of our
systems. Note that this should only really be used in the case that such a rotation cannot be described by a
rotation of the underlying single-particle basis, since highly efficient routines already exist for this case..</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_rbos_split">
<span class="sig-name descname"><span class="pre">get_rbos_split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_rbos_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_rbos_split" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_rot_ov_frag">
<span class="sig-name descname"><span class="pre">get_rot_ov_frag</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_rot_ov_frag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_rot_ov_frag" title="Link to this definition"></a></dt>
<dd><p>Get rotations between the relevant space for fragment two-point excitations and the cluster active occupied-
virtual excitations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_correlation_kernel_contrib">
<span class="sig-name descname"><span class="pre">get_correlation_kernel_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contrib</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet/ufragment.html#UEDMETFragment.get_correlation_kernel_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_correlation_kernel_contrib" title="Link to this definition"></a></dt>
<dd><p>Gets contribution to xc kernel in full space of system.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Flags">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_envelop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_secfrag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath_parent_fragment_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Flags" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Flags.bath_parent_fragment_id">
<span class="sig-name descname"><span class="pre">bath_parent_fragment_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Flags.bath_parent_fragment_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Flags.is_envelop">
<span class="sig-name descname"><span class="pre">is_envelop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Flags.is_envelop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Flags.is_secfrag">
<span class="sig-name descname"><span class="pre">is_secfrag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Flags.is_secfrag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_bath_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_options:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_eris:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_with_frozen:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screening:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_cluster_fock:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_fragments:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dd_moments:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_sc_condition:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bos:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_proj_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_xc_kernel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bosonic_interaction:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.core.qemb.html#vayesta.core.qemb.fragment.Options" title="vayesta.core.qemb.fragment.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepcopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.asdict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.auxiliary">
<span class="sig-name descname"><span class="pre">auxiliary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.auxiliary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.bath_options">
<span class="sig-name descname"><span class="pre">bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.boson_xc_kernel">
<span class="sig-name descname"><span class="pre">boson_xc_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.boson_xc_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.bosonic_bath_options">
<span class="sig-name descname"><span class="pre">bosonic_bath_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.bosonic_bath_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.bosonic_interaction">
<span class="sig-name descname"><span class="pre">bosonic_interaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.bosonic_interaction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.change_dict_defaults">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_dict_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.change_dict_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.dict_with_defaults">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dict_with_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.dict_with_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.dm_with_frozen">
<span class="sig-name descname"><span class="pre">dm_with_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.dm_with_frozen" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.get" title="Link to this definition"></a></dt>
<dd><p>Dictionary-like access to attributes.
Allows the definition of a default value, of the attribute is not present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.get_default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.get_default" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.get_default_factory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_default_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.get_default_factory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.items" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.make_dd_moments">
<span class="sig-name descname"><span class="pre">make_dd_moments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.make_dd_moments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.match_cluster_fock">
<span class="sig-name descname"><span class="pre">match_cluster_fock</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.match_cluster_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.max_bos">
<span class="sig-name descname"><span class="pre">max_bos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.max_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.occ_proj_kernel">
<span class="sig-name descname"><span class="pre">occ_proj_kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.occ_proj_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.old_sc_condition">
<span class="sig-name descname"><span class="pre">old_sc_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.old_sc_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.replace" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.screening">
<span class="sig-name descname"><span class="pre">screening</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.screening" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.solver_options">
<span class="sig-name descname"><span class="pre">solver_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.store_eris">
<span class="sig-name descname"><span class="pre">store_eris</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.store_eris" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.sym_factor">
<span class="sig-name descname"><span class="pre">sym_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.sym_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Options.coupled_fragments">
<span class="sig-name descname"><span class="pre">coupled_fragments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Options.coupled_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converged</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_corr_rpa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">vayesta.core.types.wf.wf.WaveFunction</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_eb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eb_couplings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boson_freqs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd_mom0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd_mom1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_fb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="vayesta.dmet.html#vayesta.dmet.fragment.DMETFragment.Results" title="vayesta.dmet.fragment.DMETFragment.Results"><code class="xref py py-class docutils literal notranslate"><span class="pre">Results</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.boson_freqs">
<span class="sig-name descname"><span class="pre">boson_freqs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.boson_freqs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.converged" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.dd_mom0">
<span class="sig-name descname"><span class="pre">dd_mom0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.dd_mom0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.dd_mom1">
<span class="sig-name descname"><span class="pre">dd_mom1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.dd_mom1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.dm1">
<span class="sig-name descname"><span class="pre">dm1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.dm1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.dm2">
<span class="sig-name descname"><span class="pre">dm2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.dm2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.dm_eb">
<span class="sig-name descname"><span class="pre">dm_eb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.dm_eb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.e1">
<span class="sig-name descname"><span class="pre">e1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.e1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.e2">
<span class="sig-name descname"><span class="pre">e2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.e2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.e_corr">
<span class="sig-name descname"><span class="pre">e_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.e_corr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.e_corr_rpa">
<span class="sig-name descname"><span class="pre">e_corr_rpa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.e_corr_rpa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.e_fb">
<span class="sig-name descname"><span class="pre">e_fb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.e_fb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.eb_couplings">
<span class="sig-name descname"><span class="pre">eb_couplings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.eb_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.fid">
<span class="sig-name descname"><span class="pre">fid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.fid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.moms">
<span class="sig-name descname"><span class="pre">moms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.moms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.n_active">
<span class="sig-name descname"><span class="pre">n_active</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.n_active" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.pwf">
<span class="sig-name descname"><span class="pre">pwf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.pwf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.Results.wf">
<span class="sig-name descname"><span class="pre">wf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="vayesta.core.types.wf.html#vayesta.core.types.wf.wf.WaveFunction" title="vayesta.core.types.wf.wf.WaveFunction"><span class="pre">WaveFunction</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.Results.wf" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.add_tsymmetric_fragments">
<span class="sig-name descname"><span class="pre">add_tsymmetric_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.add_tsymmetric_fragments" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tvecs</strong> (<em>array</em><em>(</em><em>3</em><em>) of </em><em>integers</em>) – Each element represent the number of translation vector corresponding to the a0, a1, and a2 lattice vectors of the cell.</p></li>
<li><p><strong>symtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for the error of the mean-field density matrix between symmetry related fragments.
If the largest absolute difference in the density-matrix is above this value,
and exception will be raised. Default: 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fragments</strong> – List of T-symmetry related fragments. These will be automatically added to base.fragments and
have the attributes <cite>sym_parent</cite> and <cite>sym_op</cite> set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.calc_exact_ac">
<span class="sig-name descname"><span class="pre">calc_exact_ac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.calc_exact_ac" title="Link to this definition"></a></dt>
<dd><p>Evaluate the exact local energy for RPA in this cluster via the Adiabatic Connection, with or without
the plasmon formula. Note that although</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.canonicalize_mo">
<span class="sig-name descname"><span class="pre">canonicalize_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.canonicalize_mo" title="Link to this definition"></a></dt>
<dd><p>Diagonalize Fock matrix within subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>eigenvalues</strong> (<em>ndarray</em>) – Return MO energies of canonicalized orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mo_canon</strong> (<em>ndarray</em>) – Canonicalized orbital coefficients.</p></li>
<li><p><strong>rot</strong> (<em>ndarray</em>) – Rotation matrix: np.dot(mo_coeff, rot) = mo_canon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.change_options">
<span class="sig-name descname"><span class="pre">change_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.change_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.check_qba_approx">
<span class="sig-name descname"><span class="pre">check_qba_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.check_qba_approx" title="Link to this definition"></a></dt>
<dd><p>Given boson and cluster coefficient definitions, checks deviation from exact bosonic commutation relations
within our cluster projected onto the ground state.
This will hopefully tell us whether our bosons are likely to be a good approximation to the full system.
We could take the L2 norm of the overall deviation, but given most of the resultant operators have essentially
negligible expectation values with the ground state this is an unnecessarily pessimistic
estimator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.check_solver">
<span class="sig-name descname"><span class="pre">check_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.check_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.cluster">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.construct_boson_hamil">
<span class="sig-name descname"><span class="pre">construct_boson_hamil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta0_bos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.construct_boson_hamil" title="Link to this definition"></a></dt>
<dd><p>Given the zeroth moment coupling of our bosons to the remainder of the space, along with stored information,
generate the components of our interacting electron-boson Hamiltonian.
At the same time, calculate the local RPA correlation energy since this requires all the same information we
already have to hand.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.construct_correlation_kernel_contrib">
<span class="sig-name descname"><span class="pre">construct_correlation_kernel_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svdtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.construct_correlation_kernel_contrib" title="Link to this definition"></a></dt>
<dd><p>Generate the contribution to the correlation kernel arising from this fragment, in terms of local degrees of
freedom (ie cluster orbitals and bosons).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.contributes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contributes</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.contributes" title="Link to this definition"></a></dt>
<dd><p>True if fragment contributes to expectation values, else False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.copy" title="Link to this definition"></a></dt>
<dd><p>Create copy of fragment, without adding it to the fragments list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.couple_to_fragment">
<span class="sig-name descname"><span class="pre">couple_to_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.couple_to_fragment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.couple_to_fragments">
<span class="sig-name descname"><span class="pre">couple_to_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.couple_to_fragments" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.define_bosons">
<span class="sig-name descname"><span class="pre">define_bosons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rpa_mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_ov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.define_bosons" title="Link to this definition"></a></dt>
<dd><p>Given the RPA zeroth moment between the fermionic cluster excitations and the rest of the space, define
our cluster bosons.
Note that this doesn’t define our Hamiltonian, since we don’t yet have the required portion of our
zeroth moment for the bosonic degrees of freedom.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.diagonalize_cluster_dm">
<span class="sig-name descname"><span class="pre">diagonalize_cluster_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.diagonalize_cluster_dm" title="Link to this definition"></a></dt>
<dd><p>Diagonalize cluster (fragment+bath) DM to get fully occupied and virtual orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mo_coeff</strong> (<em>ndarrays</em>) – Orbital coefficients.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – If set, check that all eigenvalues of the cluster DM are close
to 0 or 1, with the tolerance given by tol. Default= 1e-4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c_cluster_occ</strong> (<em>ndarray</em>) – Occupied cluster orbitals.</p></li>
<li><p><strong>c_cluster_vir</strong> (<em>ndarray</em>) – Virtual cluster orbitals.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.energy_couplings">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_couplings</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.energy_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_coeff_env">
<span class="sig-name descname"><span class="pre">get_coeff_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_coeff_env" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_composite_moments">
<span class="sig-name descname"><span class="pre">get_composite_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1_new</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_composite_moments" title="Link to this definition"></a></dt>
<dd><p>Construct composite moments using the local solver dd moments and the lattice RPA moments</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_dmet_energy_contrib">
<span class="sig-name descname"><span class="pre">get_dmet_energy_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_dmet_energy_contrib" title="Link to this definition"></a></dt>
<dd><p>Calculate the contribution of this fragment to the overall DMET energy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_edmet_energy_contrib">
<span class="sig-name descname"><span class="pre">get_edmet_energy_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_edmet_energy_contrib" title="Link to this definition"></a></dt>
<dd><p>Generate EDMET energy contribution, according to expression given in appendix of EDMET preprint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_frag_hamil">
<span class="sig-name descname"><span class="pre">get_frag_hamil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_frag_hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_frag_hl_dm">
<span class="sig-name descname"><span class="pre">get_frag_hl_dm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_frag_hl_dm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragment_dmet_energy">
<span class="sig-name descname"><span class="pre">get_fragment_dmet_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_cumulant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragment_dmet_energy" title="Link to this definition"></a></dt>
<dd><p>Get fragment contribution to whole system DMET energy from cluster DMs.</p>
<p>After fragment summation, the nuclear-nuclear repulsion must be added to get the total energy!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm1</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster one-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm1</cite> is used. Default: None.</p></li>
<li><p><strong>dm2</strong> (<em>array</em><em>, </em><em>optional</em>) – Cluster two-electron reduced density-matrix in cluster basis. If <cite>None</cite>, <cite>self.results.dm2</cite> is used. Default: None.</p></li>
<li><p><strong>hamil</strong> (<em>ClusterHamiltonian object.</em>) – Object representing cluster hamiltonian, possibly including cached ERIs.</p></li>
<li><p><strong>part_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the 2-DM cumulant will be partitioned to calculate the energy. If False,
the full 2-DM will be partitioned, as it is done in most of the DMET literature.
True is recommended, unless checking for agreement with literature results. Default: True.</p></li>
<li><p><strong>approx_cumulant</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the approximate cumulant, containing (delta 1-DM)-squared terms, is partitioned,
instead of the true cumulant, if <cite>part_cumulant=True</cite>. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e_dmet</strong> – Electronic fragment DMET energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragment_mf_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mf_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragment_mf_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the part of the mean-field energy associated with the fragment.</p>
<p>Does not include nuclear-nuclear repulsion!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragment_mo_energy">
<span class="sig-name descname"><span class="pre">get_fragment_mo_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragment_mo_energy" title="Link to this definition"></a></dt>
<dd><p>Returns approximate MO energies, using the the diagonal of the Fock matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_active</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>fock</strong> (<em>array</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragment_projector">
<span class="sig-name descname"><span class="pre">get_fragment_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragment_projector" title="Link to this definition"></a></dt>
<dd><p>Projector for one index of amplitudes local energy expression.</p>
<p>Cost: N^2 if O(1) coeffs , N^3 if O(N) coeffs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>n</em><em>(</em><em>AO</em><em>)</em><em>, </em><em>N</em><em>)</em>) – Occupied or virtual orbital coefficients.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return 1-p instead. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – Projection matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, n) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_fragments_with_overlap">
<span class="sig-name descname"><span class="pre">get_fragments_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_fragments_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Get list of fragments which overlap both in occupied and virtual space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_loc_eps">
<span class="sig-name descname"><span class="pre">get_loc_eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_loc_eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_local_rpa_correction">
<span class="sig-name descname"><span class="pre">get_local_rpa_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_local_rpa_correction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_mo_occupation">
<span class="sig-name descname"><span class="pre">get_mo_occupation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_mo_occupation" title="Link to this definition"></a></dt>
<dd><p>Get mean-field occupation numbers (diagonal of 1-RDM) of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mo_coeff</strong> (<em>ndarray</em><em>, </em><em>shape</em><em>(</em><em>N</em><em>, </em><em>M</em><em>)</em>) – Orbital coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>occ</strong> – Occupation numbers of orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_nelectron_hl">
<span class="sig-name descname"><span class="pre">get_nelectron_hl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_nelectron_hl" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_overlap">
<span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Get overlap between cluster orbitals, fragment orbitals, or MOs.</p>
<p>The return value is cached but not copied; do not modify the array in place without
creating a copy!</p>
<p>Examples:
&gt;&gt;&gt; s = self.get_overlap(‘cluster|mo’)
&gt;&gt;&gt; s = self.get_overlap(‘cluster|frag’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[occ]|cluster[occ]’)
&gt;&gt;&gt; s = self.get_overlap(‘mo[vir]|cluster[vir]’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_solver" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_solver_options">
<span class="sig-name descname"><span class="pre">get_solver_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_solver_options" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_children">
<span class="sig-name descname"><span class="pre">get_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_children" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_error">
<span class="sig-name descname"><span class="pre">get_symmetry_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_error" title="Link to this definition"></a></dt>
<dd><p>Get translational symmetry error between two fragments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_generations">
<span class="sig-name descname"><span class="pre">get_symmetry_generations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_generations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_operation">
<span class="sig-name descname"><span class="pre">get_symmetry_operation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_parent">
<span class="sig-name descname"><span class="pre">get_symmetry_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_tree">
<span class="sig-name descname"><span class="pre">get_symmetry_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_symmetry_tree" title="Link to this definition"></a></dt>
<dd><p>Returns a recursive tree:</p>
<p>[(x, [children of x]), (y, [children of y]), …]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.get_xc_couplings">
<span class="sig-name descname"><span class="pre">get_xc_couplings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.get_xc_couplings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.hamil">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hamil</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.hamil" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.id_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id_name</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.id_name" title="Link to this definition"></a></dt>
<dd><p>Use this whenever a unique name is needed (for example to open a separate file for each fragment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construct_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.kernel" title="Link to this definition"></a></dt>
<dd><p>Solve the fragment with the specified solver and chemical potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.log_info">
<span class="sig-name descname"><span class="pre">log_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.log_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.loop_symmetry_children">
<span class="sig-name descname"><span class="pre">loop_symmetry_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxgen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.loop_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Loop over all symmetry related fragments, including children of children, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em><em> or </em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>optional</em>) – If arrays are passed, the symmetry operation of each symmetry related fragment will be
applied to this array along the axis given in <cite>axes</cite>.</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of axes, along which the symmetry operation is applied for each element of <cite>arrays</cite>.
If None, the first axis will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.make_bath">
<span class="sig-name descname"><span class="pre">make_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.make_bath" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.make_bosonic_bath_target">
<span class="sig-name descname"><span class="pre">make_bosonic_bath_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.make_bosonic_bath_target" title="Link to this definition"></a></dt>
<dd><p>Get the target space for bosonic bath orbitals. This can either be the DMET cluster or the full space, and
can include a projection onto the fragment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.make_bosonic_cluster">
<span class="sig-name descname"><span class="pre">make_bosonic_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.make_bosonic_cluster" title="Link to this definition"></a></dt>
<dd><p>Set bosonic component of the cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.make_cluster">
<span class="sig-name descname"><span class="pre">make_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.make_cluster" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.make_counterpoise_mol">
<span class="sig-name descname"><span class="pre">make_counterpoise_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.make_counterpoise_mol" title="Link to this definition"></a></dt>
<dd><p>Make molecule object for counterposise calculation.</p>
<p>WARNING: This has only been tested for periodic systems so far!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – All atom centers within range <cite>rmax</cite> are added as ghost-atoms in the counterpoise correction.</p></li>
<li><p><strong>nimages</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighboring unit cell in each spatial direction. Has no effect in open boundary
calculations. Default: 5.</p></li>
<li><p><strong>unit</strong> (<em>[</em><em>'A'</em><em>, </em><em>'B'</em><em>]</em>) – Unit for <cite>rmax</cite>, either Angstrom (<cite>A</cite>) or Bohr (<cite>B</cite>).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for returned PySCF Mole/Cell object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol_cp</strong> – Mole or Cell object with periodic boundary conditions removed
and with ghost atoms added depending on <cite>rmax</cite> and <cite>nimages</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyscf.gto.Mole or pyscf.pbc.gto.Cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.mf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mf</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.mf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.mol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.mol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.n_frag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frag</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.n_frag" title="Link to this definition"></a></dt>
<dd><p>Number of fragment orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.n_symmetry_children">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_symmetry_children</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.n_symmetry_children" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.nbos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nbos</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.nbos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.nclus_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nclus_ab</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.nclus_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.nelectron">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelectron</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.nelectron" title="Link to this definition"></a></dt>
<dd><p>Number of mean-field electrons.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.nocc_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc_ab</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.nocc_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.nvir_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvir_ab</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.nvir_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.ov_active_ab">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ov_active_ab</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.ov_active_ab" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.plot3d">
<span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100,</span> <span class="pre">100)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.plot3d" title="Link to this definition"></a></dt>
<dd><p>Write cube density data of fragment orbitals to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.pop_analysis">
<span class="sig-name descname"><span class="pre">pop_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.pop_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.proj_hamil_qba">
<span class="sig-name descname"><span class="pre">proj_hamil_qba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exchange_between_bos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.proj_hamil_qba" title="Link to this definition"></a></dt>
<dd><p>Generate quasi-bosonic Hamiltonian via projection of appropriate Hamiltonian elements of full system.
This represents the bosons as an explicit sum of environmental excitations, which we then approximate as bosonic</p>
<blockquote>
<div><p>degrees of freedom.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.project_ref_orbitals">
<span class="sig-name descname"><span class="pre">project_ref_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.project_ref_orbitals" title="Link to this definition"></a></dt>
<dd><p>Project reference orbitals into available space in new geometry.</p>
<p>The projected orbitals will be ordered according to their eigenvalues within the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>ndarray</em>) – Orbital coefficients.</p></li>
<li><p><strong>c_ref</strong> (<em>ndarray</em>) – Orbital coefficients of reference orbitals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.r_ao_bos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_ao_bos</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.r_ao_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.r_bos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_bos</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.r_bos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.results" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.set_cas">
<span class="sig-name descname"><span class="pre">set_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.set_cas" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.set_up_fermionic_bath">
<span class="sig-name descname"><span class="pre">set_up_fermionic_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.set_up_fermionic_bath" title="Link to this definition"></a></dt>
<dd><p>Set up the fermionic bath orbitals</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.split_ov_spin_components">
<span class="sig-name descname"><span class="pre">split_ov_spin_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.split_ov_spin_components" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.store_cluster_rpa">
<span class="sig-name descname"><span class="pre">store_cluster_rpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta0_bos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_kernel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.store_cluster_rpa" title="Link to this definition"></a></dt>
<dd><p>This function just stores all required information for the</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.symmetry_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symmetry_factor</span></span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.symmetry_factor" title="Link to this definition"></a></dt>
<dd><p>Includes children of children, etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.test_total_rpa_energy">
<span class="sig-name descname"><span class="pre">test_total_rpa_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_plasmon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.test_total_rpa_energy" title="Link to this definition"></a></dt>
<dd><p>Evaluate the exact local energy for RPA in this cluster via the Adiabatic Connection, with or without
the plasmon formula. Note that although</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vayesta.edmet.ufragment.UEDMETFragment.trimmed_name">
<span class="sig-name descname"><span class="pre">trimmed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vayesta.edmet.ufragment.UEDMETFragment.trimmed_name" title="Link to this definition"></a></dt>
<dd><p>Fragment name trimmed to a given maximum length.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vayesta.edmet">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vayesta.edmet" title="Link to this heading"></a></h2>
<p>Extended Density Matrix Embedding Theory (EDMET) method
Author: Charles Scott
email:  <a class="reference external" href="mailto:cjcargillscott&#37;&#52;&#48;gmail&#46;com">cjcargillscott<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="vayesta.edmet.EDMET">
<span class="sig-prename descclassname"><span class="pre">vayesta.edmet.</span></span><span class="sig-name descname"><span class="pre">EDMET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/vayesta/edmet.html#EDMET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vayesta.edmet.EDMET" title="Link to this definition"></a></dt>
<dd><p>Determine restricted or unrestricted by inspection of mean-field object</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vayesta.dmet.html" class="btn btn-neutral float-left" title="vayesta.dmet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vayesta.ewf.html" class="btn btn-neutral float-right" title="vayesta.ewf" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>